{"version":3,"sources":["../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/anthropic-provider.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/version.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/anthropic-messages-language-model.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/anthropic-error.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/anthropic-messages-api.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/anthropic-messages-options.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/anthropic-prepare-tools.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/get-cache-control.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/text-editor_20250728.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/web-search_20250305.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/web-fetch-20250910.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/convert-anthropic-messages-usage.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/convert-to-anthropic-messages-prompt.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/code-execution_20250522.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/code-execution_20250825.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/tool-search-regex_20251119.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/map-anthropic-stop-reason.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/bash_20241022.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/bash_20250124.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/computer_20241022.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/computer_20250124.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/memory_20250818.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/text-editor_20241022.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/text-editor_20250124.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/text-editor_20250429.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/tool/tool-search-bm25_20251119.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/anthropic-tools.ts","../../../node_modules/.pnpm/@ai-sdk+anthropic@3.0.1_zod@4.2.1/node_modules/@ai-sdk/anthropic/src/forward-anthropic-container-id-from-last-step.ts"],"sourcesContent":["import {\n  LanguageModelV3,\n  NoSuchModelError,\n  ProviderV3,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  generateId,\n  loadApiKey,\n  loadOptionalSetting,\n  withoutTrailingSlash,\n  withUserAgentSuffix,\n} from '@ai-sdk/provider-utils';\nimport { VERSION } from './version';\nimport { AnthropicMessagesLanguageModel } from './anthropic-messages-language-model';\nimport { AnthropicMessagesModelId } from './anthropic-messages-options';\nimport { anthropicTools } from './anthropic-tools';\n\nexport interface AnthropicProvider extends ProviderV3 {\n  /**\nCreates a model for text generation.\n*/\n  (modelId: AnthropicMessagesModelId): LanguageModelV3;\n\n  /**\nCreates a model for text generation.\n*/\n  languageModel(modelId: AnthropicMessagesModelId): LanguageModelV3;\n\n  chat(modelId: AnthropicMessagesModelId): LanguageModelV3;\n\n  messages(modelId: AnthropicMessagesModelId): LanguageModelV3;\n\n  /**\n   * @deprecated Use `embeddingModel` instead.\n   */\n  textEmbeddingModel(modelId: string): never;\n\n  /**\nAnthropic-specific computer use tool.\n   */\n  tools: typeof anthropicTools;\n}\n\nexport interface AnthropicProviderSettings {\n  /**\nUse a different URL prefix for API calls, e.g. to use proxy servers.\nThe default prefix is `https://api.anthropic.com/v1`.\n   */\n  baseURL?: string;\n\n  /**\nAPI key that is being send using the `x-api-key` header.\nIt defaults to the `ANTHROPIC_API_KEY` environment variable.\n   */\n  apiKey?: string;\n\n  /**\nCustom headers to include in the requests.\n     */\n  headers?: Record<string, string>;\n\n  /**\nCustom fetch implementation. You can use it as a middleware to intercept requests,\nor to provide a custom fetch implementation for e.g. testing.\n    */\n  fetch?: FetchFunction;\n\n  generateId?: () => string;\n\n  /**\n   * Custom provider name\n   * Defaults to 'anthropic.messages'.\n   */\n  name?: string;\n}\n\n/**\nCreate an Anthropic provider instance.\n */\nexport function createAnthropic(\n  options: AnthropicProviderSettings = {},\n): AnthropicProvider {\n  const baseURL =\n    withoutTrailingSlash(\n      loadOptionalSetting({\n        settingValue: options.baseURL,\n        environmentVariableName: 'ANTHROPIC_BASE_URL',\n      }),\n    ) ?? 'https://api.anthropic.com/v1';\n\n  const providerName = options.name ?? 'anthropic.messages';\n\n  const getHeaders = () =>\n    withUserAgentSuffix(\n      {\n        'anthropic-version': '2023-06-01',\n        'x-api-key': loadApiKey({\n          apiKey: options.apiKey,\n          environmentVariableName: 'ANTHROPIC_API_KEY',\n          description: 'Anthropic',\n        }),\n        ...options.headers,\n      },\n      `ai-sdk/anthropic/${VERSION}`,\n    );\n\n  const createChatModel = (modelId: AnthropicMessagesModelId) =>\n    new AnthropicMessagesLanguageModel(modelId, {\n      provider: providerName,\n      baseURL,\n      headers: getHeaders,\n      fetch: options.fetch,\n      generateId: options.generateId ?? generateId,\n      supportedUrls: () => ({\n        'image/*': [/^https?:\\/\\/.*$/],\n      }),\n    });\n\n  const provider = function (modelId: AnthropicMessagesModelId) {\n    if (new.target) {\n      throw new Error(\n        'The Anthropic model function cannot be called with the new keyword.',\n      );\n    }\n\n    return createChatModel(modelId);\n  };\n\n  provider.specificationVersion = 'v3' as const;\n  provider.languageModel = createChatModel;\n  provider.chat = createChatModel;\n  provider.messages = createChatModel;\n\n  provider.embeddingModel = (modelId: string) => {\n    throw new NoSuchModelError({ modelId, modelType: 'embeddingModel' });\n  };\n  provider.textEmbeddingModel = provider.embeddingModel;\n  provider.imageModel = (modelId: string) => {\n    throw new NoSuchModelError({ modelId, modelType: 'imageModel' });\n  };\n\n  provider.tools = anthropicTools;\n\n  return provider;\n}\n\n/**\nDefault Anthropic provider instance.\n */\nexport const anthropic = createAnthropic();\n","// Version string of this package injected at build time.\ndeclare const __PACKAGE_VERSION__: string | undefined;\nexport const VERSION: string =\n  typeof __PACKAGE_VERSION__ !== 'undefined'\n    ? __PACKAGE_VERSION__\n    : '0.0.0-test';\n","import {\n  APICallError,\n  JSONObject,\n  LanguageModelV3,\n  LanguageModelV3CallOptions,\n  LanguageModelV3Content,\n  LanguageModelV3FinishReason,\n  LanguageModelV3FunctionTool,\n  LanguageModelV3GenerateResult,\n  LanguageModelV3Prompt,\n  LanguageModelV3Source,\n  LanguageModelV3StreamPart,\n  LanguageModelV3StreamResult,\n  LanguageModelV3ToolCall,\n  SharedV3ProviderMetadata,\n  SharedV3Warning,\n} from '@ai-sdk/provider';\nimport {\n  combineHeaders,\n  createEventSourceResponseHandler,\n  createJsonResponseHandler,\n  createToolNameMapping,\n  FetchFunction,\n  generateId,\n  InferSchema,\n  parseProviderOptions,\n  ParseResult,\n  postJsonToApi,\n  Resolvable,\n  resolve,\n} from '@ai-sdk/provider-utils';\nimport { anthropicFailedResponseHandler } from './anthropic-error';\nimport { AnthropicMessageMetadata } from './anthropic-message-metadata';\nimport {\n  AnthropicContainer,\n  anthropicMessagesChunkSchema,\n  anthropicMessagesResponseSchema,\n  AnthropicReasoningMetadata,\n  AnthropicResponseContextManagement,\n  Citation,\n} from './anthropic-messages-api';\nimport {\n  AnthropicMessagesModelId,\n  anthropicProviderOptions,\n} from './anthropic-messages-options';\nimport { prepareTools } from './anthropic-prepare-tools';\nimport {\n  AnthropicMessagesUsage,\n  convertAnthropicMessagesUsage,\n} from './convert-anthropic-messages-usage';\nimport { convertToAnthropicMessagesPrompt } from './convert-to-anthropic-messages-prompt';\nimport { CacheControlValidator } from './get-cache-control';\nimport { mapAnthropicStopReason } from './map-anthropic-stop-reason';\n\nfunction createCitationSource(\n  citation: Citation,\n  citationDocuments: Array<{\n    title: string;\n    filename?: string;\n    mediaType: string;\n  }>,\n  generateId: () => string,\n): LanguageModelV3Source | undefined {\n  if (citation.type !== 'page_location' && citation.type !== 'char_location') {\n    return;\n  }\n\n  const documentInfo = citationDocuments[citation.document_index];\n\n  if (!documentInfo) {\n    return;\n  }\n\n  return {\n    type: 'source' as const,\n    sourceType: 'document' as const,\n    id: generateId(),\n    mediaType: documentInfo.mediaType,\n    title: citation.document_title ?? documentInfo.title,\n    filename: documentInfo.filename,\n    providerMetadata: {\n      anthropic:\n        citation.type === 'page_location'\n          ? {\n              citedText: citation.cited_text,\n              startPageNumber: citation.start_page_number,\n              endPageNumber: citation.end_page_number,\n            }\n          : {\n              citedText: citation.cited_text,\n              startCharIndex: citation.start_char_index,\n              endCharIndex: citation.end_char_index,\n            },\n    } satisfies SharedV3ProviderMetadata,\n  };\n}\n\ntype AnthropicMessagesConfig = {\n  provider: string;\n  baseURL: string;\n  headers: Resolvable<Record<string, string | undefined>>;\n  fetch?: FetchFunction;\n  buildRequestUrl?: (baseURL: string, isStreaming: boolean) => string;\n  transformRequestBody?: (args: Record<string, any>) => Record<string, any>;\n  supportedUrls?: () => LanguageModelV3['supportedUrls'];\n  generateId?: () => string;\n\n  /**\n   * When false, the model will use JSON tool fallback for structured outputs.\n   */\n  supportsNativeStructuredOutput?: boolean;\n};\n\nexport class AnthropicMessagesLanguageModel implements LanguageModelV3 {\n  readonly specificationVersion = 'v3';\n\n  readonly modelId: AnthropicMessagesModelId;\n\n  private readonly config: AnthropicMessagesConfig;\n  private readonly generateId: () => string;\n\n  constructor(\n    modelId: AnthropicMessagesModelId,\n    config: AnthropicMessagesConfig,\n  ) {\n    this.modelId = modelId;\n    this.config = config;\n    this.generateId = config.generateId ?? generateId;\n  }\n\n  supportsUrl(url: URL): boolean {\n    return url.protocol === 'https:';\n  }\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  get supportedUrls() {\n    return this.config.supportedUrls?.() ?? {};\n  }\n\n  private async getArgs({\n    userSuppliedBetas,\n    prompt,\n    maxOutputTokens,\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences,\n    responseFormat,\n    seed,\n    tools,\n    toolChoice,\n    providerOptions,\n    stream,\n  }: LanguageModelV3CallOptions & {\n    stream: boolean;\n    userSuppliedBetas: Set<string>;\n  }) {\n    const warnings: SharedV3Warning[] = [];\n\n    if (frequencyPenalty != null) {\n      warnings.push({ type: 'unsupported', feature: 'frequencyPenalty' });\n    }\n\n    if (presencePenalty != null) {\n      warnings.push({ type: 'unsupported', feature: 'presencePenalty' });\n    }\n\n    if (seed != null) {\n      warnings.push({ type: 'unsupported', feature: 'seed' });\n    }\n\n    if (temperature != null && temperature > 1) {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'temperature',\n        details: `${temperature} exceeds anthropic maximum of 1.0. clamped to 1.0`,\n      });\n      temperature = 1;\n    } else if (temperature != null && temperature < 0) {\n      warnings.push({\n        type: 'unsupported',\n        feature: 'temperature',\n        details: `${temperature} is below anthropic minimum of 0. clamped to 0`,\n      });\n      temperature = 0;\n    }\n\n    if (responseFormat?.type === 'json') {\n      if (responseFormat.schema == null) {\n        warnings.push({\n          type: 'unsupported',\n          feature: 'responseFormat',\n          details:\n            'JSON response format requires a schema. ' +\n            'The response format is ignored.',\n        });\n      }\n    }\n\n    const anthropicOptions = await parseProviderOptions({\n      provider: 'anthropic',\n      providerOptions,\n      schema: anthropicProviderOptions,\n    });\n\n    const {\n      maxOutputTokens: maxOutputTokensForModel,\n      supportsStructuredOutput: modelSupportsStructuredOutput,\n      isKnownModel,\n    } = getModelCapabilities(this.modelId);\n\n    const supportsStructuredOutput =\n      (this.config.supportsNativeStructuredOutput ?? true) &&\n      modelSupportsStructuredOutput;\n\n    const structureOutputMode =\n      anthropicOptions?.structuredOutputMode ?? 'auto';\n    const useStructuredOutput =\n      structureOutputMode === 'outputFormat' ||\n      (structureOutputMode === 'auto' && supportsStructuredOutput);\n\n    const jsonResponseTool: LanguageModelV3FunctionTool | undefined =\n      responseFormat?.type === 'json' &&\n      responseFormat.schema != null &&\n      !useStructuredOutput\n        ? {\n            type: 'function',\n            name: 'json',\n            description: 'Respond with a JSON object.',\n            inputSchema: responseFormat.schema,\n          }\n        : undefined;\n\n    const contextManagement = anthropicOptions?.contextManagement;\n\n    // Create a shared cache control validator to track breakpoints across tools and messages\n    const cacheControlValidator = new CacheControlValidator();\n\n    const toolNameMapping = createToolNameMapping({\n      tools,\n      providerToolNames: {\n        'anthropic.code_execution_20250522': 'code_execution',\n        'anthropic.code_execution_20250825': 'code_execution',\n        'anthropic.computer_20241022': 'computer',\n        'anthropic.computer_20250124': 'computer',\n        'anthropic.text_editor_20241022': 'str_replace_editor',\n        'anthropic.text_editor_20250124': 'str_replace_editor',\n        'anthropic.text_editor_20250429': 'str_replace_based_edit_tool',\n        'anthropic.text_editor_20250728': 'str_replace_based_edit_tool',\n        'anthropic.bash_20241022': 'bash',\n        'anthropic.bash_20250124': 'bash',\n        'anthropic.memory_20250818': 'memory',\n        'anthropic.web_search_20250305': 'web_search',\n        'anthropic.web_fetch_20250910': 'web_fetch',\n        'anthropic.tool_search_regex_20251119': 'tool_search_tool_regex',\n        'anthropic.tool_search_bm25_20251119': 'tool_search_tool_bm25',\n      },\n    });\n\n    const { prompt: messagesPrompt, betas } =\n      await convertToAnthropicMessagesPrompt({\n        prompt,\n        sendReasoning: anthropicOptions?.sendReasoning ?? true,\n        warnings,\n        cacheControlValidator,\n        toolNameMapping,\n      });\n\n    const isThinking = anthropicOptions?.thinking?.type === 'enabled';\n    let thinkingBudget = anthropicOptions?.thinking?.budgetTokens;\n\n    const maxTokens = maxOutputTokens ?? maxOutputTokensForModel;\n\n    const baseArgs = {\n      // model id:\n      model: this.modelId,\n\n      // standardized settings:\n      max_tokens: maxTokens,\n      temperature,\n      top_k: topK,\n      top_p: topP,\n      stop_sequences: stopSequences,\n\n      // provider specific settings:\n      ...(isThinking && {\n        thinking: { type: 'enabled', budget_tokens: thinkingBudget },\n      }),\n      ...(anthropicOptions?.effort && {\n        output_config: { effort: anthropicOptions.effort },\n      }),\n\n      // structured output:\n      ...(useStructuredOutput &&\n        responseFormat?.type === 'json' &&\n        responseFormat.schema != null && {\n          output_format: {\n            type: 'json_schema',\n            schema: responseFormat.schema,\n          },\n        }),\n\n      // mcp servers:\n      ...(anthropicOptions?.mcpServers &&\n        anthropicOptions.mcpServers.length > 0 && {\n          mcp_servers: anthropicOptions.mcpServers.map(server => ({\n            type: server.type,\n            name: server.name,\n            url: server.url,\n            authorization_token: server.authorizationToken,\n            tool_configuration: server.toolConfiguration\n              ? {\n                  allowed_tools: server.toolConfiguration.allowedTools,\n                  enabled: server.toolConfiguration.enabled,\n                }\n              : undefined,\n          })),\n        }),\n\n      // container: For programmatic tool calling (just an ID string) or agent skills (object with id and skills)\n      ...(anthropicOptions?.container && {\n        container:\n          anthropicOptions.container.skills &&\n          anthropicOptions.container.skills.length > 0\n            ? // Object format when skills are provided (agent skills feature)\n              ({\n                id: anthropicOptions.container.id,\n                skills: anthropicOptions.container.skills.map(skill => ({\n                  type: skill.type,\n                  skill_id: skill.skillId,\n                  version: skill.version,\n                })),\n              } satisfies AnthropicContainer)\n            : // String format for container ID only (programmatic tool calling)\n              anthropicOptions.container.id,\n      }),\n\n      // prompt:\n      system: messagesPrompt.system,\n      messages: messagesPrompt.messages,\n\n      ...(contextManagement && {\n        context_management: {\n          edits: contextManagement.edits\n            .map(edit => {\n              const strategy = edit.type;\n              switch (strategy) {\n                case 'clear_tool_uses_20250919':\n                  return {\n                    type: edit.type,\n                    ...(edit.trigger !== undefined && {\n                      trigger: edit.trigger,\n                    }),\n                    ...(edit.keep !== undefined && { keep: edit.keep }),\n                    ...(edit.clearAtLeast !== undefined && {\n                      clear_at_least: edit.clearAtLeast,\n                    }),\n                    ...(edit.clearToolInputs !== undefined && {\n                      clear_tool_inputs: edit.clearToolInputs,\n                    }),\n                    ...(edit.excludeTools !== undefined && {\n                      exclude_tools: edit.excludeTools,\n                    }),\n                  };\n\n                case 'clear_thinking_20251015':\n                  return {\n                    type: edit.type,\n                    ...(edit.keep !== undefined && { keep: edit.keep }),\n                  };\n\n                default:\n                  warnings.push({\n                    type: 'other',\n                    message: `Unknown context management strategy: ${strategy}`,\n                  });\n                  return undefined;\n              }\n            })\n            .filter(edit => edit !== undefined),\n        },\n      }),\n    };\n\n    if (isThinking) {\n      if (thinkingBudget == null) {\n        warnings.push({\n          type: 'compatibility',\n          feature: 'extended thinking',\n          details:\n            'thinking budget is required when thinking is enabled. using default budget of 1024 tokens.',\n        });\n\n        baseArgs.thinking = {\n          type: 'enabled',\n          budget_tokens: 1024,\n        };\n\n        thinkingBudget = 1024;\n      }\n\n      if (baseArgs.temperature != null) {\n        baseArgs.temperature = undefined;\n        warnings.push({\n          type: 'unsupported',\n          feature: 'temperature',\n          details: 'temperature is not supported when thinking is enabled',\n        });\n      }\n\n      if (topK != null) {\n        baseArgs.top_k = undefined;\n        warnings.push({\n          type: 'unsupported',\n          feature: 'topK',\n          details: 'topK is not supported when thinking is enabled',\n        });\n      }\n\n      if (topP != null) {\n        baseArgs.top_p = undefined;\n        warnings.push({\n          type: 'unsupported',\n          feature: 'topP',\n          details: 'topP is not supported when thinking is enabled',\n        });\n      }\n\n      // adjust max tokens to account for thinking:\n      baseArgs.max_tokens = maxTokens + (thinkingBudget ?? 0);\n    }\n\n    // limit to max output tokens for known models to enable model switching without breaking it:\n    if (isKnownModel && baseArgs.max_tokens > maxOutputTokensForModel) {\n      // only warn if max output tokens is provided as input:\n      if (maxOutputTokens != null) {\n        warnings.push({\n          type: 'unsupported',\n          feature: 'maxOutputTokens',\n          details:\n            `${baseArgs.max_tokens} (maxOutputTokens + thinkingBudget) is greater than ${this.modelId} ${maxOutputTokensForModel} max output tokens. ` +\n            `The max output tokens have been limited to ${maxOutputTokensForModel}.`,\n        });\n      }\n      baseArgs.max_tokens = maxOutputTokensForModel;\n    }\n\n    if (\n      anthropicOptions?.mcpServers &&\n      anthropicOptions.mcpServers.length > 0\n    ) {\n      betas.add('mcp-client-2025-04-04');\n    }\n\n    if (contextManagement) {\n      betas.add('context-management-2025-06-27');\n    }\n\n    if (\n      anthropicOptions?.container &&\n      anthropicOptions.container.skills &&\n      anthropicOptions.container.skills.length > 0\n    ) {\n      betas.add('code-execution-2025-08-25');\n      betas.add('skills-2025-10-02');\n      betas.add('files-api-2025-04-14');\n\n      if (\n        !tools?.some(\n          tool =>\n            tool.type === 'provider' &&\n            tool.id === 'anthropic.code_execution_20250825',\n        )\n      ) {\n        warnings.push({\n          type: 'other',\n          message: 'code execution tool is required when using skills',\n        });\n      }\n    }\n\n    if (anthropicOptions?.effort) {\n      betas.add('effort-2025-11-24');\n    }\n\n    // only when streaming: enable fine-grained tool streaming\n    if (stream && (anthropicOptions?.toolStreaming ?? true)) {\n      betas.add('fine-grained-tool-streaming-2025-05-14');\n    }\n\n    // structured output:\n    // Only pass beta when actually using native output_format\n    const usingNativeOutputFormat =\n      useStructuredOutput &&\n      responseFormat?.type === 'json' &&\n      responseFormat.schema != null;\n\n    if (usingNativeOutputFormat) {\n      betas.add('structured-outputs-2025-11-13');\n    }\n\n    const {\n      tools: anthropicTools,\n      toolChoice: anthropicToolChoice,\n      toolWarnings,\n      betas: toolsBetas,\n    } = await prepareTools(\n      jsonResponseTool != null\n        ? {\n            tools: [...(tools ?? []), jsonResponseTool],\n            toolChoice: { type: 'required' },\n            disableParallelToolUse: true,\n            cacheControlValidator,\n            supportsStructuredOutput,\n          }\n        : {\n            tools: tools ?? [],\n            toolChoice,\n            disableParallelToolUse: anthropicOptions?.disableParallelToolUse,\n            cacheControlValidator,\n            supportsStructuredOutput,\n          },\n    );\n\n    // Extract cache control warnings once at the end\n    const cacheWarnings = cacheControlValidator.getWarnings();\n\n    return {\n      args: {\n        ...baseArgs,\n        tools: anthropicTools,\n        tool_choice: anthropicToolChoice,\n        stream: stream === true ? true : undefined, // do not send when not streaming\n      },\n      warnings: [...warnings, ...toolWarnings, ...cacheWarnings],\n      betas: new Set([...betas, ...toolsBetas, ...userSuppliedBetas]),\n      usesJsonResponseTool: jsonResponseTool != null,\n      toolNameMapping,\n    };\n  }\n\n  private async getHeaders({\n    betas,\n    headers,\n  }: {\n    betas: Set<string>;\n    headers: Record<string, string | undefined> | undefined;\n  }) {\n    return combineHeaders(\n      await resolve(this.config.headers),\n      headers,\n      betas.size > 0 ? { 'anthropic-beta': Array.from(betas).join(',') } : {},\n    );\n  }\n\n  private async getBetasFromHeaders(\n    requestHeaders: Record<string, string | undefined> | undefined,\n  ) {\n    const configHeaders = await resolve(this.config.headers);\n\n    const configBetaHeader = configHeaders['anthropic-beta'] ?? '';\n    const requestBetaHeader = requestHeaders?.['anthropic-beta'] ?? '';\n\n    return new Set(\n      [\n        ...configBetaHeader.toLowerCase().split(','),\n        ...requestBetaHeader.toLowerCase().split(','),\n      ]\n        .map(beta => beta.trim())\n        .filter(beta => beta !== ''),\n    );\n  }\n\n  private buildRequestUrl(isStreaming: boolean): string {\n    return (\n      this.config.buildRequestUrl?.(this.config.baseURL, isStreaming) ??\n      `${this.config.baseURL}/messages`\n    );\n  }\n\n  private transformRequestBody(args: Record<string, any>): Record<string, any> {\n    return this.config.transformRequestBody?.(args) ?? args;\n  }\n\n  private extractCitationDocuments(prompt: LanguageModelV3Prompt): Array<{\n    title: string;\n    filename?: string;\n    mediaType: string;\n  }> {\n    const isCitationPart = (part: {\n      type: string;\n      mediaType?: string;\n      providerOptions?: { anthropic?: { citations?: { enabled?: boolean } } };\n    }) => {\n      if (part.type !== 'file') {\n        return false;\n      }\n\n      if (\n        part.mediaType !== 'application/pdf' &&\n        part.mediaType !== 'text/plain'\n      ) {\n        return false;\n      }\n\n      const anthropic = part.providerOptions?.anthropic;\n      const citationsConfig = anthropic?.citations as\n        | { enabled?: boolean }\n        | undefined;\n      return citationsConfig?.enabled ?? false;\n    };\n\n    return prompt\n      .filter(message => message.role === 'user')\n      .flatMap(message => message.content)\n      .filter(isCitationPart)\n      .map(part => {\n        // TypeScript knows this is a file part due to our filter\n        const filePart = part as Extract<typeof part, { type: 'file' }>;\n        return {\n          title: filePart.filename ?? 'Untitled Document',\n          filename: filePart.filename,\n          mediaType: filePart.mediaType,\n        };\n      });\n  }\n\n  async doGenerate(\n    options: LanguageModelV3CallOptions,\n  ): Promise<LanguageModelV3GenerateResult> {\n    const { args, warnings, betas, usesJsonResponseTool, toolNameMapping } =\n      await this.getArgs({\n        ...options,\n        stream: false,\n        userSuppliedBetas: await this.getBetasFromHeaders(options.headers),\n      });\n\n    // Extract citation documents for response processing\n    const citationDocuments = this.extractCitationDocuments(options.prompt);\n\n    const {\n      responseHeaders,\n      value: response,\n      rawValue: rawResponse,\n    } = await postJsonToApi({\n      url: this.buildRequestUrl(false),\n      headers: await this.getHeaders({ betas, headers: options.headers }),\n      body: this.transformRequestBody(args),\n      failedResponseHandler: anthropicFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        anthropicMessagesResponseSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const content: Array<LanguageModelV3Content> = [];\n    const mcpToolCalls: Record<string, LanguageModelV3ToolCall> = {};\n    let isJsonResponseFromTool = false;\n\n    // map response content to content array\n    for (const part of response.content) {\n      switch (part.type) {\n        case 'text': {\n          if (!usesJsonResponseTool) {\n            content.push({ type: 'text', text: part.text });\n\n            // Process citations if present\n            if (part.citations) {\n              for (const citation of part.citations) {\n                const source = createCitationSource(\n                  citation,\n                  citationDocuments,\n                  this.generateId,\n                );\n\n                if (source) {\n                  content.push(source);\n                }\n              }\n            }\n          }\n          break;\n        }\n        case 'thinking': {\n          content.push({\n            type: 'reasoning',\n            text: part.thinking,\n            providerMetadata: {\n              anthropic: {\n                signature: part.signature,\n              } satisfies AnthropicReasoningMetadata,\n            },\n          });\n          break;\n        }\n        case 'redacted_thinking': {\n          content.push({\n            type: 'reasoning',\n            text: '',\n            providerMetadata: {\n              anthropic: {\n                redactedData: part.data,\n              } satisfies AnthropicReasoningMetadata,\n            },\n          });\n          break;\n        }\n        case 'tool_use': {\n          const isJsonResponseTool =\n            usesJsonResponseTool && part.name === 'json';\n\n          if (isJsonResponseTool) {\n            isJsonResponseFromTool = true;\n\n            // when a json response tool is used, the tool call becomes the text:\n            content.push({\n              type: 'text',\n              text: JSON.stringify(part.input),\n            });\n          } else {\n            const caller = part.caller;\n            const callerInfo = caller\n              ? {\n                  type: caller.type,\n                  toolId: 'tool_id' in caller ? caller.tool_id : undefined,\n                }\n              : undefined;\n\n            content.push({\n              type: 'tool-call',\n              toolCallId: part.id,\n              toolName: part.name,\n              input: JSON.stringify(part.input),\n              ...(callerInfo && {\n                providerMetadata: {\n                  anthropic: {\n                    caller: callerInfo,\n                  },\n                },\n              }),\n            });\n          }\n\n          break;\n        }\n        case 'server_tool_use': {\n          // code execution 20250825 needs mapping:\n          if (\n            part.name === 'text_editor_code_execution' ||\n            part.name === 'bash_code_execution'\n          ) {\n            content.push({\n              type: 'tool-call',\n              toolCallId: part.id,\n              toolName: toolNameMapping.toCustomToolName('code_execution'),\n              input: JSON.stringify({ type: part.name, ...part.input }),\n              providerExecuted: true,\n            });\n          } else if (\n            part.name === 'web_search' ||\n            part.name === 'code_execution' ||\n            part.name === 'web_fetch'\n          ) {\n            // For code_execution, inject 'programmatic-tool-call' type when input has { code } format\n            const inputToSerialize =\n              part.name === 'code_execution' &&\n              part.input != null &&\n              typeof part.input === 'object' &&\n              'code' in part.input &&\n              !('type' in part.input)\n                ? { type: 'programmatic-tool-call', ...part.input }\n                : part.input;\n\n            content.push({\n              type: 'tool-call',\n              toolCallId: part.id,\n              toolName: toolNameMapping.toCustomToolName(part.name),\n              input: JSON.stringify(inputToSerialize),\n              providerExecuted: true,\n            });\n          } else if (\n            part.name === 'tool_search_tool_regex' ||\n            part.name === 'tool_search_tool_bm25'\n          ) {\n            content.push({\n              type: 'tool-call',\n              toolCallId: part.id,\n              toolName: toolNameMapping.toCustomToolName(part.name),\n              input: JSON.stringify(part.input),\n              providerExecuted: true,\n            });\n          }\n\n          break;\n        }\n        case 'mcp_tool_use': {\n          mcpToolCalls[part.id] = {\n            type: 'tool-call',\n            toolCallId: part.id,\n            toolName: part.name,\n            input: JSON.stringify(part.input),\n            providerExecuted: true,\n            dynamic: true,\n            providerMetadata: {\n              anthropic: {\n                type: 'mcp-tool-use',\n                serverName: part.server_name,\n              },\n            },\n          };\n          content.push(mcpToolCalls[part.id]);\n          break;\n        }\n        case 'mcp_tool_result': {\n          content.push({\n            type: 'tool-result',\n            toolCallId: part.tool_use_id,\n            toolName: mcpToolCalls[part.tool_use_id].toolName,\n            isError: part.is_error,\n            result: part.content,\n            dynamic: true,\n            providerMetadata: mcpToolCalls[part.tool_use_id].providerMetadata,\n          });\n          break;\n        }\n        case 'web_fetch_tool_result': {\n          if (part.content.type === 'web_fetch_result') {\n            content.push({\n              type: 'tool-result',\n              toolCallId: part.tool_use_id,\n              toolName: toolNameMapping.toCustomToolName('web_fetch'),\n              result: {\n                type: 'web_fetch_result',\n                url: part.content.url,\n                retrievedAt: part.content.retrieved_at,\n                content: {\n                  type: part.content.content.type,\n                  title: part.content.content.title,\n                  citations: part.content.content.citations,\n                  source: {\n                    type: part.content.content.source.type,\n                    mediaType: part.content.content.source.media_type,\n                    data: part.content.content.source.data,\n                  },\n                },\n              },\n            });\n          } else if (part.content.type === 'web_fetch_tool_result_error') {\n            content.push({\n              type: 'tool-result',\n              toolCallId: part.tool_use_id,\n              toolName: toolNameMapping.toCustomToolName('web_fetch'),\n              isError: true,\n              result: {\n                type: 'web_fetch_tool_result_error',\n                errorCode: part.content.error_code,\n              },\n            });\n          }\n          break;\n        }\n        case 'web_search_tool_result': {\n          if (Array.isArray(part.content)) {\n            content.push({\n              type: 'tool-result',\n              toolCallId: part.tool_use_id,\n              toolName: toolNameMapping.toCustomToolName('web_search'),\n              result: part.content.map(result => ({\n                url: result.url,\n                title: result.title,\n                pageAge: result.page_age ?? null,\n                encryptedContent: result.encrypted_content,\n                type: result.type,\n              })),\n            });\n\n            for (const result of part.content) {\n              content.push({\n                type: 'source',\n                sourceType: 'url',\n                id: this.generateId(),\n                url: result.url,\n                title: result.title,\n                providerMetadata: {\n                  anthropic: {\n                    pageAge: result.page_age ?? null,\n                  },\n                },\n              });\n            }\n          } else {\n            content.push({\n              type: 'tool-result',\n              toolCallId: part.tool_use_id,\n              toolName: toolNameMapping.toCustomToolName('web_search'),\n              isError: true,\n              result: {\n                type: 'web_search_tool_result_error',\n                errorCode: part.content.error_code,\n              },\n            });\n          }\n          break;\n        }\n\n        // code execution 20250522:\n        case 'code_execution_tool_result': {\n          if (part.content.type === 'code_execution_result') {\n            content.push({\n              type: 'tool-result',\n              toolCallId: part.tool_use_id,\n              toolName: toolNameMapping.toCustomToolName('code_execution'),\n              result: {\n                type: part.content.type,\n                stdout: part.content.stdout,\n                stderr: part.content.stderr,\n                return_code: part.content.return_code,\n                content: part.content.content ?? [],\n              },\n            });\n          } else if (part.content.type === 'code_execution_tool_result_error') {\n            content.push({\n              type: 'tool-result',\n              toolCallId: part.tool_use_id,\n              toolName: toolNameMapping.toCustomToolName('code_execution'),\n              isError: true,\n              result: {\n                type: 'code_execution_tool_result_error',\n                errorCode: part.content.error_code,\n              },\n            });\n          }\n          break;\n        }\n\n        // code execution 20250825:\n        case 'bash_code_execution_tool_result':\n        case 'text_editor_code_execution_tool_result': {\n          content.push({\n            type: 'tool-result',\n            toolCallId: part.tool_use_id,\n            toolName: toolNameMapping.toCustomToolName('code_execution'),\n            result: part.content,\n          });\n          break;\n        }\n\n        // tool search tool results:\n        case 'tool_search_tool_result': {\n          if (part.content.type === 'tool_search_tool_search_result') {\n            content.push({\n              type: 'tool-result',\n              toolCallId: part.tool_use_id,\n              toolName: toolNameMapping.toCustomToolName('tool_search'),\n              result: part.content.tool_references.map(ref => ({\n                type: ref.type,\n                toolName: ref.tool_name,\n              })),\n            });\n          } else {\n            content.push({\n              type: 'tool-result',\n              toolCallId: part.tool_use_id,\n              toolName: toolNameMapping.toCustomToolName('tool_search'),\n              isError: true,\n              result: {\n                type: 'tool_search_tool_result_error',\n                errorCode: part.content.error_code,\n              },\n            });\n          }\n          break;\n        }\n      }\n    }\n\n    return {\n      content,\n      finishReason: {\n        unified: mapAnthropicStopReason({\n          finishReason: response.stop_reason,\n          isJsonResponseFromTool,\n        }),\n        raw: response.stop_reason ?? undefined,\n      },\n      usage: convertAnthropicMessagesUsage(response.usage),\n      request: { body: args },\n      response: {\n        id: response.id ?? undefined,\n        modelId: response.model ?? undefined,\n        headers: responseHeaders,\n        body: rawResponse,\n      },\n      warnings,\n      providerMetadata: {\n        anthropic: {\n          usage: response.usage as JSONObject,\n          cacheCreationInputTokens:\n            response.usage.cache_creation_input_tokens ?? null,\n          stopSequence: response.stop_sequence ?? null,\n          container: response.container\n            ? {\n                expiresAt: response.container.expires_at,\n                id: response.container.id,\n                skills:\n                  response.container.skills?.map(skill => ({\n                    type: skill.type,\n                    skillId: skill.skill_id,\n                    version: skill.version,\n                  })) ?? null,\n              }\n            : null,\n          contextManagement:\n            mapAnthropicResponseContextManagement(\n              response.context_management,\n            ) ?? null,\n        } satisfies AnthropicMessageMetadata,\n      },\n    };\n  }\n\n  async doStream(\n    options: LanguageModelV3CallOptions,\n  ): Promise<LanguageModelV3StreamResult> {\n    const {\n      args: body,\n      warnings,\n      betas,\n      usesJsonResponseTool,\n      toolNameMapping,\n    } = await this.getArgs({\n      ...options,\n      stream: true,\n      userSuppliedBetas: await this.getBetasFromHeaders(options.headers),\n    });\n\n    // Extract citation documents for response processing\n    const citationDocuments = this.extractCitationDocuments(options.prompt);\n\n    const url = this.buildRequestUrl(true);\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url,\n      headers: await this.getHeaders({ betas, headers: options.headers }),\n      body: this.transformRequestBody(body),\n      failedResponseHandler: anthropicFailedResponseHandler,\n      successfulResponseHandler: createEventSourceResponseHandler(\n        anthropicMessagesChunkSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    let finishReason: LanguageModelV3FinishReason = {\n      unified: 'other',\n      raw: undefined,\n    };\n    const usage: AnthropicMessagesUsage = {\n      input_tokens: 0,\n      output_tokens: 0,\n      cache_creation_input_tokens: 0,\n      cache_read_input_tokens: 0,\n    };\n\n    const contentBlocks: Record<\n      number,\n      | {\n          type: 'tool-call';\n          toolCallId: string;\n          toolName: string;\n          input: string;\n          providerExecuted?: boolean;\n          firstDelta: boolean;\n          providerToolName?: string;\n          caller?: {\n            type: 'code_execution_20250825' | 'direct';\n            toolId?: string;\n          };\n        }\n      | { type: 'text' | 'reasoning' }\n    > = {};\n    const mcpToolCalls: Record<string, LanguageModelV3ToolCall> = {};\n\n    let contextManagement:\n      | AnthropicMessageMetadata['contextManagement']\n      | null = null;\n    let rawUsage: JSONObject | undefined = undefined;\n    let cacheCreationInputTokens: number | null = null;\n    let stopSequence: string | null = null;\n    let container: AnthropicMessageMetadata['container'] | null = null;\n    let isJsonResponseFromTool = false;\n\n    let blockType:\n      | 'text'\n      | 'thinking'\n      | 'tool_use'\n      | 'redacted_thinking'\n      | 'server_tool_use'\n      | 'web_fetch_tool_result'\n      | 'web_search_tool_result'\n      | 'code_execution_tool_result'\n      | 'text_editor_code_execution_tool_result'\n      | 'bash_code_execution_tool_result'\n      | 'tool_search_tool_result'\n      | 'mcp_tool_use'\n      | 'mcp_tool_result'\n      | undefined = undefined;\n\n    const generateId = this.generateId;\n\n    const transformedStream = response.pipeThrough(\n      new TransformStream<\n        ParseResult<InferSchema<typeof anthropicMessagesChunkSchema>>,\n        LanguageModelV3StreamPart\n      >({\n        start(controller) {\n          controller.enqueue({ type: 'stream-start', warnings });\n        },\n\n        transform(chunk, controller) {\n          if (options.includeRawChunks) {\n            controller.enqueue({ type: 'raw', rawValue: chunk.rawValue });\n          }\n\n          if (!chunk.success) {\n            controller.enqueue({ type: 'error', error: chunk.error });\n            return;\n          }\n\n          const value = chunk.value;\n\n          switch (value.type) {\n            case 'ping': {\n              return; // ignored\n            }\n\n            case 'content_block_start': {\n              const part = value.content_block;\n              const contentBlockType = part.type;\n              blockType = contentBlockType;\n\n              switch (contentBlockType) {\n                case 'text': {\n                  // when a json response tool is used, the tool call is returned as text,\n                  // so we ignore the text content:\n                  if (usesJsonResponseTool) {\n                    return;\n                  }\n\n                  contentBlocks[value.index] = { type: 'text' };\n                  controller.enqueue({\n                    type: 'text-start',\n                    id: String(value.index),\n                  });\n                  return;\n                }\n\n                case 'thinking': {\n                  contentBlocks[value.index] = { type: 'reasoning' };\n                  controller.enqueue({\n                    type: 'reasoning-start',\n                    id: String(value.index),\n                  });\n                  return;\n                }\n\n                case 'redacted_thinking': {\n                  contentBlocks[value.index] = { type: 'reasoning' };\n                  controller.enqueue({\n                    type: 'reasoning-start',\n                    id: String(value.index),\n                    providerMetadata: {\n                      anthropic: {\n                        redactedData: part.data,\n                      } satisfies AnthropicReasoningMetadata,\n                    },\n                  });\n                  return;\n                }\n\n                case 'tool_use': {\n                  const isJsonResponseTool =\n                    usesJsonResponseTool && part.name === 'json';\n\n                  if (isJsonResponseTool) {\n                    isJsonResponseFromTool = true;\n\n                    contentBlocks[value.index] = { type: 'text' };\n\n                    controller.enqueue({\n                      type: 'text-start',\n                      id: String(value.index),\n                    });\n                  } else {\n                    // Extract caller info for type-safe access\n                    const caller = part.caller;\n                    const callerInfo = caller\n                      ? {\n                          type: caller.type,\n                          toolId:\n                            'tool_id' in caller ? caller.tool_id : undefined,\n                        }\n                      : undefined;\n\n                    // Programmatic tool calling: for deferred tool calls from code_execution,\n                    // input may be present directly in content_block_start.\n                    // Only use if non-empty (empty {} means input comes via deltas)\n                    const hasNonEmptyInput =\n                      part.input && Object.keys(part.input).length > 0;\n                    const initialInput = hasNonEmptyInput\n                      ? JSON.stringify(part.input)\n                      : '';\n\n                    contentBlocks[value.index] = {\n                      type: 'tool-call',\n                      toolCallId: part.id,\n                      toolName: part.name,\n                      input: initialInput,\n                      firstDelta: initialInput.length === 0,\n                      ...(callerInfo && { caller: callerInfo }),\n                    };\n\n                    controller.enqueue({\n                      type: 'tool-input-start',\n                      id: part.id,\n                      toolName: part.name,\n                    });\n                  }\n                  return;\n                }\n\n                case 'server_tool_use': {\n                  if (\n                    [\n                      'web_fetch',\n                      'web_search',\n                      // code execution 20250825:\n                      'code_execution',\n                      // code execution 20250825 text editor:\n                      'text_editor_code_execution',\n                      // code execution 20250825 bash:\n                      'bash_code_execution',\n                    ].includes(part.name)\n                  ) {\n                    // map tool names for the code execution 20250825 tool:\n                    const providerToolName =\n                      part.name === 'text_editor_code_execution' ||\n                      part.name === 'bash_code_execution'\n                        ? 'code_execution'\n                        : part.name;\n\n                    const customToolName =\n                      toolNameMapping.toCustomToolName(providerToolName);\n\n                    contentBlocks[value.index] = {\n                      type: 'tool-call',\n                      toolCallId: part.id,\n                      toolName: customToolName,\n                      input: '',\n                      providerExecuted: true,\n                      firstDelta: true,\n                      providerToolName: part.name,\n                    };\n\n                    controller.enqueue({\n                      type: 'tool-input-start',\n                      id: part.id,\n                      toolName: customToolName,\n                      providerExecuted: true,\n                    });\n                  } else if (\n                    part.name === 'tool_search_tool_regex' ||\n                    part.name === 'tool_search_tool_bm25'\n                  ) {\n                    const customToolName = toolNameMapping.toCustomToolName(\n                      part.name,\n                    );\n\n                    contentBlocks[value.index] = {\n                      type: 'tool-call',\n                      toolCallId: part.id,\n                      toolName: customToolName,\n                      input: '',\n                      providerExecuted: true,\n                      firstDelta: true,\n                      providerToolName: part.name,\n                    };\n\n                    controller.enqueue({\n                      type: 'tool-input-start',\n                      id: part.id,\n                      toolName: customToolName,\n                      providerExecuted: true,\n                    });\n                  }\n\n                  return;\n                }\n\n                case 'web_fetch_tool_result': {\n                  if (part.content.type === 'web_fetch_result') {\n                    controller.enqueue({\n                      type: 'tool-result',\n                      toolCallId: part.tool_use_id,\n                      toolName: toolNameMapping.toCustomToolName('web_fetch'),\n                      result: {\n                        type: 'web_fetch_result',\n                        url: part.content.url,\n                        retrievedAt: part.content.retrieved_at,\n                        content: {\n                          type: part.content.content.type,\n                          title: part.content.content.title,\n                          citations: part.content.content.citations,\n                          source: {\n                            type: part.content.content.source.type,\n                            mediaType: part.content.content.source.media_type,\n                            data: part.content.content.source.data,\n                          },\n                        },\n                      },\n                    });\n                  } else if (\n                    part.content.type === 'web_fetch_tool_result_error'\n                  ) {\n                    controller.enqueue({\n                      type: 'tool-result',\n                      toolCallId: part.tool_use_id,\n                      toolName: toolNameMapping.toCustomToolName('web_fetch'),\n                      isError: true,\n                      result: {\n                        type: 'web_fetch_tool_result_error',\n                        errorCode: part.content.error_code,\n                      },\n                    });\n                  }\n\n                  return;\n                }\n\n                case 'web_search_tool_result': {\n                  if (Array.isArray(part.content)) {\n                    controller.enqueue({\n                      type: 'tool-result',\n                      toolCallId: part.tool_use_id,\n                      toolName: toolNameMapping.toCustomToolName('web_search'),\n                      result: part.content.map(result => ({\n                        url: result.url,\n                        title: result.title,\n                        pageAge: result.page_age ?? null,\n                        encryptedContent: result.encrypted_content,\n                        type: result.type,\n                      })),\n                    });\n\n                    for (const result of part.content) {\n                      controller.enqueue({\n                        type: 'source',\n                        sourceType: 'url',\n                        id: generateId(),\n                        url: result.url,\n                        title: result.title,\n                        providerMetadata: {\n                          anthropic: {\n                            pageAge: result.page_age ?? null,\n                          },\n                        },\n                      });\n                    }\n                  } else {\n                    controller.enqueue({\n                      type: 'tool-result',\n                      toolCallId: part.tool_use_id,\n                      toolName: toolNameMapping.toCustomToolName('web_search'),\n                      isError: true,\n                      result: {\n                        type: 'web_search_tool_result_error',\n                        errorCode: part.content.error_code,\n                      },\n                    });\n                  }\n                  return;\n                }\n\n                // code execution 20250522:\n                case 'code_execution_tool_result': {\n                  if (part.content.type === 'code_execution_result') {\n                    controller.enqueue({\n                      type: 'tool-result',\n                      toolCallId: part.tool_use_id,\n                      toolName:\n                        toolNameMapping.toCustomToolName('code_execution'),\n                      result: {\n                        type: part.content.type,\n                        stdout: part.content.stdout,\n                        stderr: part.content.stderr,\n                        return_code: part.content.return_code,\n                        content: part.content.content ?? [],\n                      },\n                    });\n                  } else if (\n                    part.content.type === 'code_execution_tool_result_error'\n                  ) {\n                    controller.enqueue({\n                      type: 'tool-result',\n                      toolCallId: part.tool_use_id,\n                      toolName:\n                        toolNameMapping.toCustomToolName('code_execution'),\n                      isError: true,\n                      result: {\n                        type: 'code_execution_tool_result_error',\n                        errorCode: part.content.error_code,\n                      },\n                    });\n                  }\n\n                  return;\n                }\n\n                // code execution 20250825:\n                case 'bash_code_execution_tool_result':\n                case 'text_editor_code_execution_tool_result': {\n                  controller.enqueue({\n                    type: 'tool-result',\n                    toolCallId: part.tool_use_id,\n                    toolName:\n                      toolNameMapping.toCustomToolName('code_execution'),\n                    result: part.content,\n                  });\n                  return;\n                }\n\n                // tool search tool results:\n                case 'tool_search_tool_result': {\n                  if (part.content.type === 'tool_search_tool_search_result') {\n                    controller.enqueue({\n                      type: 'tool-result',\n                      toolCallId: part.tool_use_id,\n                      toolName: toolNameMapping.toCustomToolName('tool_search'),\n                      result: part.content.tool_references.map(ref => ({\n                        type: ref.type,\n                        toolName: ref.tool_name,\n                      })),\n                    });\n                  } else {\n                    controller.enqueue({\n                      type: 'tool-result',\n                      toolCallId: part.tool_use_id,\n                      toolName: toolNameMapping.toCustomToolName('tool_search'),\n                      isError: true,\n                      result: {\n                        type: 'tool_search_tool_result_error',\n                        errorCode: part.content.error_code,\n                      },\n                    });\n                  }\n                  return;\n                }\n\n                case 'mcp_tool_use': {\n                  mcpToolCalls[part.id] = {\n                    type: 'tool-call',\n                    toolCallId: part.id,\n                    toolName: part.name,\n                    input: JSON.stringify(part.input),\n                    providerExecuted: true,\n                    dynamic: true,\n                    providerMetadata: {\n                      anthropic: {\n                        type: 'mcp-tool-use',\n                        serverName: part.server_name,\n                      },\n                    },\n                  };\n                  controller.enqueue(mcpToolCalls[part.id]);\n                  return;\n                }\n\n                case 'mcp_tool_result': {\n                  controller.enqueue({\n                    type: 'tool-result',\n                    toolCallId: part.tool_use_id,\n                    toolName: mcpToolCalls[part.tool_use_id].toolName,\n                    isError: part.is_error,\n                    result: part.content,\n                    dynamic: true,\n                    providerMetadata:\n                      mcpToolCalls[part.tool_use_id].providerMetadata,\n                  });\n                  return;\n                }\n\n                default: {\n                  const _exhaustiveCheck: never = contentBlockType;\n                  throw new Error(\n                    `Unsupported content block type: ${_exhaustiveCheck}`,\n                  );\n                }\n              }\n            }\n\n            case 'content_block_stop': {\n              // when finishing a tool call block, send the full tool call:\n              if (contentBlocks[value.index] != null) {\n                const contentBlock = contentBlocks[value.index];\n\n                switch (contentBlock.type) {\n                  case 'text': {\n                    controller.enqueue({\n                      type: 'text-end',\n                      id: String(value.index),\n                    });\n                    break;\n                  }\n\n                  case 'reasoning': {\n                    controller.enqueue({\n                      type: 'reasoning-end',\n                      id: String(value.index),\n                    });\n                    break;\n                  }\n\n                  case 'tool-call':\n                    // when a json response tool is used, the tool call is returned as text,\n                    // so we ignore the tool call content:\n                    const isJsonResponseTool =\n                      usesJsonResponseTool && contentBlock.toolName === 'json';\n\n                    if (!isJsonResponseTool) {\n                      controller.enqueue({\n                        type: 'tool-input-end',\n                        id: contentBlock.toolCallId,\n                      });\n\n                      // For code_execution, inject 'programmatic-tool-call' type\n                      // when input has { code } format (programmatic tool calling)\n                      let finalInput =\n                        contentBlock.input === '' ? '{}' : contentBlock.input;\n                      if (contentBlock.providerToolName === 'code_execution') {\n                        try {\n                          const parsed = JSON.parse(finalInput);\n                          if (\n                            parsed != null &&\n                            typeof parsed === 'object' &&\n                            'code' in parsed &&\n                            !('type' in parsed)\n                          ) {\n                            finalInput = JSON.stringify({\n                              type: 'programmatic-tool-call',\n                              ...parsed,\n                            });\n                          }\n                        } catch {\n                          // ignore parse errors, use original input\n                        }\n                      }\n\n                      controller.enqueue({\n                        type: 'tool-call',\n                        toolCallId: contentBlock.toolCallId,\n                        toolName: contentBlock.toolName,\n                        input: finalInput,\n                        providerExecuted: contentBlock.providerExecuted,\n                        ...(contentBlock.caller && {\n                          providerMetadata: {\n                            anthropic: {\n                              caller: contentBlock.caller,\n                            },\n                          },\n                        }),\n                      });\n                    }\n                    break;\n                }\n\n                delete contentBlocks[value.index];\n              }\n\n              blockType = undefined; // reset block type\n\n              return;\n            }\n\n            case 'content_block_delta': {\n              const deltaType = value.delta.type;\n\n              switch (deltaType) {\n                case 'text_delta': {\n                  // when a json response tool is used, the tool call is returned as text,\n                  // so we ignore the text content:\n                  if (usesJsonResponseTool) {\n                    return; // excluding the text-start will also exclude the text-end\n                  }\n\n                  controller.enqueue({\n                    type: 'text-delta',\n                    id: String(value.index),\n                    delta: value.delta.text,\n                  });\n\n                  return;\n                }\n\n                case 'thinking_delta': {\n                  controller.enqueue({\n                    type: 'reasoning-delta',\n                    id: String(value.index),\n                    delta: value.delta.thinking,\n                  });\n\n                  return;\n                }\n\n                case 'signature_delta': {\n                  // signature are only supported on thinking blocks:\n                  if (blockType === 'thinking') {\n                    controller.enqueue({\n                      type: 'reasoning-delta',\n                      id: String(value.index),\n                      delta: '',\n                      providerMetadata: {\n                        anthropic: {\n                          signature: value.delta.signature,\n                        } satisfies AnthropicReasoningMetadata,\n                      },\n                    });\n                  }\n\n                  return;\n                }\n\n                case 'input_json_delta': {\n                  const contentBlock = contentBlocks[value.index];\n                  let delta = value.delta.partial_json;\n\n                  // skip empty deltas to enable replacing the first character\n                  // in the code execution 20250825 tool.\n                  if (delta.length === 0) {\n                    return;\n                  }\n\n                  if (isJsonResponseFromTool) {\n                    if (contentBlock?.type !== 'text') {\n                      return; // exclude reasoning\n                    }\n\n                    controller.enqueue({\n                      type: 'text-delta',\n                      id: String(value.index),\n                      delta,\n                    });\n                  } else {\n                    if (contentBlock?.type !== 'tool-call') {\n                      return;\n                    }\n\n                    // for the code execution 20250825, we need to add\n                    // the type to the delta and change the tool name.\n                    if (\n                      contentBlock.firstDelta &&\n                      (contentBlock.providerToolName ===\n                        'bash_code_execution' ||\n                        contentBlock.providerToolName ===\n                          'text_editor_code_execution')\n                    ) {\n                      delta = `{\"type\": \"${contentBlock.providerToolName}\",${delta.substring(1)}`;\n                    }\n\n                    controller.enqueue({\n                      type: 'tool-input-delta',\n                      id: contentBlock.toolCallId,\n                      delta,\n                    });\n\n                    contentBlock.input += delta;\n                    contentBlock.firstDelta = false;\n                  }\n\n                  return;\n                }\n\n                case 'citations_delta': {\n                  const citation = value.delta.citation;\n                  const source = createCitationSource(\n                    citation,\n                    citationDocuments,\n                    generateId,\n                  );\n\n                  if (source) {\n                    controller.enqueue(source);\n                  }\n\n                  return;\n                }\n\n                default: {\n                  const _exhaustiveCheck: never = deltaType;\n                  throw new Error(\n                    `Unsupported delta type: ${_exhaustiveCheck}`,\n                  );\n                }\n              }\n            }\n\n            case 'message_start': {\n              usage.input_tokens = value.message.usage.input_tokens;\n              usage.cache_read_input_tokens =\n                value.message.usage.cache_read_input_tokens ?? 0;\n              usage.cache_creation_input_tokens =\n                value.message.usage.cache_creation_input_tokens ?? 0;\n\n              rawUsage = {\n                ...(value.message.usage as JSONObject),\n              };\n\n              cacheCreationInputTokens =\n                value.message.usage.cache_creation_input_tokens ?? null;\n\n              if (value.message.container != null) {\n                container = {\n                  expiresAt: value.message.container.expires_at,\n                  id: value.message.container.id,\n                  skills: null,\n                };\n              }\n\n              if (value.message.stop_reason != null) {\n                finishReason = {\n                  unified: mapAnthropicStopReason({\n                    finishReason: value.message.stop_reason,\n                    isJsonResponseFromTool,\n                  }),\n                  raw: value.message.stop_reason,\n                };\n              }\n\n              controller.enqueue({\n                type: 'response-metadata',\n                id: value.message.id ?? undefined,\n                modelId: value.message.model ?? undefined,\n              });\n\n              // Programmatic tool calling: process pre-populated content blocks\n              // (for deferred tool calls, content may be in message_start)\n              if (value.message.content != null) {\n                for (\n                  let contentIndex = 0;\n                  contentIndex < value.message.content.length;\n                  contentIndex++\n                ) {\n                  const part = value.message.content[contentIndex];\n                  if (part.type === 'tool_use') {\n                    const caller = part.caller;\n                    const callerInfo = caller\n                      ? {\n                          type: caller.type,\n                          toolId:\n                            'tool_id' in caller ? caller.tool_id : undefined,\n                        }\n                      : undefined;\n\n                    controller.enqueue({\n                      type: 'tool-input-start',\n                      id: part.id,\n                      toolName: part.name,\n                    });\n\n                    const inputStr = JSON.stringify(part.input ?? {});\n                    controller.enqueue({\n                      type: 'tool-input-delta',\n                      id: part.id,\n                      delta: inputStr,\n                    });\n\n                    controller.enqueue({\n                      type: 'tool-input-end',\n                      id: part.id,\n                    });\n\n                    controller.enqueue({\n                      type: 'tool-call',\n                      toolCallId: part.id,\n                      toolName: part.name,\n                      input: inputStr,\n                      ...(callerInfo && {\n                        providerMetadata: {\n                          anthropic: {\n                            caller: callerInfo,\n                          },\n                        },\n                      }),\n                    });\n                  }\n                }\n              }\n\n              return;\n            }\n\n            case 'message_delta': {\n              usage.output_tokens = value.usage.output_tokens;\n\n              finishReason = {\n                unified: mapAnthropicStopReason({\n                  finishReason: value.delta.stop_reason,\n                  isJsonResponseFromTool,\n                }),\n                raw: value.delta.stop_reason ?? undefined,\n              };\n\n              stopSequence = value.delta.stop_sequence ?? null;\n              container =\n                value.delta.container != null\n                  ? {\n                      expiresAt: value.delta.container.expires_at,\n                      id: value.delta.container.id,\n                      skills:\n                        value.delta.container.skills?.map(skill => ({\n                          type: skill.type,\n                          skillId: skill.skill_id,\n                          version: skill.version,\n                        })) ?? null,\n                    }\n                  : null;\n\n              if (value.delta.context_management) {\n                contextManagement = mapAnthropicResponseContextManagement(\n                  value.delta.context_management,\n                );\n              }\n\n              rawUsage = {\n                ...rawUsage,\n                ...(value.usage as JSONObject),\n              };\n\n              return;\n            }\n\n            case 'message_stop': {\n              controller.enqueue({\n                type: 'finish',\n                finishReason,\n                usage: convertAnthropicMessagesUsage(usage),\n                providerMetadata: {\n                  anthropic: {\n                    usage: (rawUsage as JSONObject) ?? null,\n                    cacheCreationInputTokens,\n                    stopSequence,\n                    container,\n                    contextManagement,\n                  } satisfies AnthropicMessageMetadata,\n                },\n              });\n              return;\n            }\n\n            case 'error': {\n              controller.enqueue({ type: 'error', error: value.error });\n              return;\n            }\n\n            default: {\n              const _exhaustiveCheck: never = value;\n              throw new Error(`Unsupported chunk type: ${_exhaustiveCheck}`);\n            }\n          }\n        },\n      }),\n    );\n\n    // The first chunk needs to be pulled immediately to check if it is an error\n    const [streamForFirstChunk, streamForConsumer] = transformedStream.tee();\n\n    const firstChunkReader = streamForFirstChunk.getReader();\n    try {\n      await firstChunkReader.read(); // streamStart comes first, ignored\n\n      let result = await firstChunkReader.read();\n\n      // when raw chunks are enabled, the first chunk is a raw chunk, so we need to read the next chunk\n      if (result.value?.type === 'raw') {\n        result = await firstChunkReader.read();\n      }\n\n      // The Anthropic API returns 200 responses when there are overloaded errors.\n      // We handle the case where the first chunk is an error here and transform\n      // it into an APICallError.\n      if (result.value?.type === 'error') {\n        const error = result.value.error as { message: string; type: string };\n\n        throw new APICallError({\n          message: error.message,\n          url,\n          requestBodyValues: body,\n          statusCode: error.type === 'overloaded_error' ? 529 : 500,\n          responseHeaders,\n          responseBody: JSON.stringify(error),\n          isRetryable: error.type === 'overloaded_error',\n        });\n      }\n    } finally {\n      firstChunkReader.cancel().catch(() => {});\n      firstChunkReader.releaseLock();\n    }\n\n    return {\n      stream: streamForConsumer,\n      request: { body },\n      response: { headers: responseHeaders },\n    };\n  }\n}\n\n/**\n * Returns the capabilities of a Claude model that are used for defaults and feature selection.\n *\n * @see https://docs.claude.com/en/docs/about-claude/models/overview#model-comparison-table\n * @see https://platform.claude.com/docs/en/build-with-claude/structured-outputs\n */\nfunction getModelCapabilities(modelId: string): {\n  maxOutputTokens: number;\n  supportsStructuredOutput: boolean;\n  isKnownModel: boolean;\n} {\n  if (\n    modelId.includes('claude-sonnet-4-5') ||\n    modelId.includes('claude-opus-4-5')\n  ) {\n    return {\n      maxOutputTokens: 64000,\n      supportsStructuredOutput: true,\n      isKnownModel: true,\n    };\n  } else if (modelId.includes('claude-opus-4-1')) {\n    return {\n      maxOutputTokens: 32000,\n      supportsStructuredOutput: true,\n      isKnownModel: true,\n    };\n  } else if (\n    modelId.includes('claude-sonnet-4-') ||\n    modelId.includes('claude-3-7-sonnet') ||\n    modelId.includes('claude-haiku-4-5')\n  ) {\n    return {\n      maxOutputTokens: 64000,\n      supportsStructuredOutput: false,\n      isKnownModel: true,\n    };\n  } else if (modelId.includes('claude-opus-4-')) {\n    return {\n      maxOutputTokens: 32000,\n      supportsStructuredOutput: false,\n      isKnownModel: true,\n    };\n  } else if (modelId.includes('claude-3-5-haiku')) {\n    return {\n      maxOutputTokens: 8192,\n      supportsStructuredOutput: false,\n      isKnownModel: true,\n    };\n  } else if (modelId.includes('claude-3-haiku')) {\n    return {\n      maxOutputTokens: 4096,\n      supportsStructuredOutput: false,\n      isKnownModel: true,\n    };\n  } else {\n    return {\n      maxOutputTokens: 4096,\n      supportsStructuredOutput: false,\n      isKnownModel: false,\n    };\n  }\n}\n\nfunction mapAnthropicResponseContextManagement(\n  contextManagement: AnthropicResponseContextManagement | null | undefined,\n): AnthropicMessageMetadata['contextManagement'] | null {\n  return contextManagement\n    ? {\n        appliedEdits: contextManagement.applied_edits\n          .map(edit => {\n            const strategy = edit.type;\n\n            switch (strategy) {\n              case 'clear_tool_uses_20250919':\n                return {\n                  type: edit.type,\n                  clearedToolUses: edit.cleared_tool_uses,\n                  clearedInputTokens: edit.cleared_input_tokens,\n                };\n\n              case 'clear_thinking_20251015':\n                return {\n                  type: edit.type,\n                  clearedThinkingTurns: edit.cleared_thinking_turns,\n                  clearedInputTokens: edit.cleared_input_tokens,\n                };\n            }\n          })\n          .filter(edit => edit !== undefined),\n      }\n    : null;\n}\n","import {\n  createJsonErrorResponseHandler,\n  InferSchema,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nexport const anthropicErrorDataSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      type: z.literal('error'),\n      error: z.object({\n        type: z.string(),\n        message: z.string(),\n      }),\n    }),\n  ),\n);\n\nexport type AnthropicErrorData = InferSchema<typeof anthropicErrorDataSchema>;\n\nexport const anthropicFailedResponseHandler = createJsonErrorResponseHandler({\n  errorSchema: anthropicErrorDataSchema,\n  errorToMessage: data => data.error.message,\n});\n","import { JSONSchema7 } from '@ai-sdk/provider';\nimport { InferSchema, lazySchema, zodSchema } from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nexport type AnthropicMessagesPrompt = {\n  system: Array<AnthropicTextContent> | undefined;\n  messages: AnthropicMessage[];\n};\n\nexport type AnthropicMessage = AnthropicUserMessage | AnthropicAssistantMessage;\n\nexport type AnthropicCacheControl = {\n  type: 'ephemeral';\n  ttl?: '5m' | '1h';\n};\n\nexport interface AnthropicUserMessage {\n  role: 'user';\n  content: Array<\n    | AnthropicTextContent\n    | AnthropicImageContent\n    | AnthropicDocumentContent\n    | AnthropicToolResultContent\n  >;\n}\n\nexport interface AnthropicAssistantMessage {\n  role: 'assistant';\n  content: Array<\n    | AnthropicTextContent\n    | AnthropicThinkingContent\n    | AnthropicRedactedThinkingContent\n    | AnthropicToolCallContent\n    | AnthropicServerToolUseContent\n    | AnthropicCodeExecutionToolResultContent\n    | AnthropicWebFetchToolResultContent\n    | AnthropicWebSearchToolResultContent\n    | AnthropicToolSearchToolResultContent\n    | AnthropicBashCodeExecutionToolResultContent\n    | AnthropicTextEditorCodeExecutionToolResultContent\n    | AnthropicMcpToolUseContent\n    | AnthropicMcpToolResultContent\n  >;\n}\n\nexport interface AnthropicTextContent {\n  type: 'text';\n  text: string;\n  cache_control: AnthropicCacheControl | undefined;\n}\n\nexport interface AnthropicThinkingContent {\n  type: 'thinking';\n  thinking: string;\n  signature: string;\n  // Note: thinking blocks cannot be directly cached with cache_control.\n  // They are cached implicitly when appearing in previous assistant turns.\n  cache_control?: never;\n}\n\nexport interface AnthropicRedactedThinkingContent {\n  type: 'redacted_thinking';\n  data: string;\n  // Note: redacted thinking blocks cannot be directly cached with cache_control.\n  // They are cached implicitly when appearing in previous assistant turns.\n  cache_control?: never;\n}\n\ntype AnthropicContentSource =\n  | {\n      type: 'base64';\n      media_type: string;\n      data: string;\n    }\n  | {\n      type: 'url';\n      url: string;\n    }\n  | {\n      type: 'text';\n      media_type: 'text/plain';\n      data: string;\n    };\n\nexport interface AnthropicImageContent {\n  type: 'image';\n  source: AnthropicContentSource;\n  cache_control: AnthropicCacheControl | undefined;\n}\n\nexport interface AnthropicDocumentContent {\n  type: 'document';\n  source: AnthropicContentSource;\n  title?: string;\n  context?: string;\n  citations?: { enabled: boolean };\n  cache_control: AnthropicCacheControl | undefined;\n}\n\n/**\n * The caller information for programmatic tool calling.\n * Present when a tool is called from within code execution.\n */\nexport type AnthropicToolCallCaller =\n  | {\n      type: 'code_execution_20250825';\n      tool_id: string;\n    }\n  | {\n      type: 'direct';\n    };\n\nexport interface AnthropicToolCallContent {\n  type: 'tool_use';\n  id: string;\n  name: string;\n  input: unknown;\n  /**\n   * Present when this tool call was triggered by a server-executed tool\n   * (e.g., code execution calling a user-defined tool programmatically).\n   */\n  caller?: AnthropicToolCallCaller;\n  cache_control: AnthropicCacheControl | undefined;\n}\n\nexport interface AnthropicServerToolUseContent {\n  type: 'server_tool_use';\n  id: string;\n  name:\n    | 'web_fetch'\n    | 'web_search'\n    // code execution 20250522:\n    | 'code_execution'\n    // code execution 20250825:\n    | 'bash_code_execution'\n    | 'text_editor_code_execution'\n    // tool search:\n    | 'tool_search_tool_regex'\n    | 'tool_search_tool_bm25';\n  input: unknown;\n  cache_control: AnthropicCacheControl | undefined;\n}\n\n// Nested content types for tool results (without cache_control)\n// Sub-content blocks cannot be cached directly according to Anthropic docs\ntype AnthropicNestedTextContent = Omit<\n  AnthropicTextContent,\n  'cache_control'\n> & {\n  cache_control?: never;\n};\n\ntype AnthropicNestedImageContent = Omit<\n  AnthropicImageContent,\n  'cache_control'\n> & {\n  cache_control?: never;\n};\n\ntype AnthropicNestedDocumentContent = Omit<\n  AnthropicDocumentContent,\n  'cache_control'\n> & {\n  cache_control?: never;\n};\n\nexport interface AnthropicToolResultContent {\n  type: 'tool_result';\n  tool_use_id: string;\n  content:\n    | string\n    | Array<\n        | AnthropicNestedTextContent\n        | AnthropicNestedImageContent\n        | AnthropicNestedDocumentContent\n      >;\n  is_error: boolean | undefined;\n  cache_control: AnthropicCacheControl | undefined;\n}\n\nexport interface AnthropicWebSearchToolResultContent {\n  type: 'web_search_tool_result';\n  tool_use_id: string;\n  content: Array<{\n    url: string;\n    title: string | null;\n    page_age: string | null;\n    encrypted_content: string;\n    type: string;\n  }>;\n  cache_control: AnthropicCacheControl | undefined;\n}\n\nexport interface AnthropicToolSearchToolResultContent {\n  type: 'tool_search_tool_result';\n  tool_use_id: string;\n  content:\n    | {\n        type: 'tool_search_tool_search_result';\n        tool_references: Array<{\n          type: 'tool_reference';\n          tool_name: string;\n        }>;\n      }\n    | {\n        type: 'tool_search_tool_result_error';\n        error_code: string;\n      };\n  cache_control: AnthropicCacheControl | undefined;\n}\n\n// code execution results for code_execution_20250522 tool:\nexport interface AnthropicCodeExecutionToolResultContent {\n  type: 'code_execution_tool_result';\n  tool_use_id: string;\n  content:\n    | {\n        type: 'code_execution_result';\n        stdout: string;\n        stderr: string;\n        return_code: number;\n        content: Array<{ type: 'code_execution_output'; file_id: string }>;\n      }\n    | {\n        type: 'code_execution_tool_result_error';\n        error_code: string;\n      };\n  cache_control: AnthropicCacheControl | undefined;\n}\n\n// text editor code execution results for code_execution_20250825 tool:\nexport interface AnthropicTextEditorCodeExecutionToolResultContent {\n  type: 'text_editor_code_execution_tool_result';\n  tool_use_id: string;\n  content:\n    | {\n        type: 'text_editor_code_execution_tool_result_error';\n        error_code: string;\n      }\n    | {\n        type: 'text_editor_code_execution_create_result';\n        is_file_update: boolean;\n      }\n    | {\n        type: 'text_editor_code_execution_view_result';\n        content: string;\n        file_type: string;\n        num_lines: number | null;\n        start_line: number | null;\n        total_lines: number | null;\n      }\n    | {\n        type: 'text_editor_code_execution_str_replace_result';\n        lines: string[] | null;\n        new_lines: number | null;\n        new_start: number | null;\n        old_lines: number | null;\n        old_start: number | null;\n      };\n  cache_control: AnthropicCacheControl | undefined;\n}\n\n// bash code execution results for code_execution_20250825 tool:\nexport interface AnthropicBashCodeExecutionToolResultContent {\n  type: 'bash_code_execution_tool_result';\n  tool_use_id: string;\n  content:\n    | {\n        type: 'bash_code_execution_result';\n        stdout: string;\n        stderr: string;\n        return_code: number;\n        content: {\n          type: 'bash_code_execution_output';\n          file_id: string;\n        }[];\n      }\n    | {\n        type: 'bash_code_execution_tool_result_error';\n        error_code: string;\n      };\n  cache_control: AnthropicCacheControl | undefined;\n}\n\nexport interface AnthropicWebFetchToolResultContent {\n  type: 'web_fetch_tool_result';\n  tool_use_id: string;\n  content:\n    | {\n        type: 'web_fetch_result';\n        url: string;\n        retrieved_at: string | null;\n        content: {\n          type: 'document';\n          title: string | null;\n          citations?: { enabled: boolean };\n          source:\n            | { type: 'base64'; media_type: 'application/pdf'; data: string }\n            | { type: 'text'; media_type: 'text/plain'; data: string };\n        };\n      }\n    | {\n        type: 'web_fetch_tool_result_error';\n        error_code: string;\n      };\n  cache_control: AnthropicCacheControl | undefined;\n}\nexport interface AnthropicMcpToolUseContent {\n  type: 'mcp_tool_use';\n  id: string;\n  name: string;\n  server_name: string;\n  input: unknown;\n  cache_control: AnthropicCacheControl | undefined;\n}\n\nexport interface AnthropicMcpToolResultContent {\n  type: 'mcp_tool_result';\n  tool_use_id: string;\n  is_error: boolean;\n  content: string | Array<{ type: 'text'; text: string }>;\n  cache_control: AnthropicCacheControl | undefined;\n}\n\nexport type AnthropicTool =\n  | {\n      name: string;\n      description: string | undefined;\n      input_schema: JSONSchema7;\n      cache_control: AnthropicCacheControl | undefined;\n      strict?: boolean;\n      /**\n       * When true, this tool is deferred and will only be loaded when\n       * discovered via the tool search tool.\n       */\n      defer_loading?: boolean;\n      /**\n       * Programmatic tool calling: specifies which server-executed tools\n       * are allowed to call this tool. When set, only the specified callers\n       * can invoke this tool programmatically.\n       *\n       * @example ['code_execution_20250825']\n       */\n      allowed_callers?: Array<'code_execution_20250825'>;\n    }\n  | {\n      type: 'code_execution_20250522';\n      name: string;\n      cache_control: AnthropicCacheControl | undefined;\n    }\n  | {\n      type: 'code_execution_20250825';\n      name: string;\n    }\n  | {\n      name: string;\n      type: 'computer_20250124' | 'computer_20241022';\n      display_width_px: number;\n      display_height_px: number;\n      display_number: number;\n      cache_control: AnthropicCacheControl | undefined;\n    }\n  | {\n      name: string;\n      type:\n        | 'text_editor_20250124'\n        | 'text_editor_20241022'\n        | 'text_editor_20250429';\n      cache_control: AnthropicCacheControl | undefined;\n    }\n  | {\n      name: string;\n      type: 'text_editor_20250728';\n      max_characters?: number;\n      cache_control: AnthropicCacheControl | undefined;\n    }\n  | {\n      name: string;\n      type: 'bash_20250124' | 'bash_20241022';\n      cache_control: AnthropicCacheControl | undefined;\n    }\n  | {\n      name: string;\n      type: 'memory_20250818';\n    }\n  | {\n      type: 'web_fetch_20250910';\n      name: string;\n      max_uses?: number;\n      allowed_domains?: string[];\n      blocked_domains?: string[];\n      citations?: { enabled: boolean };\n      max_content_tokens?: number;\n      cache_control: AnthropicCacheControl | undefined;\n    }\n  | {\n      type: 'web_search_20250305';\n      name: string;\n      max_uses?: number;\n      allowed_domains?: string[];\n      blocked_domains?: string[];\n      user_location?: {\n        type: 'approximate';\n        city?: string;\n        region?: string;\n        country?: string;\n        timezone?: string;\n      };\n      cache_control: AnthropicCacheControl | undefined;\n    }\n  | {\n      type: 'tool_search_tool_regex_20251119';\n      name: string;\n    }\n  | {\n      type: 'tool_search_tool_bm25_20251119';\n      name: string;\n    };\n\nexport type AnthropicToolChoice =\n  | { type: 'auto' | 'any'; disable_parallel_tool_use?: boolean }\n  | { type: 'tool'; name: string; disable_parallel_tool_use?: boolean };\n\nexport type AnthropicContainer = {\n  id?: string | null;\n  skills?: Array<{\n    type: 'anthropic' | 'custom';\n    skill_id: string;\n    version?: string;\n  }> | null;\n};\n\nexport type AnthropicInputTokensTrigger = {\n  type: 'input_tokens';\n  value: number;\n};\n\nexport type AnthropicToolUsesTrigger = {\n  type: 'tool_uses';\n  value: number;\n};\n\nexport type AnthropicContextManagementTrigger =\n  | AnthropicInputTokensTrigger\n  | AnthropicToolUsesTrigger;\n\nexport type AnthropicClearToolUsesEdit = {\n  type: 'clear_tool_uses_20250919';\n  trigger?: AnthropicContextManagementTrigger;\n  keep?: {\n    type: 'tool_uses';\n    value: number;\n  };\n  clear_at_least?: {\n    type: 'input_tokens';\n    value: number;\n  };\n  clear_tool_inputs?: boolean;\n  exclude_tools?: string[];\n};\n\nexport type AnthropicClearThinkingBlockEdit = {\n  type: 'clear_thinking_20251015';\n  keep?: 'all' | { type: 'thinking_turns'; value: number };\n};\n\nexport type AnthropicContextManagementEdit =\n  | AnthropicClearToolUsesEdit\n  | AnthropicClearThinkingBlockEdit;\n\nexport type AnthropicContextManagementConfig = {\n  edits: AnthropicContextManagementEdit[];\n};\n\nexport type AnthropicResponseClearToolUsesEdit = {\n  type: 'clear_tool_uses_20250919';\n  cleared_tool_uses: number;\n  cleared_input_tokens: number;\n};\n\nexport type AnthropicResponseClearThinkingBlockEdit = {\n  type: 'clear_thinking_20251015';\n  cleared_thinking_turns: number;\n  cleared_input_tokens: number;\n};\n\nexport type AnthropicResponseContextManagementEdit =\n  | AnthropicResponseClearToolUsesEdit\n  | AnthropicResponseClearThinkingBlockEdit;\n\nexport type AnthropicResponseContextManagement = {\n  applied_edits: AnthropicResponseContextManagementEdit[];\n};\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nexport const anthropicMessagesResponseSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      type: z.literal('message'),\n      id: z.string().nullish(),\n      model: z.string().nullish(),\n      content: z.array(\n        z.discriminatedUnion('type', [\n          z.object({\n            type: z.literal('text'),\n            text: z.string(),\n            citations: z\n              .array(\n                z.discriminatedUnion('type', [\n                  z.object({\n                    type: z.literal('web_search_result_location'),\n                    cited_text: z.string(),\n                    url: z.string(),\n                    title: z.string(),\n                    encrypted_index: z.string(),\n                  }),\n                  z.object({\n                    type: z.literal('page_location'),\n                    cited_text: z.string(),\n                    document_index: z.number(),\n                    document_title: z.string().nullable(),\n                    start_page_number: z.number(),\n                    end_page_number: z.number(),\n                  }),\n                  z.object({\n                    type: z.literal('char_location'),\n                    cited_text: z.string(),\n                    document_index: z.number(),\n                    document_title: z.string().nullable(),\n                    start_char_index: z.number(),\n                    end_char_index: z.number(),\n                  }),\n                ]),\n              )\n              .optional(),\n          }),\n          z.object({\n            type: z.literal('thinking'),\n            thinking: z.string(),\n            signature: z.string(),\n          }),\n          z.object({\n            type: z.literal('redacted_thinking'),\n            data: z.string(),\n          }),\n          z.object({\n            type: z.literal('tool_use'),\n            id: z.string(),\n            name: z.string(),\n            input: z.unknown(),\n            // Programmatic tool calling: caller info when triggered from code execution\n            caller: z\n              .union([\n                z.object({\n                  type: z.literal('code_execution_20250825'),\n                  tool_id: z.string(),\n                }),\n                z.object({\n                  type: z.literal('direct'),\n                }),\n              ])\n              .optional(),\n          }),\n          z.object({\n            type: z.literal('server_tool_use'),\n            id: z.string(),\n            name: z.string(),\n            input: z.record(z.string(), z.unknown()).nullish(),\n          }),\n          z.object({\n            type: z.literal('mcp_tool_use'),\n            id: z.string(),\n            name: z.string(),\n            input: z.unknown(),\n            server_name: z.string(),\n          }),\n          z.object({\n            type: z.literal('mcp_tool_result'),\n            tool_use_id: z.string(),\n            is_error: z.boolean(),\n            content: z.array(\n              z.union([\n                z.string(),\n                z.object({ type: z.literal('text'), text: z.string() }),\n              ]),\n            ),\n          }),\n          z.object({\n            type: z.literal('web_fetch_tool_result'),\n            tool_use_id: z.string(),\n            content: z.union([\n              z.object({\n                type: z.literal('web_fetch_result'),\n                url: z.string(),\n                retrieved_at: z.string(),\n                content: z.object({\n                  type: z.literal('document'),\n                  title: z.string().nullable(),\n                  citations: z.object({ enabled: z.boolean() }).optional(),\n                  source: z.union([\n                    z.object({\n                      type: z.literal('base64'),\n                      media_type: z.literal('application/pdf'),\n                      data: z.string(),\n                    }),\n                    z.object({\n                      type: z.literal('text'),\n                      media_type: z.literal('text/plain'),\n                      data: z.string(),\n                    }),\n                  ]),\n                }),\n              }),\n              z.object({\n                type: z.literal('web_fetch_tool_result_error'),\n                error_code: z.string(),\n              }),\n            ]),\n          }),\n          z.object({\n            type: z.literal('web_search_tool_result'),\n            tool_use_id: z.string(),\n            content: z.union([\n              z.array(\n                z.object({\n                  type: z.literal('web_search_result'),\n                  url: z.string(),\n                  title: z.string(),\n                  encrypted_content: z.string(),\n                  page_age: z.string().nullish(),\n                }),\n              ),\n              z.object({\n                type: z.literal('web_search_tool_result_error'),\n                error_code: z.string(),\n              }),\n            ]),\n          }),\n          // code execution results for code_execution_20250522 tool:\n          z.object({\n            type: z.literal('code_execution_tool_result'),\n            tool_use_id: z.string(),\n            content: z.union([\n              z.object({\n                type: z.literal('code_execution_result'),\n                stdout: z.string(),\n                stderr: z.string(),\n                return_code: z.number(),\n                content: z\n                  .array(\n                    z.object({\n                      type: z.literal('code_execution_output'),\n                      file_id: z.string(),\n                    }),\n                  )\n                  .optional()\n                  .default([]),\n              }),\n              z.object({\n                type: z.literal('code_execution_tool_result_error'),\n                error_code: z.string(),\n              }),\n            ]),\n          }),\n          // bash code execution results for code_execution_20250825 tool:\n          z.object({\n            type: z.literal('bash_code_execution_tool_result'),\n            tool_use_id: z.string(),\n            content: z.discriminatedUnion('type', [\n              z.object({\n                type: z.literal('bash_code_execution_result'),\n                content: z.array(\n                  z.object({\n                    type: z.literal('bash_code_execution_output'),\n                    file_id: z.string(),\n                  }),\n                ),\n                stdout: z.string(),\n                stderr: z.string(),\n                return_code: z.number(),\n              }),\n              z.object({\n                type: z.literal('bash_code_execution_tool_result_error'),\n                error_code: z.string(),\n              }),\n            ]),\n          }),\n          // text editor code execution results for code_execution_20250825 tool:\n          z.object({\n            type: z.literal('text_editor_code_execution_tool_result'),\n            tool_use_id: z.string(),\n            content: z.discriminatedUnion('type', [\n              z.object({\n                type: z.literal('text_editor_code_execution_tool_result_error'),\n                error_code: z.string(),\n              }),\n              z.object({\n                type: z.literal('text_editor_code_execution_view_result'),\n                content: z.string(),\n                file_type: z.string(),\n                num_lines: z.number().nullable(),\n                start_line: z.number().nullable(),\n                total_lines: z.number().nullable(),\n              }),\n              z.object({\n                type: z.literal('text_editor_code_execution_create_result'),\n                is_file_update: z.boolean(),\n              }),\n              z.object({\n                type: z.literal(\n                  'text_editor_code_execution_str_replace_result',\n                ),\n                lines: z.array(z.string()).nullable(),\n                new_lines: z.number().nullable(),\n                new_start: z.number().nullable(),\n                old_lines: z.number().nullable(),\n                old_start: z.number().nullable(),\n              }),\n            ]),\n          }),\n          // tool search tool results for tool_search_tool_regex_20251119 and tool_search_tool_bm25_20251119:\n          z.object({\n            type: z.literal('tool_search_tool_result'),\n            tool_use_id: z.string(),\n            content: z.union([\n              z.object({\n                type: z.literal('tool_search_tool_search_result'),\n                tool_references: z.array(\n                  z.object({\n                    type: z.literal('tool_reference'),\n                    tool_name: z.string(),\n                  }),\n                ),\n              }),\n              z.object({\n                type: z.literal('tool_search_tool_result_error'),\n                error_code: z.string(),\n              }),\n            ]),\n          }),\n        ]),\n      ),\n      stop_reason: z.string().nullish(),\n      stop_sequence: z.string().nullish(),\n      usage: z.looseObject({\n        input_tokens: z.number(),\n        output_tokens: z.number(),\n        cache_creation_input_tokens: z.number().nullish(),\n        cache_read_input_tokens: z.number().nullish(),\n      }),\n      container: z\n        .object({\n          expires_at: z.string(),\n          id: z.string(),\n          skills: z\n            .array(\n              z.object({\n                type: z.union([z.literal('anthropic'), z.literal('custom')]),\n                skill_id: z.string(),\n                version: z.string(),\n              }),\n            )\n            .nullish(),\n        })\n        .nullish(),\n      context_management: z\n        .object({\n          applied_edits: z.array(\n            z.union([\n              z.object({\n                type: z.literal('clear_tool_uses_20250919'),\n                cleared_tool_uses: z.number(),\n                cleared_input_tokens: z.number(),\n              }),\n              z.object({\n                type: z.literal('clear_thinking_20251015'),\n                cleared_thinking_turns: z.number(),\n                cleared_input_tokens: z.number(),\n              }),\n            ]),\n          ),\n        })\n        .nullish(),\n    }),\n  ),\n);\n\n// limited version of the schema, focused on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nexport const anthropicMessagesChunkSchema = lazySchema(() =>\n  zodSchema(\n    z.discriminatedUnion('type', [\n      z.object({\n        type: z.literal('message_start'),\n        message: z.object({\n          id: z.string().nullish(),\n          model: z.string().nullish(),\n          role: z.string().nullish(),\n          usage: z.looseObject({\n            input_tokens: z.number(),\n            cache_creation_input_tokens: z.number().nullish(),\n            cache_read_input_tokens: z.number().nullish(),\n          }),\n          // Programmatic tool calling: content may be pre-populated for deferred tool calls\n          content: z\n            .array(\n              z.discriminatedUnion('type', [\n                z.object({\n                  type: z.literal('tool_use'),\n                  id: z.string(),\n                  name: z.string(),\n                  input: z.unknown(),\n                  caller: z\n                    .union([\n                      z.object({\n                        type: z.literal('code_execution_20250825'),\n                        tool_id: z.string(),\n                      }),\n                      z.object({\n                        type: z.literal('direct'),\n                      }),\n                    ])\n                    .optional(),\n                }),\n              ]),\n            )\n            .nullish(),\n          stop_reason: z.string().nullish(),\n          container: z\n            .object({\n              expires_at: z.string(),\n              id: z.string(),\n            })\n            .nullish(),\n        }),\n      }),\n      z.object({\n        type: z.literal('content_block_start'),\n        index: z.number(),\n        content_block: z.discriminatedUnion('type', [\n          z.object({\n            type: z.literal('text'),\n            text: z.string(),\n          }),\n          z.object({\n            type: z.literal('thinking'),\n            thinking: z.string(),\n          }),\n          z.object({\n            type: z.literal('tool_use'),\n            id: z.string(),\n            name: z.string(),\n            // Programmatic tool calling: input may be present directly for deferred tool calls\n            input: z.record(z.string(), z.unknown()).optional(),\n            // Programmatic tool calling: caller info when triggered from code execution\n            caller: z\n              .union([\n                z.object({\n                  type: z.literal('code_execution_20250825'),\n                  tool_id: z.string(),\n                }),\n                z.object({\n                  type: z.literal('direct'),\n                }),\n              ])\n              .optional(),\n          }),\n          z.object({\n            type: z.literal('redacted_thinking'),\n            data: z.string(),\n          }),\n          z.object({\n            type: z.literal('server_tool_use'),\n            id: z.string(),\n            name: z.string(),\n            input: z.record(z.string(), z.unknown()).nullish(),\n          }),\n          z.object({\n            type: z.literal('mcp_tool_use'),\n            id: z.string(),\n            name: z.string(),\n            input: z.unknown(),\n            server_name: z.string(),\n          }),\n          z.object({\n            type: z.literal('mcp_tool_result'),\n            tool_use_id: z.string(),\n            is_error: z.boolean(),\n            content: z.array(\n              z.union([\n                z.string(),\n                z.object({ type: z.literal('text'), text: z.string() }),\n              ]),\n            ),\n          }),\n          z.object({\n            type: z.literal('web_fetch_tool_result'),\n            tool_use_id: z.string(),\n            content: z.union([\n              z.object({\n                type: z.literal('web_fetch_result'),\n                url: z.string(),\n                retrieved_at: z.string(),\n                content: z.object({\n                  type: z.literal('document'),\n                  title: z.string().nullable(),\n                  citations: z.object({ enabled: z.boolean() }).optional(),\n                  source: z.union([\n                    z.object({\n                      type: z.literal('base64'),\n                      media_type: z.literal('application/pdf'),\n                      data: z.string(),\n                    }),\n                    z.object({\n                      type: z.literal('text'),\n                      media_type: z.literal('text/plain'),\n                      data: z.string(),\n                    }),\n                  ]),\n                }),\n              }),\n              z.object({\n                type: z.literal('web_fetch_tool_result_error'),\n                error_code: z.string(),\n              }),\n            ]),\n          }),\n          z.object({\n            type: z.literal('web_search_tool_result'),\n            tool_use_id: z.string(),\n            content: z.union([\n              z.array(\n                z.object({\n                  type: z.literal('web_search_result'),\n                  url: z.string(),\n                  title: z.string(),\n                  encrypted_content: z.string(),\n                  page_age: z.string().nullish(),\n                }),\n              ),\n              z.object({\n                type: z.literal('web_search_tool_result_error'),\n                error_code: z.string(),\n              }),\n            ]),\n          }),\n          // code execution results for code_execution_20250522 tool:\n          z.object({\n            type: z.literal('code_execution_tool_result'),\n            tool_use_id: z.string(),\n            content: z.union([\n              z.object({\n                type: z.literal('code_execution_result'),\n                stdout: z.string(),\n                stderr: z.string(),\n                return_code: z.number(),\n                content: z\n                  .array(\n                    z.object({\n                      type: z.literal('code_execution_output'),\n                      file_id: z.string(),\n                    }),\n                  )\n                  .optional()\n                  .default([]),\n              }),\n              z.object({\n                type: z.literal('code_execution_tool_result_error'),\n                error_code: z.string(),\n              }),\n            ]),\n          }),\n          // bash code execution results for code_execution_20250825 tool:\n          z.object({\n            type: z.literal('bash_code_execution_tool_result'),\n            tool_use_id: z.string(),\n            content: z.discriminatedUnion('type', [\n              z.object({\n                type: z.literal('bash_code_execution_result'),\n                content: z.array(\n                  z.object({\n                    type: z.literal('bash_code_execution_output'),\n                    file_id: z.string(),\n                  }),\n                ),\n                stdout: z.string(),\n                stderr: z.string(),\n                return_code: z.number(),\n              }),\n              z.object({\n                type: z.literal('bash_code_execution_tool_result_error'),\n                error_code: z.string(),\n              }),\n            ]),\n          }),\n          // text editor code execution results for code_execution_20250825 tool:\n          z.object({\n            type: z.literal('text_editor_code_execution_tool_result'),\n            tool_use_id: z.string(),\n            content: z.discriminatedUnion('type', [\n              z.object({\n                type: z.literal('text_editor_code_execution_tool_result_error'),\n                error_code: z.string(),\n              }),\n              z.object({\n                type: z.literal('text_editor_code_execution_view_result'),\n                content: z.string(),\n                file_type: z.string(),\n                num_lines: z.number().nullable(),\n                start_line: z.number().nullable(),\n                total_lines: z.number().nullable(),\n              }),\n              z.object({\n                type: z.literal('text_editor_code_execution_create_result'),\n                is_file_update: z.boolean(),\n              }),\n              z.object({\n                type: z.literal(\n                  'text_editor_code_execution_str_replace_result',\n                ),\n                lines: z.array(z.string()).nullable(),\n                new_lines: z.number().nullable(),\n                new_start: z.number().nullable(),\n                old_lines: z.number().nullable(),\n                old_start: z.number().nullable(),\n              }),\n            ]),\n          }),\n          // tool search tool results for tool_search_tool_regex_20251119 and tool_search_tool_bm25_20251119:\n          z.object({\n            type: z.literal('tool_search_tool_result'),\n            tool_use_id: z.string(),\n            content: z.union([\n              z.object({\n                type: z.literal('tool_search_tool_search_result'),\n                tool_references: z.array(\n                  z.object({\n                    type: z.literal('tool_reference'),\n                    tool_name: z.string(),\n                  }),\n                ),\n              }),\n              z.object({\n                type: z.literal('tool_search_tool_result_error'),\n                error_code: z.string(),\n              }),\n            ]),\n          }),\n        ]),\n      }),\n      z.object({\n        type: z.literal('content_block_delta'),\n        index: z.number(),\n        delta: z.discriminatedUnion('type', [\n          z.object({\n            type: z.literal('input_json_delta'),\n            partial_json: z.string(),\n          }),\n          z.object({\n            type: z.literal('text_delta'),\n            text: z.string(),\n          }),\n          z.object({\n            type: z.literal('thinking_delta'),\n            thinking: z.string(),\n          }),\n          z.object({\n            type: z.literal('signature_delta'),\n            signature: z.string(),\n          }),\n          z.object({\n            type: z.literal('citations_delta'),\n            citation: z.discriminatedUnion('type', [\n              z.object({\n                type: z.literal('web_search_result_location'),\n                cited_text: z.string(),\n                url: z.string(),\n                title: z.string(),\n                encrypted_index: z.string(),\n              }),\n              z.object({\n                type: z.literal('page_location'),\n                cited_text: z.string(),\n                document_index: z.number(),\n                document_title: z.string().nullable(),\n                start_page_number: z.number(),\n                end_page_number: z.number(),\n              }),\n              z.object({\n                type: z.literal('char_location'),\n                cited_text: z.string(),\n                document_index: z.number(),\n                document_title: z.string().nullable(),\n                start_char_index: z.number(),\n                end_char_index: z.number(),\n              }),\n            ]),\n          }),\n        ]),\n      }),\n      z.object({\n        type: z.literal('content_block_stop'),\n        index: z.number(),\n      }),\n      z.object({\n        type: z.literal('error'),\n        error: z.object({\n          type: z.string(),\n          message: z.string(),\n        }),\n      }),\n      z.object({\n        type: z.literal('message_delta'),\n        delta: z.object({\n          stop_reason: z.string().nullish(),\n          stop_sequence: z.string().nullish(),\n          container: z\n            .object({\n              expires_at: z.string(),\n              id: z.string(),\n              skills: z\n                .array(\n                  z.object({\n                    type: z.union([\n                      z.literal('anthropic'),\n                      z.literal('custom'),\n                    ]),\n                    skill_id: z.string(),\n                    version: z.string(),\n                  }),\n                )\n                .nullish(),\n            })\n            .nullish(),\n          context_management: z\n            .object({\n              applied_edits: z.array(\n                z.union([\n                  z.object({\n                    type: z.literal('clear_tool_uses_20250919'),\n                    cleared_tool_uses: z.number(),\n                    cleared_input_tokens: z.number(),\n                  }),\n                  z.object({\n                    type: z.literal('clear_thinking_20251015'),\n                    cleared_thinking_turns: z.number(),\n                    cleared_input_tokens: z.number(),\n                  }),\n                ]),\n              ),\n            })\n            .nullish(),\n        }),\n        usage: z.looseObject({\n          output_tokens: z.number(),\n          cache_creation_input_tokens: z.number().nullish(),\n        }),\n      }),\n      z.object({\n        type: z.literal('message_stop'),\n      }),\n      z.object({\n        type: z.literal('ping'),\n      }),\n    ]),\n  ),\n);\n\nexport const anthropicReasoningMetadataSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      signature: z.string().optional(),\n      redactedData: z.string().optional(),\n    }),\n  ),\n);\n\nexport type AnthropicReasoningMetadata = InferSchema<\n  typeof anthropicReasoningMetadataSchema\n>;\n\nexport type Citation = NonNullable<\n  (InferSchema<typeof anthropicMessagesResponseSchema>['content'][number] & {\n    type: 'text';\n  })['citations']\n>[number];\n","import { z } from 'zod/v4';\n\n// https://docs.claude.com/en/docs/about-claude/models/overview\nexport type AnthropicMessagesModelId =\n  | 'claude-3-5-haiku-20241022'\n  | 'claude-3-5-haiku-latest'\n  | 'claude-3-7-sonnet-20250219'\n  | 'claude-3-7-sonnet-latest'\n  | 'claude-3-haiku-20240307'\n  | 'claude-haiku-4-5-20251001'\n  | 'claude-haiku-4-5'\n  | 'claude-opus-4-0'\n  | 'claude-opus-4-1-20250805'\n  | 'claude-opus-4-1'\n  | 'claude-opus-4-20250514'\n  | 'claude-opus-4-5'\n  | 'claude-opus-4-5-20251101'\n  | 'claude-sonnet-4-0'\n  | 'claude-sonnet-4-20250514'\n  | 'claude-sonnet-4-5-20250929'\n  | 'claude-sonnet-4-5'\n  | (string & {});\n\n/**\n * Anthropic file part provider options for document-specific features.\n * These options apply to individual file parts (documents).\n */\nexport const anthropicFilePartProviderOptions = z.object({\n  /**\n   * Citation configuration for this document.\n   * When enabled, this document will generate citations in the response.\n   */\n  citations: z\n    .object({\n      /**\n       * Enable citations for this document\n       */\n      enabled: z.boolean(),\n    })\n    .optional(),\n\n  /**\n   * Custom title for the document.\n   * If not provided, the filename will be used.\n   */\n  title: z.string().optional(),\n\n  /**\n   * Context about the document that will be passed to the model\n   * but not used towards cited content.\n   * Useful for storing document metadata as text or stringified JSON.\n   */\n  context: z.string().optional(),\n});\n\nexport type AnthropicFilePartProviderOptions = z.infer<\n  typeof anthropicFilePartProviderOptions\n>;\n\nexport const anthropicProviderOptions = z.object({\n  /**\n   * Whether to send reasoning to the model.\n   *\n   * This allows you to deactivate reasoning inputs for models that do not support them.\n   */\n  sendReasoning: z.boolean().optional(),\n\n  /**\n   * Determines how structured outputs are generated.\n   *\n   * - `outputFormat`: Use the `output_format` parameter to specify the structured output format.\n   * - `jsonTool`: Use a special 'json' tool to specify the structured output format.\n   * - `auto`: Use 'outputFormat' when supported, otherwise use 'jsonTool' (default).\n   */\n  structuredOutputMode: z.enum(['outputFormat', 'jsonTool', 'auto']).optional(),\n\n  /**\n   * Configuration for enabling Claude's extended thinking.\n   *\n   * When enabled, responses include thinking content blocks showing Claude's thinking process before the final answer.\n   * Requires a minimum budget of 1,024 tokens and counts towards the `max_tokens` limit.\n   */\n  thinking: z\n    .object({\n      type: z.union([z.literal('enabled'), z.literal('disabled')]),\n      budgetTokens: z.number().optional(),\n    })\n    .optional(),\n\n  /**\n   * Whether to disable parallel function calling during tool use. Default is false.\n   * When set to true, Claude will use at most one tool per response.\n   */\n  disableParallelToolUse: z.boolean().optional(),\n\n  /**\n   * Cache control settings for this message.\n   * See https://docs.anthropic.com/en/docs/build-with-claude/prompt-caching\n   */\n  cacheControl: z\n    .object({\n      type: z.literal('ephemeral'),\n      ttl: z.union([z.literal('5m'), z.literal('1h')]).optional(),\n    })\n    .optional(),\n\n  /**\n   * MCP servers to be utilized in this request.\n   */\n  mcpServers: z\n    .array(\n      z.object({\n        type: z.literal('url'),\n        name: z.string(),\n        url: z.string(),\n        authorizationToken: z.string().nullish(),\n        toolConfiguration: z\n          .object({\n            enabled: z.boolean().nullish(),\n            allowedTools: z.array(z.string()).nullish(),\n          })\n          .nullish(),\n      }),\n    )\n    .optional(),\n\n  /**\n   * Agent Skills configuration. Skills enable Claude to perform specialized tasks\n   * like document processing (PPTX, DOCX, PDF, XLSX) and data analysis.\n   * Requires code execution tool to be enabled.\n   */\n  container: z\n    .object({\n      id: z.string().optional(),\n      skills: z\n        .array(\n          z.object({\n            type: z.union([z.literal('anthropic'), z.literal('custom')]),\n            skillId: z.string(),\n            version: z.string().optional(),\n          }),\n        )\n        .optional(),\n    })\n    .optional(),\n\n  /**\n   * Whether to enable tool streaming (and structured output streaming).\n   *\n   * When set to false, the model will return all tool calls and results\n   * at once after a delay.\n   *\n   * @default true\n   */\n  toolStreaming: z.boolean().optional(),\n\n  /**\n   * @default 'high'\n   */\n  effort: z.enum(['low', 'medium', 'high']).optional(),\n\n  contextManagement: z\n    .object({\n      edits: z.array(\n        z.discriminatedUnion('type', [\n          z.object({\n            type: z.literal('clear_tool_uses_20250919'),\n            trigger: z\n              .discriminatedUnion('type', [\n                z.object({\n                  type: z.literal('input_tokens'),\n                  value: z.number(),\n                }),\n                z.object({\n                  type: z.literal('tool_uses'),\n                  value: z.number(),\n                }),\n              ])\n              .optional(),\n            keep: z\n              .object({\n                type: z.literal('tool_uses'),\n                value: z.number(),\n              })\n              .optional(),\n            clearAtLeast: z\n              .object({\n                type: z.literal('input_tokens'),\n                value: z.number(),\n              })\n              .optional(),\n            clearToolInputs: z.boolean().optional(),\n            excludeTools: z.array(z.string()).optional(),\n          }),\n          z.object({\n            type: z.literal('clear_thinking_20251015'),\n            keep: z\n              .union([\n                z.literal('all'),\n                z.object({\n                  type: z.literal('thinking_turns'),\n                  value: z.number(),\n                }),\n              ])\n              .optional(),\n          }),\n        ]),\n      ),\n    })\n    .optional(),\n});\n\nexport type AnthropicProviderOptions = z.infer<typeof anthropicProviderOptions>;\n","import {\n  LanguageModelV3CallOptions,\n  SharedV3Warning,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport { AnthropicTool, AnthropicToolChoice } from './anthropic-messages-api';\nimport { CacheControlValidator } from './get-cache-control';\nimport { textEditor_20250728ArgsSchema } from './tool/text-editor_20250728';\nimport { webSearch_20250305ArgsSchema } from './tool/web-search_20250305';\nimport { webFetch_20250910ArgsSchema } from './tool/web-fetch-20250910';\nimport { validateTypes } from '@ai-sdk/provider-utils';\n\nexport interface AnthropicToolOptions {\n  deferLoading?: boolean;\n  allowedCallers?: Array<'code_execution_20250825'>;\n}\n\nexport async function prepareTools({\n  tools,\n  toolChoice,\n  disableParallelToolUse,\n  cacheControlValidator,\n  supportsStructuredOutput,\n}: {\n  tools: LanguageModelV3CallOptions['tools'];\n  toolChoice: LanguageModelV3CallOptions['toolChoice'] | undefined;\n  disableParallelToolUse?: boolean;\n  cacheControlValidator?: CacheControlValidator;\n\n  /**\n   * Whether the model supports structured output.\n   */\n  supportsStructuredOutput: boolean;\n}): Promise<{\n  tools: Array<AnthropicTool> | undefined;\n  toolChoice: AnthropicToolChoice | undefined;\n  toolWarnings: SharedV3Warning[];\n  betas: Set<string>;\n}> {\n  // when the tools array is empty, change it to undefined to prevent errors:\n  tools = tools?.length ? tools : undefined;\n\n  const toolWarnings: SharedV3Warning[] = [];\n  const betas = new Set<string>();\n  const validator = cacheControlValidator || new CacheControlValidator();\n\n  if (tools == null) {\n    return { tools: undefined, toolChoice: undefined, toolWarnings, betas };\n  }\n\n  const anthropicTools: AnthropicTool[] = [];\n\n  for (const tool of tools) {\n    switch (tool.type) {\n      case 'function': {\n        const cacheControl = validator.getCacheControl(tool.providerOptions, {\n          type: 'tool definition',\n          canCache: true,\n        });\n\n        // Read Anthropic-specific provider options\n        const anthropicOptions = tool.providerOptions?.anthropic as\n          | AnthropicToolOptions\n          | undefined;\n        const deferLoading = anthropicOptions?.deferLoading;\n        const allowedCallers = anthropicOptions?.allowedCallers;\n\n        anthropicTools.push({\n          name: tool.name,\n          description: tool.description,\n          input_schema: tool.inputSchema,\n          cache_control: cacheControl,\n          ...(supportsStructuredOutput === true && tool.strict != null\n            ? { strict: tool.strict }\n            : {}),\n          ...(deferLoading != null ? { defer_loading: deferLoading } : {}),\n          ...(allowedCallers != null\n            ? { allowed_callers: allowedCallers }\n            : {}),\n          ...(tool.inputExamples != null\n            ? {\n                input_examples: tool.inputExamples.map(\n                  example => example.input,\n                ),\n              }\n            : {}),\n        });\n\n        if (supportsStructuredOutput === true) {\n          betas.add('structured-outputs-2025-11-13');\n        }\n\n        if (tool.inputExamples != null || allowedCallers != null) {\n          betas.add('advanced-tool-use-2025-11-20');\n        }\n\n        break;\n      }\n\n      case 'provider': {\n        // Note: Provider-defined tools don't currently support providerOptions in the SDK,\n        // so cache_control cannot be set on them. The Anthropic API supports caching all tools,\n        // but the SDK would need to be updated to expose providerOptions on provider-defined tools.\n        switch (tool.id) {\n          case 'anthropic.code_execution_20250522': {\n            betas.add('code-execution-2025-05-22');\n            anthropicTools.push({\n              type: 'code_execution_20250522',\n              name: 'code_execution',\n              cache_control: undefined,\n            });\n            break;\n          }\n          case 'anthropic.code_execution_20250825': {\n            betas.add('code-execution-2025-08-25');\n            anthropicTools.push({\n              type: 'code_execution_20250825',\n              name: 'code_execution',\n            });\n            break;\n          }\n          case 'anthropic.computer_20250124': {\n            betas.add('computer-use-2025-01-24');\n            anthropicTools.push({\n              name: 'computer',\n              type: 'computer_20250124',\n              display_width_px: tool.args.displayWidthPx as number,\n              display_height_px: tool.args.displayHeightPx as number,\n              display_number: tool.args.displayNumber as number,\n              cache_control: undefined,\n            });\n            break;\n          }\n          case 'anthropic.computer_20241022': {\n            betas.add('computer-use-2024-10-22');\n            anthropicTools.push({\n              name: 'computer',\n              type: 'computer_20241022',\n              display_width_px: tool.args.displayWidthPx as number,\n              display_height_px: tool.args.displayHeightPx as number,\n              display_number: tool.args.displayNumber as number,\n              cache_control: undefined,\n            });\n            break;\n          }\n          case 'anthropic.text_editor_20250124': {\n            betas.add('computer-use-2025-01-24');\n            anthropicTools.push({\n              name: 'str_replace_editor',\n              type: 'text_editor_20250124',\n              cache_control: undefined,\n            });\n            break;\n          }\n          case 'anthropic.text_editor_20241022': {\n            betas.add('computer-use-2024-10-22');\n            anthropicTools.push({\n              name: 'str_replace_editor',\n              type: 'text_editor_20241022',\n              cache_control: undefined,\n            });\n            break;\n          }\n          case 'anthropic.text_editor_20250429': {\n            betas.add('computer-use-2025-01-24');\n            anthropicTools.push({\n              name: 'str_replace_based_edit_tool',\n              type: 'text_editor_20250429',\n              cache_control: undefined,\n            });\n            break;\n          }\n          case 'anthropic.text_editor_20250728': {\n            const args = await validateTypes({\n              value: tool.args,\n              schema: textEditor_20250728ArgsSchema,\n            });\n            anthropicTools.push({\n              name: 'str_replace_based_edit_tool',\n              type: 'text_editor_20250728',\n              max_characters: args.maxCharacters,\n              cache_control: undefined,\n            });\n            break;\n          }\n          case 'anthropic.bash_20250124': {\n            betas.add('computer-use-2025-01-24');\n            anthropicTools.push({\n              name: 'bash',\n              type: 'bash_20250124',\n              cache_control: undefined,\n            });\n            break;\n          }\n          case 'anthropic.bash_20241022': {\n            betas.add('computer-use-2024-10-22');\n            anthropicTools.push({\n              name: 'bash',\n              type: 'bash_20241022',\n              cache_control: undefined,\n            });\n            break;\n          }\n          case 'anthropic.memory_20250818': {\n            betas.add('context-management-2025-06-27');\n            anthropicTools.push({\n              name: 'memory',\n              type: 'memory_20250818',\n            });\n            break;\n          }\n          case 'anthropic.web_fetch_20250910': {\n            betas.add('web-fetch-2025-09-10');\n            const args = await validateTypes({\n              value: tool.args,\n              schema: webFetch_20250910ArgsSchema,\n            });\n            anthropicTools.push({\n              type: 'web_fetch_20250910',\n              name: 'web_fetch',\n              max_uses: args.maxUses,\n              allowed_domains: args.allowedDomains,\n              blocked_domains: args.blockedDomains,\n              citations: args.citations,\n              max_content_tokens: args.maxContentTokens,\n              cache_control: undefined,\n            });\n            break;\n          }\n          case 'anthropic.web_search_20250305': {\n            const args = await validateTypes({\n              value: tool.args,\n              schema: webSearch_20250305ArgsSchema,\n            });\n            anthropicTools.push({\n              type: 'web_search_20250305',\n              name: 'web_search',\n              max_uses: args.maxUses,\n              allowed_domains: args.allowedDomains,\n              blocked_domains: args.blockedDomains,\n              user_location: args.userLocation,\n              cache_control: undefined,\n            });\n            break;\n          }\n\n          case 'anthropic.tool_search_regex_20251119': {\n            betas.add('advanced-tool-use-2025-11-20');\n            anthropicTools.push({\n              type: 'tool_search_tool_regex_20251119',\n              name: 'tool_search_tool_regex',\n            });\n            break;\n          }\n\n          case 'anthropic.tool_search_bm25_20251119': {\n            betas.add('advanced-tool-use-2025-11-20');\n            anthropicTools.push({\n              type: 'tool_search_tool_bm25_20251119',\n              name: 'tool_search_tool_bm25',\n            });\n            break;\n          }\n\n          default: {\n            toolWarnings.push({\n              type: 'unsupported',\n              feature: `provider-defined tool ${tool.id}`,\n            });\n            break;\n          }\n        }\n        break;\n      }\n\n      default: {\n        toolWarnings.push({\n          type: 'unsupported',\n          feature: `tool ${tool}`,\n        });\n        break;\n      }\n    }\n  }\n\n  if (toolChoice == null) {\n    return {\n      tools: anthropicTools,\n      toolChoice: disableParallelToolUse\n        ? { type: 'auto', disable_parallel_tool_use: disableParallelToolUse }\n        : undefined,\n      toolWarnings,\n      betas,\n    };\n  }\n\n  const type = toolChoice.type;\n\n  switch (type) {\n    case 'auto':\n      return {\n        tools: anthropicTools,\n        toolChoice: {\n          type: 'auto',\n          disable_parallel_tool_use: disableParallelToolUse,\n        },\n        toolWarnings,\n        betas,\n      };\n    case 'required':\n      return {\n        tools: anthropicTools,\n        toolChoice: {\n          type: 'any',\n          disable_parallel_tool_use: disableParallelToolUse,\n        },\n        toolWarnings,\n        betas,\n      };\n    case 'none':\n      // Anthropic does not support 'none' tool choice, so we remove the tools:\n      return { tools: undefined, toolChoice: undefined, toolWarnings, betas };\n    case 'tool':\n      return {\n        tools: anthropicTools,\n        toolChoice: {\n          type: 'tool',\n          name: toolChoice.toolName,\n          disable_parallel_tool_use: disableParallelToolUse,\n        },\n        toolWarnings,\n        betas,\n      };\n    default: {\n      const _exhaustiveCheck: never = type;\n      throw new UnsupportedFunctionalityError({\n        functionality: `tool choice type: ${_exhaustiveCheck}`,\n      });\n    }\n  }\n}\n","import { SharedV3Warning, SharedV3ProviderMetadata } from '@ai-sdk/provider';\nimport { AnthropicCacheControl } from './anthropic-messages-api';\n\n// Anthropic allows a maximum of 4 cache breakpoints per request\nconst MAX_CACHE_BREAKPOINTS = 4;\n\n// Helper function to extract cache_control from provider metadata\n// Allows both cacheControl and cache_control for flexibility\nfunction getCacheControl(\n  providerMetadata: SharedV3ProviderMetadata | undefined,\n): AnthropicCacheControl | undefined {\n  const anthropic = providerMetadata?.anthropic;\n\n  // allow both cacheControl and cache_control:\n  const cacheControlValue = anthropic?.cacheControl ?? anthropic?.cache_control;\n\n  // Pass through value assuming it is of the correct type.\n  // The Anthropic API will validate the value.\n  return cacheControlValue as AnthropicCacheControl | undefined;\n}\n\nexport class CacheControlValidator {\n  private breakpointCount = 0;\n  private warnings: SharedV3Warning[] = [];\n\n  getCacheControl(\n    providerMetadata: SharedV3ProviderMetadata | undefined,\n    context: { type: string; canCache: boolean },\n  ): AnthropicCacheControl | undefined {\n    const cacheControlValue = getCacheControl(providerMetadata);\n\n    if (!cacheControlValue) {\n      return undefined;\n    }\n\n    // Validate that cache_control is allowed in this context\n    if (!context.canCache) {\n      this.warnings.push({\n        type: 'unsupported',\n        feature: 'cache_control on non-cacheable context',\n        details: `cache_control cannot be set on ${context.type}. It will be ignored.`,\n      });\n      return undefined;\n    }\n\n    // Validate cache breakpoint limit\n    this.breakpointCount++;\n    if (this.breakpointCount > MAX_CACHE_BREAKPOINTS) {\n      this.warnings.push({\n        type: 'unsupported',\n        feature: 'cacheControl breakpoint limit',\n        details: `Maximum ${MAX_CACHE_BREAKPOINTS} cache breakpoints exceeded (found ${this.breakpointCount}). This breakpoint will be ignored.`,\n      });\n      return undefined;\n    }\n\n    return cacheControlValue;\n  }\n\n  getWarnings(): SharedV3Warning[] {\n    return this.warnings;\n  }\n}\n","import { createProviderToolFactory } from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\nimport { lazySchema, zodSchema } from '@ai-sdk/provider-utils';\n\nexport const textEditor_20250728ArgsSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      maxCharacters: z.number().optional(),\n    }),\n  ),\n);\n\nconst textEditor_20250728InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      command: z.enum(['view', 'create', 'str_replace', 'insert']),\n      path: z.string(),\n      file_text: z.string().optional(),\n      insert_line: z.number().int().optional(),\n      new_str: z.string().optional(),\n      old_str: z.string().optional(),\n      view_range: z.array(z.number().int()).optional(),\n    }),\n  ),\n);\n\nconst factory = createProviderToolFactory<\n  {\n    /**\n     * The commands to run. Allowed options are: `view`, `create`, `str_replace`, `insert`.\n     * Note: `undo_edit` is not supported in Claude 4 models.\n     */\n    command: 'view' | 'create' | 'str_replace' | 'insert';\n\n    /**\n     * Absolute path to file or directory, e.g. `/repo/file.py` or `/repo`.\n     */\n    path: string;\n\n    /**\n     * Required parameter of `create` command, with the content of the file to be created.\n     */\n    file_text?: string;\n\n    /**\n     * Required parameter of `insert` command. The `new_str` will be inserted AFTER the line `insert_line` of `path`.\n     */\n    insert_line?: number;\n\n    /**\n     * Optional parameter of `str_replace` command containing the new string (if not given, no string will be added). Required parameter of `insert` command containing the string to insert.\n     */\n    new_str?: string;\n\n    /**\n     * Required parameter of `str_replace` command containing the string in `path` to replace.\n     */\n    old_str?: string;\n\n    /**\n     * Optional parameter of `view` command when `path` points to a file. If none is given, the full file is shown. If provided, the file will be shown in the indicated line number range, e.g. [11, 12] will show lines 11 and 12. Indexing at 1 to start. Setting `[start_line, -1]` shows all lines from `start_line` to the end of the file.\n     */\n    view_range?: number[];\n  },\n  {\n    /**\n     * Optional parameter to control truncation when viewing large files. Only compatible with text_editor_20250728 and later versions.\n     */\n    maxCharacters?: number;\n  }\n>({\n  id: 'anthropic.text_editor_20250728',\n  inputSchema: textEditor_20250728InputSchema,\n});\n\nexport const textEditor_20250728 = (\n  args: Parameters<typeof factory>[0] = {}, // default\n) => {\n  return factory(args);\n};\n","import {\n  createProviderToolFactoryWithOutputSchema,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nexport const webSearch_20250305ArgsSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      maxUses: z.number().optional(),\n      allowedDomains: z.array(z.string()).optional(),\n      blockedDomains: z.array(z.string()).optional(),\n      userLocation: z\n        .object({\n          type: z.literal('approximate'),\n          city: z.string().optional(),\n          region: z.string().optional(),\n          country: z.string().optional(),\n          timezone: z.string().optional(),\n        })\n        .optional(),\n    }),\n  ),\n);\n\nexport const webSearch_20250305OutputSchema = lazySchema(() =>\n  zodSchema(\n    z.array(\n      z.object({\n        url: z.string(),\n        title: z.string().nullable(),\n        pageAge: z.string().nullable(),\n        encryptedContent: z.string(),\n        type: z.literal('web_search_result'),\n      }),\n    ),\n  ),\n);\n\nconst webSearch_20250305InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      query: z.string(),\n    }),\n  ),\n);\n\nconst factory = createProviderToolFactoryWithOutputSchema<\n  {\n    /**\n     * The search query to execute.\n     */\n    query: string;\n  },\n  Array<{\n    type: 'web_search_result';\n\n    /**\n     * The URL of the source page.\n     */\n    url: string;\n\n    /**\n     * The title of the source page.\n     */\n    title: string | null;\n\n    /**\n     * When the site was last updated\n     */\n    pageAge: string | null;\n\n    /**\n     * Encrypted content that must be passed back in multi-turn conversations for citations\n     */\n    encryptedContent: string;\n  }>,\n  {\n    /**\n     * Maximum number of web searches Claude can perform during the conversation.\n     */\n    maxUses?: number;\n\n    /**\n     * Optional list of domains that Claude is allowed to search.\n     */\n    allowedDomains?: string[];\n\n    /**\n     * Optional list of domains that Claude should avoid when searching.\n     */\n    blockedDomains?: string[];\n\n    /**\n     * Optional user location information to provide geographically relevant search results.\n     */\n    userLocation?: {\n      /**\n       * The type of location (must be approximate)\n       */\n      type: 'approximate';\n\n      /**\n       * The city name\n       */\n      city?: string;\n\n      /**\n       * The region or state\n       */\n      region?: string;\n\n      /**\n       * The country\n       */\n      country?: string;\n\n      /**\n       * The IANA timezone ID.\n       */\n      timezone?: string;\n    };\n  }\n>({\n  id: 'anthropic.web_search_20250305',\n  inputSchema: webSearch_20250305InputSchema,\n  outputSchema: webSearch_20250305OutputSchema,\n});\n\nexport const webSearch_20250305 = (\n  args: Parameters<typeof factory>[0] = {}, // default\n) => {\n  return factory(args);\n};\n","import {\n  createProviderToolFactoryWithOutputSchema,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nexport const webFetch_20250910ArgsSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      maxUses: z.number().optional(),\n      allowedDomains: z.array(z.string()).optional(),\n      blockedDomains: z.array(z.string()).optional(),\n      citations: z.object({ enabled: z.boolean() }).optional(),\n      maxContentTokens: z.number().optional(),\n    }),\n  ),\n);\n\nexport const webFetch_20250910OutputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      type: z.literal('web_fetch_result'),\n      url: z.string(),\n      content: z.object({\n        type: z.literal('document'),\n        title: z.string().nullable(),\n        citations: z.object({ enabled: z.boolean() }).optional(),\n        source: z.union([\n          z.object({\n            type: z.literal('base64'),\n            mediaType: z.literal('application/pdf'),\n            data: z.string(),\n          }),\n          z.object({\n            type: z.literal('text'),\n            mediaType: z.literal('text/plain'),\n            data: z.string(),\n          }),\n        ]),\n      }),\n      retrievedAt: z.string().nullable(),\n    }),\n  ),\n);\n\nconst webFetch_20250910InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      url: z.string(),\n    }),\n  ),\n);\n\nconst factory = createProviderToolFactoryWithOutputSchema<\n  {\n    /**\n     * The URL to fetch.\n     */\n    url: string;\n  },\n  {\n    type: 'web_fetch_result';\n\n    /**\n     * Fetched content URL\n     */\n    url: string;\n\n    /**\n     * Fetched content.\n     */\n    content: {\n      type: 'document';\n\n      /**\n       * Title of the document\n       */\n      title: string | null;\n\n      /**\n       * Citation configuration for the document\n       */\n      citations?: { enabled: boolean };\n\n      source:\n        | {\n            type: 'base64';\n            mediaType: 'application/pdf';\n            data: string;\n          }\n        | {\n            type: 'text';\n            mediaType: 'text/plain';\n            data: string;\n          };\n    };\n\n    /**\n     * ISO 8601 timestamp when the content was retrieved\n     */\n    retrievedAt: string | null;\n  },\n  {\n    /**\n     * The maxUses parameter limits the number of web fetches performed\n     */\n    maxUses?: number;\n\n    /**\n     * Only fetch from these domains\n     */\n    allowedDomains?: string[];\n\n    /**\n     * Never fetch from these domains\n     */\n    blockedDomains?: string[];\n\n    /**\n     * Unlike web search where citations are always enabled, citations are optional for\n     * web fetch. Set \"citations\": {\"enabled\": true} to enable Claude to cite specific passages\n     * from fetched documents.\n     */\n    citations?: {\n      enabled: boolean;\n    };\n\n    /**\n     * The maxContentTokens parameter limits the amount of content that will be included in the context.\n     */\n    maxContentTokens?: number;\n  }\n>({\n  id: 'anthropic.web_fetch_20250910',\n  inputSchema: webFetch_20250910InputSchema,\n  outputSchema: webFetch_20250910OutputSchema,\n});\n\nexport const webFetch_20250910 = (\n  args: Parameters<typeof factory>[0] = {}, // default\n) => {\n  return factory(args);\n};\n","import { LanguageModelV3Usage } from '@ai-sdk/provider';\n\nexport type AnthropicMessagesUsage = {\n  input_tokens: number;\n  output_tokens: number;\n  cache_creation_input_tokens?: number | null;\n  cache_read_input_tokens?: number | null;\n};\n\nexport function convertAnthropicMessagesUsage(\n  usage: AnthropicMessagesUsage,\n): LanguageModelV3Usage {\n  const inputTokens = usage.input_tokens;\n  const outputTokens = usage.output_tokens;\n  const cacheCreationTokens = usage.cache_creation_input_tokens ?? 0;\n  const cacheReadTokens = usage.cache_read_input_tokens ?? 0;\n\n  return {\n    inputTokens: {\n      total: inputTokens + cacheCreationTokens + cacheReadTokens,\n      noCache: inputTokens,\n      cacheRead: cacheReadTokens,\n      cacheWrite: cacheCreationTokens,\n    },\n    outputTokens: {\n      total: outputTokens,\n      text: undefined,\n      reasoning: undefined,\n    },\n    raw: usage,\n  };\n}\n","import {\n  SharedV3Warning,\n  LanguageModelV3DataContent,\n  LanguageModelV3Message,\n  LanguageModelV3Prompt,\n  SharedV3ProviderMetadata,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport {\n  convertToBase64,\n  parseProviderOptions,\n  validateTypes,\n  isNonNullable,\n  ToolNameMapping,\n} from '@ai-sdk/provider-utils';\nimport {\n  AnthropicAssistantMessage,\n  AnthropicMessagesPrompt,\n  anthropicReasoningMetadataSchema,\n  AnthropicToolResultContent,\n  AnthropicUserMessage,\n  AnthropicWebFetchToolResultContent,\n} from './anthropic-messages-api';\nimport { anthropicFilePartProviderOptions } from './anthropic-messages-options';\nimport { CacheControlValidator } from './get-cache-control';\nimport { codeExecution_20250522OutputSchema } from './tool/code-execution_20250522';\nimport { codeExecution_20250825OutputSchema } from './tool/code-execution_20250825';\nimport { toolSearchRegex_20251119OutputSchema as toolSearchOutputSchema } from './tool/tool-search-regex_20251119';\nimport { webFetch_20250910OutputSchema } from './tool/web-fetch-20250910';\nimport { webSearch_20250305OutputSchema } from './tool/web-search_20250305';\n\nfunction convertToString(data: LanguageModelV3DataContent): string {\n  if (typeof data === 'string') {\n    return Buffer.from(data, 'base64').toString('utf-8');\n  }\n\n  if (data instanceof Uint8Array) {\n    return new TextDecoder().decode(data);\n  }\n\n  if (data instanceof URL) {\n    throw new UnsupportedFunctionalityError({\n      functionality: 'URL-based text documents are not supported for citations',\n    });\n  }\n\n  throw new UnsupportedFunctionalityError({\n    functionality: `unsupported data type for text documents: ${typeof data}`,\n  });\n}\n\nexport async function convertToAnthropicMessagesPrompt({\n  prompt,\n  sendReasoning,\n  warnings,\n  cacheControlValidator,\n  toolNameMapping,\n}: {\n  prompt: LanguageModelV3Prompt;\n  sendReasoning: boolean;\n  warnings: SharedV3Warning[];\n  cacheControlValidator?: CacheControlValidator;\n  toolNameMapping: ToolNameMapping;\n}): Promise<{\n  prompt: AnthropicMessagesPrompt;\n  betas: Set<string>;\n}> {\n  const betas = new Set<string>();\n  const blocks = groupIntoBlocks(prompt);\n  const validator = cacheControlValidator || new CacheControlValidator();\n\n  let system: AnthropicMessagesPrompt['system'] = undefined;\n  const messages: AnthropicMessagesPrompt['messages'] = [];\n\n  async function shouldEnableCitations(\n    providerMetadata: SharedV3ProviderMetadata | undefined,\n  ): Promise<boolean> {\n    const anthropicOptions = await parseProviderOptions({\n      provider: 'anthropic',\n      providerOptions: providerMetadata,\n      schema: anthropicFilePartProviderOptions,\n    });\n\n    return anthropicOptions?.citations?.enabled ?? false;\n  }\n\n  async function getDocumentMetadata(\n    providerMetadata: SharedV3ProviderMetadata | undefined,\n  ): Promise<{ title?: string; context?: string }> {\n    const anthropicOptions = await parseProviderOptions({\n      provider: 'anthropic',\n      providerOptions: providerMetadata,\n      schema: anthropicFilePartProviderOptions,\n    });\n\n    return {\n      title: anthropicOptions?.title,\n      context: anthropicOptions?.context,\n    };\n  }\n\n  for (let i = 0; i < blocks.length; i++) {\n    const block = blocks[i];\n    const isLastBlock = i === blocks.length - 1;\n    const type = block.type;\n\n    switch (type) {\n      case 'system': {\n        if (system != null) {\n          throw new UnsupportedFunctionalityError({\n            functionality:\n              'Multiple system messages that are separated by user/assistant messages',\n          });\n        }\n\n        system = block.messages.map(({ content, providerOptions }) => ({\n          type: 'text',\n          text: content,\n          cache_control: validator.getCacheControl(providerOptions, {\n            type: 'system message',\n            canCache: true,\n          }),\n        }));\n\n        break;\n      }\n\n      case 'user': {\n        // combines all user and tool messages in this block into a single message:\n        const anthropicContent: AnthropicUserMessage['content'] = [];\n\n        for (const message of block.messages) {\n          const { role, content } = message;\n          switch (role) {\n            case 'user': {\n              for (let j = 0; j < content.length; j++) {\n                const part = content[j];\n\n                // cache control: first add cache control from part.\n                // for the last part of a message,\n                // check also if the message has cache control.\n                const isLastPart = j === content.length - 1;\n\n                const cacheControl =\n                  validator.getCacheControl(part.providerOptions, {\n                    type: 'user message part',\n                    canCache: true,\n                  }) ??\n                  (isLastPart\n                    ? validator.getCacheControl(message.providerOptions, {\n                        type: 'user message',\n                        canCache: true,\n                      })\n                    : undefined);\n\n                switch (part.type) {\n                  case 'text': {\n                    anthropicContent.push({\n                      type: 'text',\n                      text: part.text,\n                      cache_control: cacheControl,\n                    });\n                    break;\n                  }\n\n                  case 'file': {\n                    if (part.mediaType.startsWith('image/')) {\n                      anthropicContent.push({\n                        type: 'image',\n                        source:\n                          part.data instanceof URL\n                            ? {\n                                type: 'url',\n                                url: part.data.toString(),\n                              }\n                            : {\n                                type: 'base64',\n                                media_type:\n                                  part.mediaType === 'image/*'\n                                    ? 'image/jpeg'\n                                    : part.mediaType,\n                                data: convertToBase64(part.data),\n                              },\n                        cache_control: cacheControl,\n                      });\n                    } else if (part.mediaType === 'application/pdf') {\n                      betas.add('pdfs-2024-09-25');\n\n                      const enableCitations = await shouldEnableCitations(\n                        part.providerOptions,\n                      );\n\n                      const metadata = await getDocumentMetadata(\n                        part.providerOptions,\n                      );\n\n                      anthropicContent.push({\n                        type: 'document',\n                        source:\n                          part.data instanceof URL\n                            ? {\n                                type: 'url',\n                                url: part.data.toString(),\n                              }\n                            : {\n                                type: 'base64',\n                                media_type: 'application/pdf',\n                                data: convertToBase64(part.data),\n                              },\n                        title: metadata.title ?? part.filename,\n                        ...(metadata.context && { context: metadata.context }),\n                        ...(enableCitations && {\n                          citations: { enabled: true },\n                        }),\n                        cache_control: cacheControl,\n                      });\n                    } else if (part.mediaType === 'text/plain') {\n                      const enableCitations = await shouldEnableCitations(\n                        part.providerOptions,\n                      );\n\n                      const metadata = await getDocumentMetadata(\n                        part.providerOptions,\n                      );\n\n                      anthropicContent.push({\n                        type: 'document',\n                        source:\n                          part.data instanceof URL\n                            ? {\n                                type: 'url',\n                                url: part.data.toString(),\n                              }\n                            : {\n                                type: 'text',\n                                media_type: 'text/plain',\n                                data: convertToString(part.data),\n                              },\n                        title: metadata.title ?? part.filename,\n                        ...(metadata.context && { context: metadata.context }),\n                        ...(enableCitations && {\n                          citations: { enabled: true },\n                        }),\n                        cache_control: cacheControl,\n                      });\n                    } else {\n                      throw new UnsupportedFunctionalityError({\n                        functionality: `media type: ${part.mediaType}`,\n                      });\n                    }\n\n                    break;\n                  }\n                }\n              }\n\n              break;\n            }\n            case 'tool': {\n              for (let i = 0; i < content.length; i++) {\n                const part = content[i];\n\n                if (part.type === 'tool-approval-response') {\n                  continue;\n                }\n\n                // cache control: first add cache control from part.\n                // for the last part of a message,\n                // check also if the message has cache control.\n                const isLastPart = i === content.length - 1;\n\n                const cacheControl =\n                  validator.getCacheControl(part.providerOptions, {\n                    type: 'tool result part',\n                    canCache: true,\n                  }) ??\n                  (isLastPart\n                    ? validator.getCacheControl(message.providerOptions, {\n                        type: 'tool result message',\n                        canCache: true,\n                      })\n                    : undefined);\n\n                const output = part.output;\n                let contentValue: AnthropicToolResultContent['content'];\n                switch (output.type) {\n                  case 'content':\n                    contentValue = output.value\n                      .map(contentPart => {\n                        switch (contentPart.type) {\n                          case 'text':\n                            return {\n                              type: 'text' as const,\n                              text: contentPart.text,\n                            };\n                          case 'image-data': {\n                            return {\n                              type: 'image' as const,\n                              source: {\n                                type: 'base64' as const,\n                                media_type: contentPart.mediaType,\n                                data: contentPart.data,\n                              },\n                            };\n                          }\n                          case 'image-url': {\n                            return {\n                              type: 'image' as const,\n                              source: {\n                                type: 'url' as const,\n                                url: contentPart.url,\n                              },\n                            };\n                          }\n                          case 'file-url': {\n                            return {\n                              type: 'document' as const,\n                              source: {\n                                type: 'url' as const,\n                                url: contentPart.url,\n                              },\n                            };\n                          }\n                          case 'file-data': {\n                            if (contentPart.mediaType === 'application/pdf') {\n                              betas.add('pdfs-2024-09-25');\n                              return {\n                                type: 'document' as const,\n                                source: {\n                                  type: 'base64' as const,\n                                  media_type: contentPart.mediaType,\n                                  data: contentPart.data,\n                                },\n                              };\n                            }\n\n                            warnings.push({\n                              type: 'other',\n                              message: `unsupported tool content part type: ${contentPart.type} with media type: ${contentPart.mediaType}`,\n                            });\n\n                            return undefined;\n                          }\n                          default: {\n                            warnings.push({\n                              type: 'other',\n                              message: `unsupported tool content part type: ${contentPart.type}`,\n                            });\n\n                            return undefined;\n                          }\n                        }\n                      })\n                      .filter(isNonNullable);\n                    break;\n                  case 'text':\n                  case 'error-text':\n                    contentValue = output.value;\n                    break;\n                  case 'execution-denied':\n                    contentValue = output.reason ?? 'Tool execution denied.';\n                    break;\n                  case 'json':\n                  case 'error-json':\n                  default:\n                    contentValue = JSON.stringify(output.value);\n                    break;\n                }\n\n                anthropicContent.push({\n                  type: 'tool_result',\n                  tool_use_id: part.toolCallId,\n                  content: contentValue,\n                  is_error:\n                    output.type === 'error-text' || output.type === 'error-json'\n                      ? true\n                      : undefined,\n                  cache_control: cacheControl,\n                });\n              }\n\n              break;\n            }\n            default: {\n              const _exhaustiveCheck: never = role;\n              throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n            }\n          }\n        }\n\n        messages.push({ role: 'user', content: anthropicContent });\n\n        break;\n      }\n\n      case 'assistant': {\n        // combines multiple assistant messages in this block into a single message:\n        const anthropicContent: AnthropicAssistantMessage['content'] = [];\n\n        const mcpToolUseIds = new Set<string>();\n\n        for (let j = 0; j < block.messages.length; j++) {\n          const message = block.messages[j];\n          const isLastMessage = j === block.messages.length - 1;\n          const { content } = message;\n\n          for (let k = 0; k < content.length; k++) {\n            const part = content[k];\n            const isLastContentPart = k === content.length - 1;\n\n            // cache control: first add cache control from part.\n            // for the last part of a message,\n            // check also if the message has cache control.\n            const cacheControl =\n              validator.getCacheControl(part.providerOptions, {\n                type: 'assistant message part',\n                canCache: true,\n              }) ??\n              (isLastContentPart\n                ? validator.getCacheControl(message.providerOptions, {\n                    type: 'assistant message',\n                    canCache: true,\n                  })\n                : undefined);\n\n            switch (part.type) {\n              case 'text': {\n                anthropicContent.push({\n                  type: 'text',\n                  text:\n                    // trim the last text part if it's the last message in the block\n                    // because Anthropic does not allow trailing whitespace\n                    // in pre-filled assistant responses\n                    isLastBlock && isLastMessage && isLastContentPart\n                      ? part.text.trim()\n                      : part.text,\n\n                  cache_control: cacheControl,\n                });\n                break;\n              }\n\n              case 'reasoning': {\n                if (sendReasoning) {\n                  const reasoningMetadata = await parseProviderOptions({\n                    provider: 'anthropic',\n                    providerOptions: part.providerOptions,\n                    schema: anthropicReasoningMetadataSchema,\n                  });\n\n                  if (reasoningMetadata != null) {\n                    if (reasoningMetadata.signature != null) {\n                      // Note: thinking blocks cannot have cache_control directly\n                      // They are cached implicitly when in previous assistant turns\n                      // Validate to provide helpful error message\n                      validator.getCacheControl(part.providerOptions, {\n                        type: 'thinking block',\n                        canCache: false,\n                      });\n                      anthropicContent.push({\n                        type: 'thinking',\n                        thinking: part.text,\n                        signature: reasoningMetadata.signature,\n                      });\n                    } else if (reasoningMetadata.redactedData != null) {\n                      // Note: redacted thinking blocks cannot have cache_control directly\n                      // They are cached implicitly when in previous assistant turns\n                      // Validate to provide helpful error message\n                      validator.getCacheControl(part.providerOptions, {\n                        type: 'redacted thinking block',\n                        canCache: false,\n                      });\n                      anthropicContent.push({\n                        type: 'redacted_thinking',\n                        data: reasoningMetadata.redactedData,\n                      });\n                    } else {\n                      warnings.push({\n                        type: 'other',\n                        message: 'unsupported reasoning metadata',\n                      });\n                    }\n                  } else {\n                    warnings.push({\n                      type: 'other',\n                      message: 'unsupported reasoning metadata',\n                    });\n                  }\n                } else {\n                  warnings.push({\n                    type: 'other',\n                    message:\n                      'sending reasoning content is disabled for this model',\n                  });\n                }\n                break;\n              }\n\n              case 'tool-call': {\n                if (part.providerExecuted) {\n                  const providerToolName = toolNameMapping.toProviderToolName(\n                    part.toolName,\n                  );\n                  const isMcpToolUse =\n                    part.providerOptions?.anthropic?.type === 'mcp-tool-use';\n\n                  if (isMcpToolUse) {\n                    mcpToolUseIds.add(part.toolCallId);\n\n                    const serverName =\n                      part.providerOptions?.anthropic?.serverName;\n\n                    if (serverName == null || typeof serverName !== 'string') {\n                      warnings.push({\n                        type: 'other',\n                        message:\n                          'mcp tool use server name is required and must be a string',\n                      });\n                      break;\n                    }\n\n                    anthropicContent.push({\n                      type: 'mcp_tool_use',\n                      id: part.toolCallId,\n                      name: part.toolName,\n                      input: part.input,\n                      server_name: serverName,\n                      cache_control: cacheControl,\n                    });\n                  } else if (\n                    // code execution 20250825:\n                    providerToolName === 'code_execution' &&\n                    part.input != null &&\n                    typeof part.input === 'object' &&\n                    'type' in part.input &&\n                    typeof part.input.type === 'string' &&\n                    (part.input.type === 'bash_code_execution' ||\n                      part.input.type === 'text_editor_code_execution')\n                  ) {\n                    anthropicContent.push({\n                      type: 'server_tool_use',\n                      id: part.toolCallId,\n                      name: part.input.type, // map back to subtool name\n                      input: part.input,\n                      cache_control: cacheControl,\n                    });\n                  } else if (\n                    // code execution 20250825 programmatic tool calling:\n                    // Strip the fake 'programmatic-tool-call' type before sending to Anthropic\n                    providerToolName === 'code_execution' &&\n                    part.input != null &&\n                    typeof part.input === 'object' &&\n                    'type' in part.input &&\n                    part.input.type === 'programmatic-tool-call'\n                  ) {\n                    const { type: _, ...inputWithoutType } = part.input as {\n                      type: string;\n                      code: string;\n                    };\n                    anthropicContent.push({\n                      type: 'server_tool_use',\n                      id: part.toolCallId,\n                      name: 'code_execution',\n                      input: inputWithoutType,\n                      cache_control: cacheControl,\n                    });\n                  } else {\n                    if (\n                      providerToolName === 'code_execution' || // code execution 20250522\n                      providerToolName === 'web_fetch' ||\n                      providerToolName === 'web_search'\n                    ) {\n                      anthropicContent.push({\n                        type: 'server_tool_use',\n                        id: part.toolCallId,\n                        name: providerToolName,\n                        input: part.input,\n                        cache_control: cacheControl,\n                      });\n                    } else if (\n                      providerToolName === 'tool_search_tool_regex' ||\n                      providerToolName === 'tool_search_tool_bm25'\n                    ) {\n                      anthropicContent.push({\n                        type: 'server_tool_use',\n                        id: part.toolCallId,\n                        name: providerToolName,\n                        input: part.input,\n                        cache_control: cacheControl,\n                      });\n                    } else {\n                      warnings.push({\n                        type: 'other',\n                        message: `provider executed tool call for tool ${part.toolName} is not supported`,\n                      });\n                    }\n                  }\n\n                  break;\n                }\n\n                // Extract caller info from provider options for programmatic tool calling\n                const callerOptions = part.providerOptions?.anthropic as\n                  | { caller?: { type: string; toolId?: string } }\n                  | undefined;\n                const caller = callerOptions?.caller\n                  ? callerOptions.caller.type === 'code_execution_20250825' &&\n                    callerOptions.caller.toolId\n                    ? {\n                        type: 'code_execution_20250825' as const,\n                        tool_id: callerOptions.caller.toolId,\n                      }\n                    : callerOptions.caller.type === 'direct'\n                      ? { type: 'direct' as const }\n                      : undefined\n                  : undefined;\n\n                anthropicContent.push({\n                  type: 'tool_use',\n                  id: part.toolCallId,\n                  name: part.toolName,\n                  input: part.input,\n                  ...(caller && { caller }),\n                  cache_control: cacheControl,\n                });\n                break;\n              }\n\n              case 'tool-result': {\n                const providerToolName = toolNameMapping.toProviderToolName(\n                  part.toolName,\n                );\n\n                if (mcpToolUseIds.has(part.toolCallId)) {\n                  const output = part.output;\n\n                  if (output.type !== 'json' && output.type !== 'error-json') {\n                    warnings.push({\n                      type: 'other',\n                      message: `provider executed tool result output type ${output.type} for tool ${part.toolName} is not supported`,\n                    });\n\n                    break;\n                  }\n\n                  anthropicContent.push({\n                    type: 'mcp_tool_result',\n                    tool_use_id: part.toolCallId,\n                    is_error: output.type === 'error-json',\n                    content: output.value as unknown as\n                      | string\n                      | Array<{ type: 'text'; text: string }>,\n                    cache_control: cacheControl,\n                  });\n                } else if (providerToolName === 'code_execution') {\n                  const output = part.output;\n\n                  // Handle error types for code_execution tools (e.g., from programmatic tool calling)\n                  if (\n                    output.type === 'error-text' ||\n                    output.type === 'error-json'\n                  ) {\n                    let errorInfo: { type?: string; errorCode?: string } = {};\n                    try {\n                      if (typeof output.value === 'string') {\n                        errorInfo = JSON.parse(output.value);\n                      } else if (\n                        typeof output.value === 'object' &&\n                        output.value !== null\n                      ) {\n                        errorInfo = output.value as typeof errorInfo;\n                      }\n                    } catch {}\n\n                    if (errorInfo.type === 'code_execution_tool_result_error') {\n                      anthropicContent.push({\n                        type: 'code_execution_tool_result',\n                        tool_use_id: part.toolCallId,\n                        content: {\n                          type: 'code_execution_tool_result_error' as const,\n                          error_code: errorInfo.errorCode ?? 'unknown',\n                        },\n                        cache_control: cacheControl,\n                      });\n                    } else {\n                      anthropicContent.push({\n                        type: 'bash_code_execution_tool_result',\n                        tool_use_id: part.toolCallId,\n                        cache_control: cacheControl,\n                        content: {\n                          type: 'bash_code_execution_tool_result_error' as const,\n                          error_code: errorInfo.errorCode ?? 'unknown',\n                        },\n                      });\n                    }\n                    break;\n                  }\n\n                  if (output.type !== 'json') {\n                    warnings.push({\n                      type: 'other',\n                      message: `provider executed tool result output type ${output.type} for tool ${part.toolName} is not supported`,\n                    });\n\n                    break;\n                  }\n\n                  if (\n                    output.value == null ||\n                    typeof output.value !== 'object' ||\n                    !('type' in output.value) ||\n                    typeof output.value.type !== 'string'\n                  ) {\n                    warnings.push({\n                      type: 'other',\n                      message: `provider executed tool result output value is not a valid code execution result for tool ${part.toolName}`,\n                    });\n                    break;\n                  }\n\n                  // to distinguish between code execution 20250522 and 20250825,\n                  // we check if a type property is present in the output.value\n                  if (output.value.type === 'code_execution_result') {\n                    // code execution 20250522\n                    const codeExecutionOutput = await validateTypes({\n                      value: output.value,\n                      schema: codeExecution_20250522OutputSchema,\n                    });\n\n                    anthropicContent.push({\n                      type: 'code_execution_tool_result',\n                      tool_use_id: part.toolCallId,\n                      content: {\n                        type: codeExecutionOutput.type,\n                        stdout: codeExecutionOutput.stdout,\n                        stderr: codeExecutionOutput.stderr,\n                        return_code: codeExecutionOutput.return_code,\n                        content: codeExecutionOutput.content ?? [],\n                      },\n                      cache_control: cacheControl,\n                    });\n                  } else {\n                    // code execution 20250825\n                    const codeExecutionOutput = await validateTypes({\n                      value: output.value,\n                      schema: codeExecution_20250825OutputSchema,\n                    });\n\n                    if (codeExecutionOutput.type === 'code_execution_result') {\n                      // Programmatic tool calling result - same format as 20250522\n                      anthropicContent.push({\n                        type: 'code_execution_tool_result',\n                        tool_use_id: part.toolCallId,\n                        content: {\n                          type: codeExecutionOutput.type,\n                          stdout: codeExecutionOutput.stdout,\n                          stderr: codeExecutionOutput.stderr,\n                          return_code: codeExecutionOutput.return_code,\n                          content: codeExecutionOutput.content ?? [],\n                        },\n                        cache_control: cacheControl,\n                      });\n                    } else if (\n                      codeExecutionOutput.type ===\n                        'bash_code_execution_result' ||\n                      codeExecutionOutput.type ===\n                        'bash_code_execution_tool_result_error'\n                    ) {\n                      anthropicContent.push({\n                        type: 'bash_code_execution_tool_result',\n                        tool_use_id: part.toolCallId,\n                        cache_control: cacheControl,\n                        content: codeExecutionOutput,\n                      });\n                    } else {\n                      anthropicContent.push({\n                        type: 'text_editor_code_execution_tool_result',\n                        tool_use_id: part.toolCallId,\n                        cache_control: cacheControl,\n                        content: codeExecutionOutput,\n                      });\n                    }\n                  }\n                  break;\n                }\n\n                if (providerToolName === 'web_fetch') {\n                  const output = part.output;\n\n                  if (output.type === 'error-json') {\n                    const errorValue = JSON.parse(output.value as string);\n\n                    anthropicContent.push({\n                      type: 'web_fetch_tool_result',\n                      tool_use_id: part.toolCallId,\n                      content: {\n                        type: 'web_fetch_tool_result_error',\n                        error_code: errorValue.errorCode,\n                      },\n                      cache_control: cacheControl,\n                    });\n\n                    break;\n                  }\n\n                  if (output.type !== 'json') {\n                    warnings.push({\n                      type: 'other',\n                      message: `provider executed tool result output type ${output.type} for tool ${part.toolName} is not supported`,\n                    });\n\n                    break;\n                  }\n\n                  const webFetchOutput = await validateTypes({\n                    value: output.value,\n                    schema: webFetch_20250910OutputSchema,\n                  });\n\n                  anthropicContent.push({\n                    type: 'web_fetch_tool_result',\n                    tool_use_id: part.toolCallId,\n                    content: {\n                      type: 'web_fetch_result',\n                      url: webFetchOutput.url,\n                      retrieved_at: webFetchOutput.retrievedAt,\n                      content: {\n                        type: 'document',\n                        title: webFetchOutput.content.title,\n                        citations: webFetchOutput.content.citations,\n                        source: {\n                          type: webFetchOutput.content.source.type,\n                          media_type: webFetchOutput.content.source.mediaType,\n                          data: webFetchOutput.content.source.data,\n                        } as Extract<\n                          AnthropicWebFetchToolResultContent['content'],\n                          { type: 'web_fetch_result' }\n                        >['content']['source'],\n                      },\n                    },\n                    cache_control: cacheControl,\n                  });\n\n                  break;\n                }\n\n                if (providerToolName === 'web_search') {\n                  const output = part.output;\n\n                  if (output.type !== 'json') {\n                    warnings.push({\n                      type: 'other',\n                      message: `provider executed tool result output type ${output.type} for tool ${part.toolName} is not supported`,\n                    });\n\n                    break;\n                  }\n\n                  const webSearchOutput = await validateTypes({\n                    value: output.value,\n                    schema: webSearch_20250305OutputSchema,\n                  });\n\n                  anthropicContent.push({\n                    type: 'web_search_tool_result',\n                    tool_use_id: part.toolCallId,\n                    content: webSearchOutput.map(result => ({\n                      url: result.url,\n                      title: result.title,\n                      page_age: result.pageAge,\n                      encrypted_content: result.encryptedContent,\n                      type: result.type,\n                    })),\n                    cache_control: cacheControl,\n                  });\n\n                  break;\n                }\n\n                if (\n                  providerToolName === 'tool_search_tool_regex' ||\n                  providerToolName === 'tool_search_tool_bm25'\n                ) {\n                  const output = part.output;\n\n                  if (output.type !== 'json') {\n                    warnings.push({\n                      type: 'other',\n                      message: `provider executed tool result output type ${output.type} for tool ${part.toolName} is not supported`,\n                    });\n\n                    break;\n                  }\n\n                  const toolSearchOutput = await validateTypes({\n                    value: output.value,\n                    schema: toolSearchOutputSchema,\n                  });\n\n                  // Convert tool references back to API format\n                  const toolReferences = toolSearchOutput.map(ref => ({\n                    type: 'tool_reference' as const,\n                    tool_name: ref.toolName,\n                  }));\n\n                  anthropicContent.push({\n                    type: 'tool_search_tool_result',\n                    tool_use_id: part.toolCallId,\n                    content: {\n                      type: 'tool_search_tool_search_result',\n                      tool_references: toolReferences,\n                    },\n                    cache_control: cacheControl,\n                  });\n\n                  break;\n                }\n\n                warnings.push({\n                  type: 'other',\n                  message: `provider executed tool result for tool ${part.toolName} is not supported`,\n                });\n\n                break;\n              }\n            }\n          }\n        }\n\n        messages.push({ role: 'assistant', content: anthropicContent });\n\n        break;\n      }\n\n      default: {\n        const _exhaustiveCheck: never = type;\n        throw new Error(`content type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  return {\n    prompt: { system, messages },\n    betas,\n  };\n}\n\ntype SystemBlock = {\n  type: 'system';\n  messages: Array<LanguageModelV3Message & { role: 'system' }>;\n};\ntype AssistantBlock = {\n  type: 'assistant';\n  messages: Array<LanguageModelV3Message & { role: 'assistant' }>;\n};\ntype UserBlock = {\n  type: 'user';\n  messages: Array<LanguageModelV3Message & { role: 'user' | 'tool' }>;\n};\n\nfunction groupIntoBlocks(\n  prompt: LanguageModelV3Prompt,\n): Array<SystemBlock | AssistantBlock | UserBlock> {\n  const blocks: Array<SystemBlock | AssistantBlock | UserBlock> = [];\n  let currentBlock: SystemBlock | AssistantBlock | UserBlock | undefined =\n    undefined;\n\n  for (const message of prompt) {\n    const { role } = message;\n    switch (role) {\n      case 'system': {\n        if (currentBlock?.type !== 'system') {\n          currentBlock = { type: 'system', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      case 'assistant': {\n        if (currentBlock?.type !== 'assistant') {\n          currentBlock = { type: 'assistant', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      case 'user': {\n        if (currentBlock?.type !== 'user') {\n          currentBlock = { type: 'user', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      case 'tool': {\n        if (currentBlock?.type !== 'user') {\n          currentBlock = { type: 'user', messages: [] };\n          blocks.push(currentBlock);\n        }\n\n        currentBlock.messages.push(message);\n        break;\n      }\n      default: {\n        const _exhaustiveCheck: never = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  return blocks;\n}\n","import {\n  createProviderToolFactoryWithOutputSchema,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nexport const codeExecution_20250522OutputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      type: z.literal('code_execution_result'),\n      stdout: z.string(),\n      stderr: z.string(),\n      return_code: z.number(),\n      content: z\n        .array(\n          z.object({\n            type: z.literal('code_execution_output'),\n            file_id: z.string(),\n          }),\n        )\n        .optional()\n        .default([]),\n    }),\n  ),\n);\n\nconst codeExecution_20250522InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      code: z.string(),\n    }),\n  ),\n);\n\nconst factory = createProviderToolFactoryWithOutputSchema<\n  {\n    /**\n     * The Python code to execute.\n     */\n    code: string;\n  },\n  {\n    type: 'code_execution_result';\n    stdout: string;\n    stderr: string;\n    return_code: number;\n    content: Array<{ type: 'code_execution_output'; file_id: string }>;\n  },\n  {}\n>({\n  id: 'anthropic.code_execution_20250522',\n  inputSchema: codeExecution_20250522InputSchema,\n  outputSchema: codeExecution_20250522OutputSchema,\n});\n\nexport const codeExecution_20250522 = (\n  args: Parameters<typeof factory>[0] = {},\n) => {\n  return factory(args);\n};\n","import {\n  createProviderToolFactoryWithOutputSchema,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nexport const codeExecution_20250825OutputSchema = lazySchema(() =>\n  zodSchema(\n    z.discriminatedUnion('type', [\n      z.object({\n        type: z.literal('code_execution_result'),\n        stdout: z.string(),\n        stderr: z.string(),\n        return_code: z.number(),\n        content: z\n          .array(\n            z.object({\n              type: z.literal('code_execution_output'),\n              file_id: z.string(),\n            }),\n          )\n          .optional()\n          .default([]),\n      }),\n      z.object({\n        type: z.literal('bash_code_execution_result'),\n        content: z.array(\n          z.object({\n            type: z.literal('bash_code_execution_output'),\n            file_id: z.string(),\n          }),\n        ),\n        stdout: z.string(),\n        stderr: z.string(),\n        return_code: z.number(),\n      }),\n      z.object({\n        type: z.literal('bash_code_execution_tool_result_error'),\n        error_code: z.string(),\n      }),\n      z.object({\n        type: z.literal('text_editor_code_execution_tool_result_error'),\n        error_code: z.string(),\n      }),\n      z.object({\n        type: z.literal('text_editor_code_execution_view_result'),\n        content: z.string(),\n        file_type: z.string(),\n        num_lines: z.number().nullable(),\n        start_line: z.number().nullable(),\n        total_lines: z.number().nullable(),\n      }),\n      z.object({\n        type: z.literal('text_editor_code_execution_create_result'),\n        is_file_update: z.boolean(),\n      }),\n      z.object({\n        type: z.literal('text_editor_code_execution_str_replace_result'),\n        lines: z.array(z.string()).nullable(),\n        new_lines: z.number().nullable(),\n        new_start: z.number().nullable(),\n        old_lines: z.number().nullable(),\n        old_start: z.number().nullable(),\n      }),\n    ]),\n  ),\n);\n\nexport const codeExecution_20250825InputSchema = lazySchema(() =>\n  zodSchema(\n    z.discriminatedUnion('type', [\n      // Programmatic tool calling format (mapped from { code } by AI SDK)\n      z.object({\n        type: z.literal('programmatic-tool-call'),\n        code: z.string(),\n      }),\n      z.object({\n        type: z.literal('bash_code_execution'),\n        command: z.string(),\n      }),\n      z.discriminatedUnion('command', [\n        z.object({\n          type: z.literal('text_editor_code_execution'),\n          command: z.literal('view'),\n          path: z.string(),\n        }),\n        z.object({\n          type: z.literal('text_editor_code_execution'),\n          command: z.literal('create'),\n          path: z.string(),\n          file_text: z.string().nullish(),\n        }),\n        z.object({\n          type: z.literal('text_editor_code_execution'),\n          command: z.literal('str_replace'),\n          path: z.string(),\n          old_str: z.string(),\n          new_str: z.string(),\n        }),\n      ]),\n    ]),\n  ),\n);\n\nconst factory = createProviderToolFactoryWithOutputSchema<\n  | {\n      type: 'programmatic-tool-call';\n      /**\n       * Programmatic tool calling: Python code to execute when code_execution\n       * is used with allowedCallers to trigger client-executed tools.\n       */\n      code: string;\n    }\n  | {\n      type: 'bash_code_execution';\n\n      /**\n       * Shell command to execute.\n       */\n      command: string;\n    }\n  | {\n      type: 'text_editor_code_execution';\n      command: 'view';\n\n      /**\n       * The path to the file to view.\n       */\n      path: string;\n    }\n  | {\n      type: 'text_editor_code_execution';\n      command: 'create';\n\n      /**\n       * The path to the file to edit.\n       */\n      path: string;\n\n      /**\n       * The text of the file to edit.\n       */\n      file_text?: string | null;\n    }\n  | {\n      type: 'text_editor_code_execution';\n      command: 'str_replace';\n\n      /**\n       * The path to the file to edit.\n       */\n      path: string;\n\n      /**\n       * The string to replace.\n       */\n      old_str: string;\n\n      /**\n       * The new string to replace the old string with.\n       */\n      new_str: string;\n    },\n  | {\n      /**\n       * Programmatic tool calling result: returned when code_execution runs code\n       * that calls client-executed tools via allowedCallers.\n       */\n      type: 'code_execution_result';\n\n      /**\n       * Output from successful execution\n       */\n      stdout: string;\n\n      /**\n       * Error messages if execution fails\n       */\n      stderr: string;\n\n      /**\n       * 0 for success, non-zero for failure\n       */\n      return_code: number;\n\n      /**\n       * Output file Id list\n       */\n      content: Array<{ type: 'code_execution_output'; file_id: string }>;\n    }\n  | {\n      type: 'bash_code_execution_result';\n\n      /**\n       * Output file Id list\n       */\n      content: Array<{\n        type: 'bash_code_execution_output';\n        file_id: string;\n      }>;\n\n      /**\n       * Output from successful execution\n       */\n      stdout: string;\n\n      /**\n       * Error messages if execution fails\n       */\n      stderr: string;\n\n      /**\n       * 0 for success, non-zero for failure\n       */\n      return_code: number;\n    }\n  | {\n      type: 'bash_code_execution_tool_result_error';\n\n      /**\n       * Available options: invalid_tool_input, unavailable, too_many_requests,\n       * execution_time_exceeded, output_file_too_large.\n       */\n      error_code: string;\n    }\n  | {\n      type: 'text_editor_code_execution_tool_result_error';\n\n      /**\n       * Available options: invalid_tool_input, unavailable, too_many_requests,\n       * execution_time_exceeded, file_not_found.\n       */\n      error_code: string;\n    }\n  | {\n      type: 'text_editor_code_execution_view_result';\n\n      content: string;\n\n      /**\n       * The type of the file. Available options: text, image, pdf.\n       */\n      file_type: string;\n\n      num_lines: number | null;\n      start_line: number | null;\n      total_lines: number | null;\n    }\n  | {\n      type: 'text_editor_code_execution_create_result';\n\n      is_file_update: boolean;\n    }\n  | {\n      type: 'text_editor_code_execution_str_replace_result';\n\n      lines: string[] | null;\n      new_lines: number | null;\n      new_start: number | null;\n      old_lines: number | null;\n      old_start: number | null;\n    },\n  {\n    // no arguments\n  }\n>({\n  id: 'anthropic.code_execution_20250825',\n  inputSchema: codeExecution_20250825InputSchema,\n  outputSchema: codeExecution_20250825OutputSchema,\n  // Programmatic tool calling: tool results may be deferred to a later turn\n  // when code execution triggers a client-executed tool that needs to be\n  // resolved before the code execution result can be returned.\n  supportsDeferredResults: true,\n});\n\nexport const codeExecution_20250825 = (\n  args: Parameters<typeof factory>[0] = {},\n) => {\n  return factory(args);\n};\n","import {\n  createProviderToolFactoryWithOutputSchema,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\n/**\n * Output schema for tool search results - returns tool references\n * that are automatically expanded into full tool definitions by the API.\n */\nexport const toolSearchRegex_20251119OutputSchema = lazySchema(() =>\n  zodSchema(\n    z.array(\n      z.object({\n        type: z.literal('tool_reference'),\n        toolName: z.string(),\n      }),\n    ),\n  ),\n);\n\n/**\n * Input schema for regex-based tool search.\n * Claude constructs regex patterns using Python's re.search() syntax.\n */\nconst toolSearchRegex_20251119InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      /**\n       * A regex pattern to search for tools.\n       * Uses Python re.search() syntax. Maximum 200 characters.\n       *\n       * Examples:\n       * - \"weather\" - matches tool names/descriptions containing \"weather\"\n       * - \"get_.*_data\" - matches tools like get_user_data, get_weather_data\n       * - \"database.*query|query.*database\" - OR patterns for flexibility\n       * - \"(?i)slack\" - case-insensitive search\n       */\n      pattern: z.string(),\n      /**\n       * Maximum number of tools to return. Optional.\n       */\n      limit: z.number().optional(),\n    }),\n  ),\n);\n\nconst factory = createProviderToolFactoryWithOutputSchema<\n  {\n    /**\n     * A regex pattern to search for tools.\n     * Uses Python re.search() syntax. Maximum 200 characters.\n     *\n     * Examples:\n     * - \"weather\" - matches tool names/descriptions containing \"weather\"\n     * - \"get_.*_data\" - matches tools like get_user_data, get_weather_data\n     * - \"database.*query|query.*database\" - OR patterns for flexibility\n     * - \"(?i)slack\" - case-insensitive search\n     */\n    pattern: string;\n    /**\n     * Maximum number of tools to return. Optional.\n     */\n    limit?: number;\n  },\n  Array<{\n    type: 'tool_reference';\n    /**\n     * The name of the discovered tool.\n     */\n    toolName: string;\n  }>,\n  {}\n>({\n  id: 'anthropic.tool_search_regex_20251119',\n  inputSchema: toolSearchRegex_20251119InputSchema,\n  outputSchema: toolSearchRegex_20251119OutputSchema,\n});\n\n/**\n * Creates a tool search tool that uses regex patterns to find tools.\n *\n * The tool search tool enables Claude to work with hundreds or thousands of tools\n * by dynamically discovering and loading them on-demand. Instead of loading all\n * tool definitions into the context window upfront, Claude searches your tool\n * catalog and loads only the tools it needs.\n *\n * When Claude uses this tool, it constructs regex patterns using Python's\n * re.search() syntax (NOT natural language queries).\n *\n * **Important**: This tool should never have `deferLoading: true` in providerOptions.\n *\n * @example\n * ```ts\n * import { anthropicTools } from '@ai-sdk/anthropic';\n *\n * const tools = {\n *   toolSearch: anthropicTools.toolSearchRegex_20251119(),\n *   // Other tools with deferLoading...\n * };\n * ```\n *\n * @see https://docs.anthropic.com/en/docs/agents-and-tools/tool-search-tool\n */\nexport const toolSearchRegex_20251119 = (\n  args: Parameters<typeof factory>[0] = {},\n) => {\n  return factory(args);\n};\n","import { LanguageModelV3FinishReason } from '@ai-sdk/provider';\n\n/**\n * @see https://docs.anthropic.com/en/api/messages#response-stop-reason\n */\nexport function mapAnthropicStopReason({\n  finishReason,\n  isJsonResponseFromTool,\n}: {\n  finishReason: string | null | undefined;\n  isJsonResponseFromTool?: boolean;\n}): LanguageModelV3FinishReason['unified'] {\n  switch (finishReason) {\n    case 'pause_turn':\n    case 'end_turn':\n    case 'stop_sequence':\n      return 'stop';\n    case 'refusal':\n      return 'content-filter';\n    case 'tool_use':\n      return isJsonResponseFromTool ? 'stop' : 'tool-calls';\n    case 'max_tokens':\n    case 'model_context_window_exceeded':\n      return 'length';\n    default:\n      return 'other';\n  }\n}\n","import {\n  createProviderToolFactory,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst bash_20241022InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      command: z.string(),\n      restart: z.boolean().optional(),\n    }),\n  ),\n);\n\nexport const bash_20241022 = createProviderToolFactory<\n  {\n    /**\n     * The bash command to run. Required unless the tool is being restarted.\n     */\n    command: string;\n\n    /**\n     * Specifying true will restart this tool. Otherwise, leave this unspecified.\n     */\n    restart?: boolean;\n  },\n  {}\n>({\n  id: 'anthropic.bash_20241022',\n  inputSchema: bash_20241022InputSchema,\n});\n","import {\n  createProviderToolFactory,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst bash_20250124InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      command: z.string(),\n      restart: z.boolean().optional(),\n    }),\n  ),\n);\n\nexport const bash_20250124 = createProviderToolFactory<\n  {\n    /**\n     * The bash command to run. Required unless the tool is being restarted.\n     */\n    command: string;\n\n    /**\n     * Specifying true will restart this tool. Otherwise, leave this unspecified.\n     */\n    restart?: boolean;\n  },\n  {}\n>({\n  id: 'anthropic.bash_20250124',\n  inputSchema: bash_20250124InputSchema,\n});\n","import {\n  createProviderToolFactory,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst computer_20241022InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      action: z.enum([\n        'key',\n        'type',\n        'mouse_move',\n        'left_click',\n        'left_click_drag',\n        'right_click',\n        'middle_click',\n        'double_click',\n        'screenshot',\n        'cursor_position',\n      ]),\n      coordinate: z.array(z.number().int()).optional(),\n      text: z.string().optional(),\n    }),\n  ),\n);\n\nexport const computer_20241022 = createProviderToolFactory<\n  {\n    /**\n     * The action to perform. The available actions are:\n     * - `key`: Press a key or key-combination on the keyboard.\n     *   - This supports xdotool's `key` syntax.\n     *   - Examples: \"a\", \"Return\", \"alt+Tab\", \"ctrl+s\", \"Up\", \"KP_0\" (for the numpad 0 key).\n     * - `type`: Type a string of text on the keyboard.\n     * - `cursor_position`: Get the current (x, y) pixel coordinate of the cursor on the screen.\n     * - `mouse_move`: Move the cursor to a specified (x, y) pixel coordinate on the screen.\n     * - `left_click`: Click the left mouse button.\n     * - `left_click_drag`: Click and drag the cursor to a specified (x, y) pixel coordinate on the screen.\n     * - `right_click`: Click the right mouse button.\n     * - `middle_click`: Click the middle mouse button.\n     * - `double_click`: Double-click the left mouse button.\n     * - `screenshot`: Take a screenshot of the screen.\n     */\n    action:\n      | 'key'\n      | 'type'\n      | 'mouse_move'\n      | 'left_click'\n      | 'left_click_drag'\n      | 'right_click'\n      | 'middle_click'\n      | 'double_click'\n      | 'screenshot'\n      | 'cursor_position';\n\n    /**\n     * (x, y): The x (pixels from the left edge) and y (pixels from the top edge) coordinates to move the mouse to. Required only by `action=mouse_move` and `action=left_click_drag`.\n     */\n    coordinate?: number[];\n\n    /**\n     * Required only by `action=type` and `action=key`.\n     */\n    text?: string;\n  },\n  {\n    /**\n     * The width of the display being controlled by the model in pixels.\n     */\n    displayWidthPx: number;\n\n    /**\n     * The height of the display being controlled by the model in pixels.\n     */\n    displayHeightPx: number;\n\n    /**\n     * The display number to control (only relevant for X11 environments). If specified, the tool will be provided a display number in the tool definition.\n     */\n    displayNumber?: number;\n  }\n>({\n  id: 'anthropic.computer_20241022',\n  inputSchema: computer_20241022InputSchema,\n});\n","import {\n  createProviderToolFactory,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst computer_20250124InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      action: z.enum([\n        'key',\n        'hold_key',\n        'type',\n        'cursor_position',\n        'mouse_move',\n        'left_mouse_down',\n        'left_mouse_up',\n        'left_click',\n        'left_click_drag',\n        'right_click',\n        'middle_click',\n        'double_click',\n        'triple_click',\n        'scroll',\n        'wait',\n        'screenshot',\n      ]),\n      coordinate: z.tuple([z.number().int(), z.number().int()]).optional(),\n      duration: z.number().optional(),\n      scroll_amount: z.number().optional(),\n      scroll_direction: z.enum(['up', 'down', 'left', 'right']).optional(),\n      start_coordinate: z\n        .tuple([z.number().int(), z.number().int()])\n        .optional(),\n      text: z.string().optional(),\n    }),\n  ),\n);\n\nexport const computer_20250124 = createProviderToolFactory<\n  {\n    /**\n     * - `key`: Press a key or key-combination on the keyboard.\n     *   - This supports xdotool's `key` syntax.\n     *   - Examples: \"a\", \"Return\", \"alt+Tab\", \"ctrl+s\", \"Up\", \"KP_0\" (for the numpad 0 key).\n     * - `hold_key`: Hold down a key or multiple keys for a specified duration (in seconds). Supports the same syntax as `key`.\n     * - `type`: Type a string of text on the keyboard.\n     * - `cursor_position`: Get the current (x, y) pixel coordinate of the cursor on the screen.\n     * - `mouse_move`: Move the cursor to a specified (x, y) pixel coordinate on the screen.\n     * - `left_mouse_down`: Press the left mouse button.\n     * - `left_mouse_up`: Release the left mouse button.\n     * - `left_click`: Click the left mouse button at the specified (x, y) pixel coordinate on the screen. You can also include a key combination to hold down while clicking using the `text` parameter.\n     * - `left_click_drag`: Click and drag the cursor from `start_coordinate` to a specified (x, y) pixel coordinate on the screen.\n     * - `right_click`: Click the right mouse button at the specified (x, y) pixel coordinate on the screen.\n     * - `middle_click`: Click the middle mouse button at the specified (x, y) pixel coordinate on the screen.\n     * - `double_click`: Double-click the left mouse button at the specified (x, y) pixel coordinate on the screen.\n     * - `triple_click`: Triple-click the left mouse button at the specified (x, y) pixel coordinate on the screen.\n     * - `scroll`: Scroll the screen in a specified direction by a specified amount of clicks of the scroll wheel, at the specified (x, y) pixel coordinate. DO NOT use PageUp/PageDown to scroll.\n     * - `wait`: Wait for a specified duration (in seconds).\n     * - `screenshot`: Take a screenshot of the screen.\n     */\n    action:\n      | 'key'\n      | 'hold_key'\n      | 'type'\n      | 'cursor_position'\n      | 'mouse_move'\n      | 'left_mouse_down'\n      | 'left_mouse_up'\n      | 'left_click'\n      | 'left_click_drag'\n      | 'right_click'\n      | 'middle_click'\n      | 'double_click'\n      | 'triple_click'\n      | 'scroll'\n      | 'wait'\n      | 'screenshot';\n\n    /**\n     * (x, y): The x (pixels from the left edge) and y (pixels from the top edge) coordinates to move the mouse to. Required only by `action=mouse_move` and `action=left_click_drag`.\n     */\n    coordinate?: [number, number];\n\n    /**\n     * The duration to hold the key down for. Required only by `action=hold_key` and `action=wait`.\n     */\n    duration?: number;\n\n    /**\n     * The number of 'clicks' to scroll. Required only by `action=scroll`.\n     */\n    scroll_amount?: number;\n\n    /**\n     * The direction to scroll the screen. Required only by `action=scroll`.\n     */\n    scroll_direction?: 'up' | 'down' | 'left' | 'right';\n\n    /**\n     * (x, y): The x (pixels from the left edge) and y (pixels from the top edge) coordinates to start the drag from. Required only by `action=left_click_drag`.\n     */\n    start_coordinate?: [number, number];\n\n    /**\n     * Required only by `action=type`, `action=key`, and `action=hold_key`. Can also be used by click or scroll actions to hold down keys while clicking or scrolling.\n     */\n    text?: string;\n  },\n  {\n    /**\n     * The width of the display being controlled by the model in pixels.\n     */\n    displayWidthPx: number;\n\n    /**\n     * The height of the display being controlled by the model in pixels.\n     */\n    displayHeightPx: number;\n\n    /**\n     * The display number to control (only relevant for X11 environments). If specified, the tool will be provided a display number in the tool definition.\n     */\n    displayNumber?: number;\n  }\n>({\n  id: 'anthropic.computer_20250124',\n  inputSchema: computer_20250124InputSchema,\n});\n","import {\n  createProviderToolFactory,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst memory_20250818InputSchema = lazySchema(() =>\n  zodSchema(\n    z.discriminatedUnion('command', [\n      z.object({\n        command: z.literal('view'),\n        path: z.string(),\n        view_range: z.tuple([z.number(), z.number()]).optional(),\n      }),\n      z.object({\n        command: z.literal('create'),\n        path: z.string(),\n        file_text: z.string(),\n      }),\n      z.object({\n        command: z.literal('str_replace'),\n        path: z.string(),\n        old_str: z.string(),\n        new_str: z.string(),\n      }),\n      z.object({\n        command: z.literal('insert'),\n        path: z.string(),\n        insert_line: z.number(),\n        insert_text: z.string(),\n      }),\n      z.object({\n        command: z.literal('delete'),\n        path: z.string(),\n      }),\n      z.object({\n        command: z.literal('rename'),\n        old_path: z.string(),\n        new_path: z.string(),\n      }),\n    ]),\n  ),\n);\n\nexport const memory_20250818 = createProviderToolFactory<\n  | { command: 'view'; path: string; view_range?: [number, number] }\n  | { command: 'create'; path: string; file_text: string }\n  | { command: 'str_replace'; path: string; old_str: string; new_str: string }\n  | {\n      command: 'insert';\n      path: string;\n      insert_line: number;\n      insert_text: string;\n    }\n  | { command: 'delete'; path: string }\n  | { command: 'rename'; old_path: string; new_path: string },\n  {}\n>({\n  id: 'anthropic.memory_20250818',\n  inputSchema: memory_20250818InputSchema,\n});\n","import {\n  createProviderToolFactory,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst textEditor_20241022InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      command: z.enum(['view', 'create', 'str_replace', 'insert', 'undo_edit']),\n      path: z.string(),\n      file_text: z.string().optional(),\n      insert_line: z.number().int().optional(),\n      new_str: z.string().optional(),\n      old_str: z.string().optional(),\n      view_range: z.array(z.number().int()).optional(),\n    }),\n  ),\n);\n\nexport const textEditor_20241022 = createProviderToolFactory<\n  {\n    /**\n     * The commands to run. Allowed options are: `view`, `create`, `str_replace`, `insert`, `undo_edit`.\n     */\n    command: 'view' | 'create' | 'str_replace' | 'insert' | 'undo_edit';\n\n    /**\n     * Absolute path to file or directory, e.g. `/repo/file.py` or `/repo`.\n     */\n    path: string;\n\n    /**\n     * Required parameter of `create` command, with the content of the file to be created.\n     */\n    file_text?: string;\n\n    /**\n     * Required parameter of `insert` command. The `new_str` will be inserted AFTER the line `insert_line` of `path`.\n     */\n    insert_line?: number;\n\n    /**\n     * Optional parameter of `str_replace` command containing the new string (if not given, no string will be added). Required parameter of `insert` command containing the string to insert.\n     */\n    new_str?: string;\n\n    /**\n     * Required parameter of `str_replace` command containing the string in `path` to replace.\n     */\n    old_str?: string;\n\n    /**\n     * Optional parameter of `view` command when `path` points to a file. If none is given, the full file is shown. If provided, the file will be shown in the indicated line number range, e.g. [11, 12] will show lines 11 and 12. Indexing at 1 to start. Setting `[start_line, -1]` shows all lines from `start_line` to the end of the file.\n     */\n    view_range?: number[];\n  },\n  {}\n>({\n  id: 'anthropic.text_editor_20241022',\n  inputSchema: textEditor_20241022InputSchema,\n});\n","import {\n  createProviderToolFactory,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst textEditor_20250124InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      command: z.enum(['view', 'create', 'str_replace', 'insert', 'undo_edit']),\n      path: z.string(),\n      file_text: z.string().optional(),\n      insert_line: z.number().int().optional(),\n      new_str: z.string().optional(),\n      old_str: z.string().optional(),\n      view_range: z.array(z.number().int()).optional(),\n    }),\n  ),\n);\n\nexport const textEditor_20250124 = createProviderToolFactory<\n  {\n    /**\n     * The commands to run. Allowed options are: `view`, `create`, `str_replace`, `insert`, `undo_edit`.\n     */\n    command: 'view' | 'create' | 'str_replace' | 'insert' | 'undo_edit';\n\n    /**\n     * Absolute path to file or directory, e.g. `/repo/file.py` or `/repo`.\n     */\n    path: string;\n\n    /**\n     * Required parameter of `create` command, with the content of the file to be created.\n     */\n    file_text?: string;\n\n    /**\n     * Required parameter of `insert` command. The `new_str` will be inserted AFTER the line `insert_line` of `path`.\n     */\n    insert_line?: number;\n\n    /**\n     * Optional parameter of `str_replace` command containing the new string (if not given, no string will be added). Required parameter of `insert` command containing the string to insert.\n     */\n    new_str?: string;\n\n    /**\n     * Required parameter of `str_replace` command containing the string in `path` to replace.\n     */\n    old_str?: string;\n\n    /**\n     * Optional parameter of `view` command when `path` points to a file. If none is given, the full file is shown. If provided, the file will be shown in the indicated line number range, e.g. [11, 12] will show lines 11 and 12. Indexing at 1 to start. Setting `[start_line, -1]` shows all lines from `start_line` to the end of the file.\n     */\n    view_range?: number[];\n  },\n  {}\n>({\n  id: 'anthropic.text_editor_20250124',\n  inputSchema: textEditor_20250124InputSchema,\n});\n","import {\n  createProviderToolFactory,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst textEditor_20250429InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      command: z.enum(['view', 'create', 'str_replace', 'insert']),\n      path: z.string(),\n      file_text: z.string().optional(),\n      insert_line: z.number().int().optional(),\n      new_str: z.string().optional(),\n      old_str: z.string().optional(),\n      view_range: z.array(z.number().int()).optional(),\n    }),\n  ),\n);\n\nexport const textEditor_20250429 = createProviderToolFactory<\n  {\n    /**\n     * The commands to run. Allowed options are: `view`, `create`, `str_replace`, `insert`.\n     * Note: `undo_edit` is not supported in Claude 4 models.\n     */\n    command: 'view' | 'create' | 'str_replace' | 'insert';\n\n    /**\n     * Absolute path to file or directory, e.g. `/repo/file.py` or `/repo`.\n     */\n    path: string;\n\n    /**\n     * Required parameter of `create` command, with the content of the file to be created.\n     */\n    file_text?: string;\n\n    /**\n     * Required parameter of `insert` command. The `new_str` will be inserted AFTER the line `insert_line` of `path`.\n     */\n    insert_line?: number;\n\n    /**\n     * Optional parameter of `str_replace` command containing the new string (if not given, no string will be added). Required parameter of `insert` command containing the string to insert.\n     */\n    new_str?: string;\n\n    /**\n     * Required parameter of `str_replace` command containing the string in `path` to replace.\n     */\n    old_str?: string;\n\n    /**\n     * Optional parameter of `view` command when `path` points to a file. If none is given, the full file is shown. If provided, the file will be shown in the indicated line number range, e.g. [11, 12] will show lines 11 and 12. Indexing at 1 to start. Setting `[start_line, -1]` shows all lines from `start_line` to the end of the file.\n     */\n    view_range?: number[];\n  },\n  {}\n>({\n  id: 'anthropic.text_editor_20250429',\n  inputSchema: textEditor_20250429InputSchema,\n});\n","import {\n  createProviderToolFactoryWithOutputSchema,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\n/**\n * Output schema for tool search results - returns tool references\n * that are automatically expanded into full tool definitions by the API.\n */\nexport const toolSearchBm25_20251119OutputSchema = lazySchema(() =>\n  zodSchema(\n    z.array(\n      z.object({\n        type: z.literal('tool_reference'),\n        toolName: z.string(),\n      }),\n    ),\n  ),\n);\n\n/**\n * Input schema for BM25-based tool search.\n * Claude uses natural language queries to search for tools.\n */\nconst toolSearchBm25_20251119InputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      /**\n       * A natural language query to search for tools.\n       * Claude will use BM25 text search to find relevant tools.\n       */\n      query: z.string(),\n      /**\n       * Maximum number of tools to return. Optional.\n       */\n      limit: z.number().optional(),\n    }),\n  ),\n);\n\nconst factory = createProviderToolFactoryWithOutputSchema<\n  {\n    /**\n     * A natural language query to search for tools.\n     * Claude will use BM25 text search to find relevant tools.\n     */\n    query: string;\n    /**\n     * Maximum number of tools to return. Optional.\n     */\n    limit?: number;\n  },\n  Array<{\n    type: 'tool_reference';\n    /**\n     * The name of the discovered tool.\n     */\n    toolName: string;\n  }>,\n  {}\n>({\n  id: 'anthropic.tool_search_bm25_20251119',\n  inputSchema: toolSearchBm25_20251119InputSchema,\n  outputSchema: toolSearchBm25_20251119OutputSchema,\n});\n\n/**\n * Creates a tool search tool that uses BM25 (natural language) to find tools.\n *\n * The tool search tool enables Claude to work with hundreds or thousands of tools\n * by dynamically discovering and loading them on-demand. Instead of loading all\n * tool definitions into the context window upfront, Claude searches your tool\n * catalog and loads only the tools it needs.\n *\n * When Claude uses this tool, it uses natural language queries (NOT regex patterns)\n * to search for tools using BM25 text search.\n *\n * **Important**: This tool should never have `deferLoading: true` in providerOptions.\n *\n * @example\n * ```ts\n * import { anthropicTools } from '@ai-sdk/anthropic';\n *\n * const tools = {\n *   toolSearch: anthropicTools.toolSearchBm25_20251119(),\n *   // Other tools with deferLoading...\n * };\n * ```\n *\n * @see https://docs.anthropic.com/en/docs/agents-and-tools/tool-search-tool\n */\nexport const toolSearchBm25_20251119 = (\n  args: Parameters<typeof factory>[0] = {},\n) => {\n  return factory(args);\n};\n","import { bash_20241022 } from './tool/bash_20241022';\nimport { bash_20250124 } from './tool/bash_20250124';\nimport { codeExecution_20250522 } from './tool/code-execution_20250522';\nimport { codeExecution_20250825 } from './tool/code-execution_20250825';\nimport { computer_20241022 } from './tool/computer_20241022';\nimport { computer_20250124 } from './tool/computer_20250124';\nimport { memory_20250818 } from './tool/memory_20250818';\nimport { textEditor_20241022 } from './tool/text-editor_20241022';\nimport { textEditor_20250124 } from './tool/text-editor_20250124';\nimport { textEditor_20250429 } from './tool/text-editor_20250429';\nimport { textEditor_20250728 } from './tool/text-editor_20250728';\nimport { toolSearchBm25_20251119 } from './tool/tool-search-bm25_20251119';\nimport { toolSearchRegex_20251119 } from './tool/tool-search-regex_20251119';\nimport { webFetch_20250910 } from './tool/web-fetch-20250910';\nimport { webSearch_20250305 } from './tool/web-search_20250305';\n\nexport const anthropicTools = {\n  /**\n   * The bash tool enables Claude to execute shell commands in a persistent bash session,\n   * allowing system operations, script execution, and command-line automation.\n   *\n   * Image results are supported.\n   */\n  bash_20241022,\n\n  /**\n   * The bash tool enables Claude to execute shell commands in a persistent bash session,\n   * allowing system operations, script execution, and command-line automation.\n   *\n   * Image results are supported.\n   */\n  bash_20250124,\n\n  /**\n   * Claude can analyze data, create visualizations, perform complex calculations,\n   * run system commands, create and edit files, and process uploaded files directly within\n   * the API conversation.\n   *\n   * The code execution tool allows Claude to run Bash commands and manipulate files,\n   * including writing code, in a secure, sandboxed environment.\n   */\n  codeExecution_20250522,\n\n  /**\n   * Claude can analyze data, create visualizations, perform complex calculations,\n   * run system commands, create and edit files, and process uploaded files directly within\n   * the API conversation.\n   *\n   * The code execution tool allows Claude to run both Python and Bash commands and manipulate files,\n   * including writing code, in a secure, sandboxed environment.\n   *\n   * This is the latest version with enhanced Bash support and file operations.\n   */\n  codeExecution_20250825,\n\n  /**\n   * Claude can interact with computer environments through the computer use tool, which\n   * provides screenshot capabilities and mouse/keyboard control for autonomous desktop interaction.\n   *\n   * Image results are supported.\n   *\n   * @param displayWidthPx - The width of the display being controlled by the model in pixels.\n   * @param displayHeightPx - The height of the display being controlled by the model in pixels.\n   * @param displayNumber - The display number to control (only relevant for X11 environments). If specified, the tool will be provided a display number in the tool definition.\n   */\n  computer_20241022,\n\n  /**\n   * Claude can interact with computer environments through the computer use tool, which\n   * provides screenshot capabilities and mouse/keyboard control for autonomous desktop interaction.\n   *\n   * Image results are supported.\n   *\n   * @param displayWidthPx - The width of the display being controlled by the model in pixels.\n   * @param displayHeightPx - The height of the display being controlled by the model in pixels.\n   * @param displayNumber - The display number to control (only relevant for X11 environments). If specified, the tool will be provided a display number in the tool definition.\n   */\n  computer_20250124,\n\n  /**\n   * The memory tool enables Claude to store and retrieve information across conversations through a memory file directory.\n   * Claude can create, read, update, and delete files that persist between sessions,\n   * allowing it to build knowledge over time without keeping everything in the context window.\n   * The memory tool operates client-sideyou control where and how the data is stored through your own infrastructure.\n   *\n   * Supported models: Claude Sonnet 4.5, Claude Sonnet 4, Claude Opus 4.1, Claude Opus 4.\n   */\n  memory_20250818,\n\n  /**\n   * Claude can use an Anthropic-defined text editor tool to view and modify text files,\n   * helping you debug, fix, and improve your code or other text documents. This allows Claude\n   * to directly interact with your files, providing hands-on assistance rather than just suggesting changes.\n   *\n   * Supported models: Claude Sonnet 3.5\n   */\n  textEditor_20241022,\n\n  /**\n   * Claude can use an Anthropic-defined text editor tool to view and modify text files,\n   * helping you debug, fix, and improve your code or other text documents. This allows Claude\n   * to directly interact with your files, providing hands-on assistance rather than just suggesting changes.\n   *\n   * Supported models: Claude Sonnet 3.7\n   */\n  textEditor_20250124,\n\n  /**\n   * Claude can use an Anthropic-defined text editor tool to view and modify text files,\n   * helping you debug, fix, and improve your code or other text documents. This allows Claude\n   * to directly interact with your files, providing hands-on assistance rather than just suggesting changes.\n   *\n   * Note: This version does not support the \"undo_edit\" command.\n   *\n   * @deprecated Use textEditor_20250728 instead\n   */\n  textEditor_20250429,\n\n  /**\n   * Claude can use an Anthropic-defined text editor tool to view and modify text files,\n   * helping you debug, fix, and improve your code or other text documents. This allows Claude\n   * to directly interact with your files, providing hands-on assistance rather than just suggesting changes.\n   *\n   * Note: This version does not support the \"undo_edit\" command and adds optional max_characters parameter.\n   *\n   * Supported models: Claude Sonnet 4, Opus 4, and Opus 4.1\n   *\n   * @param maxCharacters - Optional maximum number of characters to view in the file\n   */\n  textEditor_20250728,\n\n  /**\n   * Creates a web fetch tool that gives Claude direct access to real-time web content.\n   *\n   * @param maxUses - The max_uses parameter limits the number of web fetches performed\n   * @param allowedDomains - Only fetch from these domains\n   * @param blockedDomains - Never fetch from these domains\n   * @param citations - Unlike web search where citations are always enabled, citations are optional for web fetch. Set \"citations\": {\"enabled\": true} to enable Claude to cite specific passages from fetched documents.\n   * @param maxContentTokens - The max_content_tokens parameter limits the amount of content that will be included in the context.\n   */\n  webFetch_20250910,\n\n  /**\n   * Creates a web search tool that gives Claude direct access to real-time web content.\n   *\n   * @param maxUses - Maximum number of web searches Claude can perform during the conversation.\n   * @param allowedDomains - Optional list of domains that Claude is allowed to search.\n   * @param blockedDomains - Optional list of domains that Claude should avoid when searching.\n   * @param userLocation - Optional user location information to provide geographically relevant search results.\n   */\n  webSearch_20250305,\n\n  /**\n   * Creates a tool search tool that uses regex patterns to find tools.\n   *\n   * The tool search tool enables Claude to work with hundreds or thousands of tools\n   * by dynamically discovering and loading them on-demand. Instead of loading all\n   * tool definitions into the context window upfront, Claude searches your tool\n   * catalog and loads only the tools it needs.\n   *\n   * Use `providerOptions: { anthropic: { deferLoading: true } }` on other tools\n   * to mark them for deferred loading.\n   *\n   * Supported models: Claude Opus 4.5, Claude Sonnet 4.5\n   */\n  toolSearchRegex_20251119,\n\n  /**\n   * Creates a tool search tool that uses BM25 (natural language) to find tools.\n   *\n   * The tool search tool enables Claude to work with hundreds or thousands of tools\n   * by dynamically discovering and loading them on-demand. Instead of loading all\n   * tool definitions into the context window upfront, Claude searches your tool\n   * catalog and loads only the tools it needs.\n   *\n   * Use `providerOptions: { anthropic: { deferLoading: true } }` on other tools\n   * to mark them for deferred loading.\n   *\n   * Supported models: Claude Opus 4.5, Claude Sonnet 4.5\n   */\n  toolSearchBm25_20251119,\n};\n","import { JSONObject } from '@ai-sdk/provider';\nimport { AnthropicMessageMetadata } from './anthropic-message-metadata';\n\n/**\n * Sets the Anthropic container ID in the provider options based on\n * any previous step's provider metadata.\n *\n * Searches backwards through steps to find the most recent container ID.\n * You can use this function in `prepareStep` to forward the container ID between steps.\n */\nexport function forwardAnthropicContainerIdFromLastStep({\n  steps,\n}: {\n  steps: Array<{\n    providerMetadata?: Record<string, JSONObject>;\n  }>;\n}): undefined | { providerOptions?: Record<string, JSONObject> } {\n  // Search backwards through steps to find the most recent container ID\n  for (let i = steps.length - 1; i >= 0; i--) {\n    const containerId = (\n      steps[i].providerMetadata?.anthropic as\n        | AnthropicMessageMetadata\n        | undefined\n    )?.container?.id;\n\n    if (containerId) {\n      return {\n        providerOptions: {\n          anthropic: {\n            container: { id: containerId },\n          },\n        },\n      };\n    }\n  }\n\n  return undefined;\n}\n"],"mappings":"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","names":["z","z","z","z","z","z","z","z","z","z","z","z","z","z","z","z","lazySchema","zodSchema","anthropic","factory","createProviderToolFactoryWithOutputSchema","anthropicTools","UnsupportedFunctionalityError","_a","_b","i","validateTypes","generateId","parseProviderOptions","createProviderToolFactory"]}
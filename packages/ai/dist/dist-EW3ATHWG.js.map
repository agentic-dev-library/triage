{"version":3,"sources":["../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/xai-provider.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/xai-chat-language-model.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/convert-to-xai-chat-messages.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/convert-xai-chat-usage.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/get-response-metadata.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/map-xai-finish-reason.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/xai-chat-options.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/xai-error.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/xai-prepare-tools.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/responses/xai-responses-language-model.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/responses/convert-to-xai-responses-input.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/responses/convert-xai-responses-usage.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/responses/map-xai-responses-finish-reason.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/responses/xai-responses-api.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/responses/xai-responses-options.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/responses/xai-responses-prepare-tools.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/tool/web-search.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/tool/x-search.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/tool/code-execution.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/tool/view-image.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/tool/view-x-video.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/tool/index.ts","../../../node_modules/.pnpm/@ai-sdk+xai@3.0.3_zod@4.2.1/node_modules/@ai-sdk/xai/src/version.ts"],"sourcesContent":["import {\n  OpenAICompatibleImageModel,\n  ProviderErrorStructure,\n} from '@ai-sdk/openai-compatible';\nimport {\n  ImageModelV3,\n  LanguageModelV3,\n  NoSuchModelError,\n  ProviderV3,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  generateId,\n  loadApiKey,\n  withoutTrailingSlash,\n  withUserAgentSuffix,\n} from '@ai-sdk/provider-utils';\nimport { XaiChatLanguageModel } from './xai-chat-language-model';\nimport { XaiChatModelId } from './xai-chat-options';\nimport { XaiErrorData, xaiErrorDataSchema } from './xai-error';\nimport { XaiImageModelId } from './xai-image-settings';\nimport { XaiResponsesLanguageModel } from './responses/xai-responses-language-model';\nimport { XaiResponsesModelId } from './responses/xai-responses-options';\nimport { xaiTools } from './tool';\nimport { VERSION } from './version';\n\nconst xaiErrorStructure: ProviderErrorStructure<XaiErrorData> = {\n  errorSchema: xaiErrorDataSchema,\n  errorToMessage: data => data.error.message,\n};\n\nexport interface XaiProvider extends ProviderV3 {\n  /**\nCreates an Xai chat model for text generation.\n   */\n  (modelId: XaiChatModelId): LanguageModelV3;\n\n  /**\nCreates an Xai language model for text generation.\n   */\n  languageModel(modelId: XaiChatModelId): LanguageModelV3;\n\n  /**\nCreates an Xai chat model for text generation.\n   */\n  chat: (modelId: XaiChatModelId) => LanguageModelV3;\n\n  /**\nCreates an Xai responses model for agentic tool calling.\n   */\n  responses: (modelId: XaiResponsesModelId) => LanguageModelV3;\n\n  /**\nCreates an Xai image model for image generation.\n   */\n  image(modelId: XaiImageModelId): ImageModelV3;\n\n  /**\nCreates an Xai image model for image generation.\n   */\n  imageModel(modelId: XaiImageModelId): ImageModelV3;\n\n  /**\nServer-side agentic tools for use with the responses API.\n   */\n  tools: typeof xaiTools;\n\n  /**\n   * @deprecated Use `embeddingModel` instead.\n   */\n  textEmbeddingModel(modelId: string): never;\n}\n\nexport interface XaiProviderSettings {\n  /**\nBase URL for the xAI API calls.\n     */\n  baseURL?: string;\n\n  /**\nAPI key for authenticating requests.\n   */\n  apiKey?: string;\n\n  /**\nCustom headers to include in the requests.\n   */\n  headers?: Record<string, string>;\n\n  /**\nCustom fetch implementation. You can use it as a middleware to intercept requests,\nor to provide a custom fetch implementation for e.g. testing.\n  */\n  fetch?: FetchFunction;\n}\n\nexport function createXai(options: XaiProviderSettings = {}): XaiProvider {\n  const baseURL = withoutTrailingSlash(\n    options.baseURL ?? 'https://api.x.ai/v1',\n  );\n  const getHeaders = () =>\n    withUserAgentSuffix(\n      {\n        Authorization: `Bearer ${loadApiKey({\n          apiKey: options.apiKey,\n          environmentVariableName: 'XAI_API_KEY',\n          description: 'xAI API key',\n        })}`,\n        ...options.headers,\n      },\n      `ai-sdk/xai/${VERSION}`,\n    );\n\n  const createChatLanguageModel = (modelId: XaiChatModelId) => {\n    return new XaiChatLanguageModel(modelId, {\n      provider: 'xai.chat',\n      baseURL,\n      headers: getHeaders,\n      generateId,\n      fetch: options.fetch,\n    });\n  };\n\n  const createResponsesLanguageModel = (modelId: XaiResponsesModelId) => {\n    return new XaiResponsesLanguageModel(modelId, {\n      provider: 'xai.responses',\n      baseURL,\n      headers: getHeaders,\n      generateId,\n      fetch: options.fetch,\n    });\n  };\n\n  const createImageModel = (modelId: XaiImageModelId) => {\n    return new OpenAICompatibleImageModel(modelId, {\n      provider: 'xai.image',\n      url: ({ path }) => `${baseURL}${path}`,\n      headers: getHeaders,\n      fetch: options.fetch,\n      errorStructure: xaiErrorStructure,\n    });\n  };\n\n  const provider = (modelId: XaiChatModelId) =>\n    createChatLanguageModel(modelId);\n\n  provider.specificationVersion = 'v3' as const;\n  provider.languageModel = createChatLanguageModel;\n  provider.chat = createChatLanguageModel;\n  provider.responses = createResponsesLanguageModel;\n  provider.embeddingModel = (modelId: string) => {\n    throw new NoSuchModelError({ modelId, modelType: 'embeddingModel' });\n  };\n  provider.textEmbeddingModel = provider.embeddingModel;\n  provider.imageModel = createImageModel;\n  provider.image = createImageModel;\n  provider.tools = xaiTools;\n\n  return provider;\n}\n\nexport const xai = createXai();\n","import {\n  LanguageModelV3,\n  LanguageModelV3CallOptions,\n  LanguageModelV3Content,\n  LanguageModelV3FinishReason,\n  LanguageModelV3GenerateResult,\n  LanguageModelV3StreamPart,\n  LanguageModelV3StreamResult,\n  LanguageModelV3Usage,\n  SharedV3Warning,\n} from '@ai-sdk/provider';\nimport {\n  combineHeaders,\n  createEventSourceResponseHandler,\n  createJsonResponseHandler,\n  FetchFunction,\n  parseProviderOptions,\n  ParseResult,\n  postJsonToApi,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\nimport { convertToXaiChatMessages } from './convert-to-xai-chat-messages';\nimport { convertXaiChatUsage } from './convert-xai-chat-usage';\nimport { getResponseMetadata } from './get-response-metadata';\nimport { mapXaiFinishReason } from './map-xai-finish-reason';\nimport { XaiChatModelId, xaiProviderOptions } from './xai-chat-options';\nimport { xaiFailedResponseHandler } from './xai-error';\nimport { prepareTools } from './xai-prepare-tools';\n\ntype XaiChatConfig = {\n  provider: string;\n  baseURL: string | undefined;\n  headers: () => Record<string, string | undefined>;\n  generateId: () => string;\n  fetch?: FetchFunction;\n};\n\nexport class XaiChatLanguageModel implements LanguageModelV3 {\n  readonly specificationVersion = 'v3';\n\n  readonly modelId: XaiChatModelId;\n\n  private readonly config: XaiChatConfig;\n\n  constructor(modelId: XaiChatModelId, config: XaiChatConfig) {\n    this.modelId = modelId;\n    this.config = config;\n  }\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  readonly supportedUrls: Record<string, RegExp[]> = {\n    'image/*': [/^https?:\\/\\/.*$/],\n  };\n\n  private async getArgs({\n    prompt,\n    maxOutputTokens,\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences,\n    seed,\n    responseFormat,\n    providerOptions,\n    tools,\n    toolChoice,\n  }: LanguageModelV3CallOptions) {\n    const warnings: SharedV3Warning[] = [];\n\n    // parse xai-specific provider options\n    const options =\n      (await parseProviderOptions({\n        provider: 'xai',\n        providerOptions,\n        schema: xaiProviderOptions,\n      })) ?? {};\n\n    // check for unsupported parameters\n    if (topK != null) {\n      warnings.push({ type: 'unsupported', feature: 'topK' });\n    }\n\n    if (frequencyPenalty != null) {\n      warnings.push({ type: 'unsupported', feature: 'frequencyPenalty' });\n    }\n\n    if (presencePenalty != null) {\n      warnings.push({ type: 'unsupported', feature: 'presencePenalty' });\n    }\n\n    if (stopSequences != null) {\n      warnings.push({ type: 'unsupported', feature: 'stopSequences' });\n    }\n\n    // convert ai sdk messages to xai format\n    const { messages, warnings: messageWarnings } =\n      convertToXaiChatMessages(prompt);\n    warnings.push(...messageWarnings);\n\n    // prepare tools for xai\n    const {\n      tools: xaiTools,\n      toolChoice: xaiToolChoice,\n      toolWarnings,\n    } = prepareTools({\n      tools,\n      toolChoice,\n    });\n    warnings.push(...toolWarnings);\n\n    const baseArgs = {\n      // model id\n      model: this.modelId,\n\n      // standard generation settings\n      max_completion_tokens: maxOutputTokens,\n      temperature,\n      top_p: topP,\n      seed,\n      reasoning_effort: options.reasoningEffort,\n\n      // parallel function calling\n      parallel_function_calling: options.parallel_function_calling,\n\n      // response format\n      response_format:\n        responseFormat?.type === 'json'\n          ? responseFormat.schema != null\n            ? {\n                type: 'json_schema',\n                json_schema: {\n                  name: responseFormat.name ?? 'response',\n                  schema: responseFormat.schema,\n                  strict: true,\n                },\n              }\n            : { type: 'json_object' }\n          : undefined,\n\n      // search parameters\n      search_parameters: options.searchParameters\n        ? {\n            mode: options.searchParameters.mode,\n            return_citations: options.searchParameters.returnCitations,\n            from_date: options.searchParameters.fromDate,\n            to_date: options.searchParameters.toDate,\n            max_search_results: options.searchParameters.maxSearchResults,\n            sources: options.searchParameters.sources?.map(source => ({\n              type: source.type,\n              ...(source.type === 'web' && {\n                country: source.country,\n                excluded_websites: source.excludedWebsites,\n                allowed_websites: source.allowedWebsites,\n                safe_search: source.safeSearch,\n              }),\n              ...(source.type === 'x' && {\n                excluded_x_handles: source.excludedXHandles,\n                included_x_handles: source.includedXHandles ?? source.xHandles,\n                post_favorite_count: source.postFavoriteCount,\n                post_view_count: source.postViewCount,\n              }),\n              ...(source.type === 'news' && {\n                country: source.country,\n                excluded_websites: source.excludedWebsites,\n                safe_search: source.safeSearch,\n              }),\n              ...(source.type === 'rss' && {\n                links: source.links,\n              }),\n            })),\n          }\n        : undefined,\n\n      // messages in xai format\n      messages,\n\n      // tools in xai format\n      tools: xaiTools,\n      tool_choice: xaiToolChoice,\n    };\n\n    return {\n      args: baseArgs,\n      warnings,\n    };\n  }\n\n  async doGenerate(\n    options: LanguageModelV3CallOptions,\n  ): Promise<LanguageModelV3GenerateResult> {\n    const { args: body, warnings } = await this.getArgs(options);\n\n    const {\n      responseHeaders,\n      value: response,\n      rawValue: rawResponse,\n    } = await postJsonToApi({\n      url: `${this.config.baseURL ?? 'https://api.x.ai/v1'}/chat/completions`,\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: xaiFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        xaiChatResponseSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const choice = response.choices[0];\n    const content: Array<LanguageModelV3Content> = [];\n\n    // extract text content\n    if (choice.message.content != null && choice.message.content.length > 0) {\n      let text = choice.message.content;\n\n      // skip if this content duplicates the last assistant message\n      const lastMessage = body.messages[body.messages.length - 1];\n      if (lastMessage?.role === 'assistant' && text === lastMessage.content) {\n        text = '';\n      }\n\n      if (text.length > 0) {\n        content.push({ type: 'text', text });\n      }\n    }\n\n    // extract reasoning content\n    if (\n      choice.message.reasoning_content != null &&\n      choice.message.reasoning_content.length > 0\n    ) {\n      content.push({\n        type: 'reasoning',\n        text: choice.message.reasoning_content,\n      });\n    }\n\n    // extract tool calls\n    if (choice.message.tool_calls != null) {\n      for (const toolCall of choice.message.tool_calls) {\n        content.push({\n          type: 'tool-call',\n          toolCallId: toolCall.id,\n          toolName: toolCall.function.name,\n          input: toolCall.function.arguments,\n        });\n      }\n    }\n\n    // extract citations\n    if (response.citations != null) {\n      for (const url of response.citations) {\n        content.push({\n          type: 'source',\n          sourceType: 'url',\n          id: this.config.generateId(),\n          url,\n        });\n      }\n    }\n\n    return {\n      content,\n      finishReason: {\n        unified: mapXaiFinishReason(choice.finish_reason),\n        raw: choice.finish_reason ?? undefined,\n      },\n      usage: convertXaiChatUsage(response.usage),\n      request: { body },\n      response: {\n        ...getResponseMetadata(response),\n        headers: responseHeaders,\n        body: rawResponse,\n      },\n      warnings,\n    };\n  }\n\n  async doStream(\n    options: LanguageModelV3CallOptions,\n  ): Promise<LanguageModelV3StreamResult> {\n    const { args, warnings } = await this.getArgs(options);\n    const body = {\n      ...args,\n      stream: true,\n      stream_options: {\n        include_usage: true,\n      },\n    };\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: `${this.config.baseURL ?? 'https://api.x.ai/v1'}/chat/completions`,\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: xaiFailedResponseHandler,\n      successfulResponseHandler:\n        createEventSourceResponseHandler(xaiChatChunkSchema),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    let finishReason: LanguageModelV3FinishReason = {\n      unified: 'other',\n      raw: undefined,\n    };\n    let usage: LanguageModelV3Usage | undefined = undefined;\n    let isFirstChunk = true;\n    const contentBlocks: Record<string, { type: 'text' | 'reasoning' }> = {};\n    const lastReasoningDeltas: Record<string, string> = {};\n\n    const self = this;\n\n    return {\n      stream: response.pipeThrough(\n        new TransformStream<\n          ParseResult<z.infer<typeof xaiChatChunkSchema>>,\n          LanguageModelV3StreamPart\n        >({\n          start(controller) {\n            controller.enqueue({ type: 'stream-start', warnings });\n          },\n\n          transform(chunk, controller) {\n            // Emit raw chunk if requested (before anything else)\n            if (options.includeRawChunks) {\n              controller.enqueue({ type: 'raw', rawValue: chunk.rawValue });\n            }\n\n            if (!chunk.success) {\n              controller.enqueue({ type: 'error', error: chunk.error });\n              return;\n            }\n\n            const value = chunk.value;\n\n            // emit response metadata on first chunk\n            if (isFirstChunk) {\n              controller.enqueue({\n                type: 'response-metadata',\n                ...getResponseMetadata(value),\n              });\n              isFirstChunk = false;\n            }\n\n            // emit citations if present (they come in the last chunk according to docs)\n            if (value.citations != null) {\n              for (const url of value.citations) {\n                controller.enqueue({\n                  type: 'source',\n                  sourceType: 'url',\n                  id: self.config.generateId(),\n                  url,\n                });\n              }\n            }\n\n            // update usage if present\n            if (value.usage != null) {\n              usage = convertXaiChatUsage(value.usage);\n            }\n\n            const choice = value.choices[0];\n\n            // update finish reason if present\n            if (choice?.finish_reason != null) {\n              finishReason = {\n                unified: mapXaiFinishReason(choice.finish_reason),\n                raw: choice.finish_reason,\n              };\n            }\n\n            // exit if no delta to process\n            if (choice?.delta == null) {\n              return;\n            }\n\n            const delta = choice.delta;\n            const choiceIndex = choice.index;\n\n            // process text content\n            if (delta.content != null && delta.content.length > 0) {\n              const textContent = delta.content;\n\n              // skip if this content duplicates the last assistant message\n              const lastMessage = body.messages[body.messages.length - 1];\n              if (\n                lastMessage?.role === 'assistant' &&\n                textContent === lastMessage.content\n              ) {\n                return;\n              }\n\n              const blockId = `text-${value.id || choiceIndex}`;\n\n              if (contentBlocks[blockId] == null) {\n                contentBlocks[blockId] = { type: 'text' };\n                controller.enqueue({\n                  type: 'text-start',\n                  id: blockId,\n                });\n              }\n\n              controller.enqueue({\n                type: 'text-delta',\n                id: blockId,\n                delta: textContent,\n              });\n            }\n\n            // process reasoning content\n            if (\n              delta.reasoning_content != null &&\n              delta.reasoning_content.length > 0\n            ) {\n              const blockId = `reasoning-${value.id || choiceIndex}`;\n\n              // skip if this reasoning content duplicates the last delta\n              if (lastReasoningDeltas[blockId] === delta.reasoning_content) {\n                return;\n              }\n              lastReasoningDeltas[blockId] = delta.reasoning_content;\n\n              if (contentBlocks[blockId] == null) {\n                contentBlocks[blockId] = { type: 'reasoning' };\n                controller.enqueue({\n                  type: 'reasoning-start',\n                  id: blockId,\n                });\n              }\n\n              controller.enqueue({\n                type: 'reasoning-delta',\n                id: blockId,\n                delta: delta.reasoning_content,\n              });\n            }\n\n            // process tool calls\n            if (delta.tool_calls != null) {\n              for (const toolCall of delta.tool_calls) {\n                // xai tool calls come in one piece (like mistral)\n                const toolCallId = toolCall.id;\n\n                controller.enqueue({\n                  type: 'tool-input-start',\n                  id: toolCallId,\n                  toolName: toolCall.function.name,\n                });\n\n                controller.enqueue({\n                  type: 'tool-input-delta',\n                  id: toolCallId,\n                  delta: toolCall.function.arguments,\n                });\n\n                controller.enqueue({\n                  type: 'tool-input-end',\n                  id: toolCallId,\n                });\n\n                controller.enqueue({\n                  type: 'tool-call',\n                  toolCallId,\n                  toolName: toolCall.function.name,\n                  input: toolCall.function.arguments,\n                });\n              }\n            }\n          },\n\n          flush(controller) {\n            for (const [blockId, block] of Object.entries(contentBlocks)) {\n              controller.enqueue({\n                type: block.type === 'text' ? 'text-end' : 'reasoning-end',\n                id: blockId,\n              });\n            }\n\n            controller.enqueue({ type: 'finish', finishReason, usage: usage! });\n          },\n        }),\n      ),\n      request: { body },\n      response: { headers: responseHeaders },\n    };\n  }\n}\n\n// XAI API Response Schemas\nconst xaiUsageSchema = z.object({\n  prompt_tokens: z.number(),\n  completion_tokens: z.number(),\n  total_tokens: z.number(),\n  prompt_tokens_details: z\n    .object({\n      text_tokens: z.number().nullish(),\n      audio_tokens: z.number().nullish(),\n      image_tokens: z.number().nullish(),\n      cached_tokens: z.number().nullish(),\n    })\n    .nullish(),\n  completion_tokens_details: z\n    .object({\n      reasoning_tokens: z.number().nullish(),\n      audio_tokens: z.number().nullish(),\n      accepted_prediction_tokens: z.number().nullish(),\n      rejected_prediction_tokens: z.number().nullish(),\n    })\n    .nullish(),\n});\n\nexport type XaiChatUsage = z.infer<typeof xaiUsageSchema>;\n\nconst xaiChatResponseSchema = z.object({\n  id: z.string().nullish(),\n  created: z.number().nullish(),\n  model: z.string().nullish(),\n  choices: z.array(\n    z.object({\n      message: z.object({\n        role: z.literal('assistant'),\n        content: z.string().nullish(),\n        reasoning_content: z.string().nullish(),\n        tool_calls: z\n          .array(\n            z.object({\n              id: z.string(),\n              type: z.literal('function'),\n              function: z.object({\n                name: z.string(),\n                arguments: z.string(),\n              }),\n            }),\n          )\n          .nullish(),\n      }),\n      index: z.number(),\n      finish_reason: z.string().nullish(),\n    }),\n  ),\n  object: z.literal('chat.completion'),\n  usage: xaiUsageSchema,\n  citations: z.array(z.string().url()).nullish(),\n});\n\nconst xaiChatChunkSchema = z.object({\n  id: z.string().nullish(),\n  created: z.number().nullish(),\n  model: z.string().nullish(),\n  choices: z.array(\n    z.object({\n      delta: z.object({\n        role: z.enum(['assistant']).optional(),\n        content: z.string().nullish(),\n        reasoning_content: z.string().nullish(),\n        tool_calls: z\n          .array(\n            z.object({\n              id: z.string(),\n              type: z.literal('function'),\n              function: z.object({\n                name: z.string(),\n                arguments: z.string(),\n              }),\n            }),\n          )\n          .nullish(),\n      }),\n      finish_reason: z.string().nullish(),\n      index: z.number(),\n    }),\n  ),\n  usage: xaiUsageSchema.nullish(),\n  citations: z.array(z.string().url()).nullish(),\n});\n","import {\n  SharedV3Warning,\n  LanguageModelV3Prompt,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport { convertToBase64 } from '@ai-sdk/provider-utils';\nimport { XaiChatPrompt } from './xai-chat-prompt';\n\nexport function convertToXaiChatMessages(prompt: LanguageModelV3Prompt): {\n  messages: XaiChatPrompt;\n  warnings: Array<SharedV3Warning>;\n} {\n  const messages: XaiChatPrompt = [];\n  const warnings: Array<SharedV3Warning> = [];\n\n  for (const { role, content } of prompt) {\n    switch (role) {\n      case 'system': {\n        messages.push({ role: 'system', content });\n        break;\n      }\n\n      case 'user': {\n        if (content.length === 1 && content[0].type === 'text') {\n          messages.push({ role: 'user', content: content[0].text });\n          break;\n        }\n\n        messages.push({\n          role: 'user',\n          content: content.map(part => {\n            switch (part.type) {\n              case 'text': {\n                return { type: 'text', text: part.text };\n              }\n              case 'file': {\n                if (part.mediaType.startsWith('image/')) {\n                  const mediaType =\n                    part.mediaType === 'image/*'\n                      ? 'image/jpeg'\n                      : part.mediaType;\n\n                  return {\n                    type: 'image_url',\n                    image_url: {\n                      url:\n                        part.data instanceof URL\n                          ? part.data.toString()\n                          : `data:${mediaType};base64,${convertToBase64(part.data)}`,\n                    },\n                  };\n                } else {\n                  throw new UnsupportedFunctionalityError({\n                    functionality: `file part media type ${part.mediaType}`,\n                  });\n                }\n              }\n            }\n          }),\n        });\n\n        break;\n      }\n\n      case 'assistant': {\n        let text = '';\n        const toolCalls: Array<{\n          id: string;\n          type: 'function';\n          function: { name: string; arguments: string };\n        }> = [];\n\n        for (const part of content) {\n          switch (part.type) {\n            case 'text': {\n              text += part.text;\n              break;\n            }\n            case 'tool-call': {\n              toolCalls.push({\n                id: part.toolCallId,\n                type: 'function',\n                function: {\n                  name: part.toolName,\n                  arguments: JSON.stringify(part.input),\n                },\n              });\n              break;\n            }\n          }\n        }\n\n        messages.push({\n          role: 'assistant',\n          content: text,\n          tool_calls: toolCalls.length > 0 ? toolCalls : undefined,\n        });\n\n        break;\n      }\n\n      case 'tool': {\n        for (const toolResponse of content) {\n          if (toolResponse.type === 'tool-approval-response') {\n            continue;\n          }\n          const output = toolResponse.output;\n\n          let contentValue: string;\n          switch (output.type) {\n            case 'text':\n            case 'error-text':\n              contentValue = output.value;\n              break;\n            case 'execution-denied':\n              contentValue = output.reason ?? 'Tool execution denied.';\n              break;\n            case 'content':\n            case 'json':\n            case 'error-json':\n              contentValue = JSON.stringify(output.value);\n              break;\n          }\n\n          messages.push({\n            role: 'tool',\n            tool_call_id: toolResponse.toolCallId,\n            content: contentValue,\n          });\n        }\n        break;\n      }\n\n      default: {\n        const _exhaustiveCheck: never = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  return { messages, warnings };\n}\n","import { LanguageModelV3Usage } from '@ai-sdk/provider';\nimport { XaiChatUsage } from './xai-chat-language-model';\n\nexport function convertXaiChatUsage(usage: XaiChatUsage): LanguageModelV3Usage {\n  const cacheReadTokens = usage.prompt_tokens_details?.cached_tokens ?? 0;\n  const reasoningTokens =\n    usage.completion_tokens_details?.reasoning_tokens ?? 0;\n\n  return {\n    inputTokens: {\n      total: usage.prompt_tokens,\n      noCache: usage.prompt_tokens - cacheReadTokens,\n      cacheRead: cacheReadTokens,\n      cacheWrite: undefined,\n    },\n    outputTokens: {\n      total: usage.completion_tokens + reasoningTokens,\n      text: usage.completion_tokens,\n      reasoning: reasoningTokens,\n    },\n    raw: usage,\n  };\n}\n","export function getResponseMetadata({\n  id,\n  model,\n  created,\n  created_at,\n}: {\n  id?: string | undefined | null;\n  created?: number | undefined | null;\n  created_at?: number | undefined | null;\n  model?: string | undefined | null;\n}) {\n  const unixTime = created ?? created_at;\n\n  return {\n    id: id ?? undefined,\n    modelId: model ?? undefined,\n    timestamp: unixTime != null ? new Date(unixTime * 1000) : undefined,\n  };\n}\n","import { LanguageModelV3FinishReason } from '@ai-sdk/provider';\n\nexport function mapXaiFinishReason(\n  finishReason: string | null | undefined,\n): LanguageModelV3FinishReason['unified'] {\n  switch (finishReason) {\n    case 'stop':\n      return 'stop';\n    case 'length':\n      return 'length';\n    case 'tool_calls':\n    case 'function_call':\n      return 'tool-calls';\n    case 'content_filter':\n      return 'content-filter';\n    default:\n      return 'other';\n  }\n}\n","import { z } from 'zod/v4';\n\n// https://console.x.ai and see \"View models\"\nexport type XaiChatModelId =\n  | 'grok-4-1'\n  | 'grok-4-1-fast-reasoning'\n  | 'grok-4-1-fast-non-reasoning'\n  | 'grok-4-fast-non-reasoning'\n  | 'grok-4-fast-reasoning'\n  | 'grok-code-fast-1'\n  | 'grok-4'\n  | 'grok-4-0709'\n  | 'grok-4-latest'\n  | 'grok-3'\n  | 'grok-3-latest'\n  | 'grok-3-fast'\n  | 'grok-3-fast-latest'\n  | 'grok-3-mini'\n  | 'grok-3-mini-latest'\n  | 'grok-3-mini-fast'\n  | 'grok-3-mini-fast-latest'\n  | 'grok-2-vision-1212'\n  | 'grok-2-vision'\n  | 'grok-2-vision-latest'\n  | 'grok-2-image-1212'\n  | 'grok-2-image'\n  | 'grok-2-image-latest'\n  | 'grok-2-1212'\n  | 'grok-2'\n  | 'grok-2-latest'\n  | 'grok-vision-beta'\n  | 'grok-beta'\n  | (string & {});\n\n// search source schemas\nconst webSourceSchema = z.object({\n  type: z.literal('web'),\n  country: z.string().length(2).optional(),\n  excludedWebsites: z.array(z.string()).max(5).optional(),\n  allowedWebsites: z.array(z.string()).max(5).optional(),\n  safeSearch: z.boolean().optional(),\n});\n\nconst xSourceSchema = z.object({\n  type: z.literal('x'),\n  excludedXHandles: z.array(z.string()).optional(),\n  includedXHandles: z.array(z.string()).optional(),\n  postFavoriteCount: z.number().int().optional(),\n  postViewCount: z.number().int().optional(),\n  /**\n   * @deprecated use `includedXHandles` instead\n   */\n  xHandles: z.array(z.string()).optional(),\n});\n\nconst newsSourceSchema = z.object({\n  type: z.literal('news'),\n  country: z.string().length(2).optional(),\n  excludedWebsites: z.array(z.string()).max(5).optional(),\n  safeSearch: z.boolean().optional(),\n});\n\nconst rssSourceSchema = z.object({\n  type: z.literal('rss'),\n  links: z.array(z.string().url()).max(1), // currently only supports one RSS link\n});\n\nconst searchSourceSchema = z.discriminatedUnion('type', [\n  webSourceSchema,\n  xSourceSchema,\n  newsSourceSchema,\n  rssSourceSchema,\n]);\n\n// xai-specific provider options\nexport const xaiProviderOptions = z.object({\n  reasoningEffort: z.enum(['low', 'high']).optional(),\n\n  /**\n   * Whether to enable parallel function calling during tool use.\n   * When true, the model can call multiple functions in parallel.\n   * When false, the model will call functions sequentially.\n   * Defaults to true.\n   */\n  parallel_function_calling: z.boolean().optional(),\n\n  searchParameters: z\n    .object({\n      /**\n       * search mode preference\n       * - \"off\": disables search completely\n       * - \"auto\": model decides whether to search (default)\n       * - \"on\": always enables search\n       */\n      mode: z.enum(['off', 'auto', 'on']),\n\n      /**\n       * whether to return citations in the response\n       * defaults to true\n       */\n      returnCitations: z.boolean().optional(),\n\n      /**\n       * start date for search data (ISO8601 format: YYYY-MM-DD)\n       */\n      fromDate: z.string().optional(),\n\n      /**\n       * end date for search data (ISO8601 format: YYYY-MM-DD)\n       */\n      toDate: z.string().optional(),\n\n      /**\n       * maximum number of search results to consider\n       * defaults to 20\n       */\n      maxSearchResults: z.number().min(1).max(50).optional(),\n\n      /**\n       * data sources to search from.\n       * defaults to [{ type: 'web' }, { type: 'x' }] if not specified.\n       *\n       * @example\n       * sources: [{ type: 'web', country: 'US' }, { type: 'x' }]\n       */\n      sources: z.array(searchSourceSchema).optional(),\n    })\n    .optional(),\n});\n\nexport type XaiProviderOptions = z.infer<typeof xaiProviderOptions>;\n","import { createJsonErrorResponseHandler } from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\n// Add error schema and structure\nexport const xaiErrorDataSchema = z.object({\n  error: z.object({\n    message: z.string(),\n    type: z.string().nullish(),\n    param: z.any().nullish(),\n    code: z.union([z.string(), z.number()]).nullish(),\n  }),\n});\n\nexport type XaiErrorData = z.infer<typeof xaiErrorDataSchema>;\n\nexport const xaiFailedResponseHandler = createJsonErrorResponseHandler({\n  errorSchema: xaiErrorDataSchema,\n  errorToMessage: data => data.error.message,\n});\n","import {\n  LanguageModelV3CallOptions,\n  SharedV3Warning,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport { XaiToolChoice } from './xai-chat-prompt';\n\nexport function prepareTools({\n  tools,\n  toolChoice,\n}: {\n  tools: LanguageModelV3CallOptions['tools'];\n  toolChoice?: LanguageModelV3CallOptions['toolChoice'];\n}): {\n  tools:\n    | Array<{\n        type: 'function';\n        function: {\n          name: string;\n          description: string | undefined;\n          parameters: unknown;\n        };\n      }>\n    | undefined;\n  toolChoice: XaiToolChoice | undefined;\n  toolWarnings: SharedV3Warning[];\n} {\n  // when the tools array is empty, change it to undefined to prevent errors\n  tools = tools?.length ? tools : undefined;\n\n  const toolWarnings: SharedV3Warning[] = [];\n\n  if (tools == null) {\n    return { tools: undefined, toolChoice: undefined, toolWarnings };\n  }\n\n  // convert ai sdk tools to xai format\n  const xaiTools: Array<{\n    type: 'function';\n    function: {\n      name: string;\n      description: string | undefined;\n      parameters: unknown;\n    };\n  }> = [];\n\n  for (const tool of tools) {\n    if (tool.type === 'provider') {\n      toolWarnings.push({\n        type: 'unsupported',\n        feature: `provider-defined tool ${tool.name}`,\n      });\n    } else {\n      xaiTools.push({\n        type: 'function',\n        function: {\n          name: tool.name,\n          description: tool.description,\n          parameters: tool.inputSchema,\n        },\n      });\n    }\n  }\n\n  if (toolChoice == null) {\n    return { tools: xaiTools, toolChoice: undefined, toolWarnings };\n  }\n\n  const type = toolChoice.type;\n\n  switch (type) {\n    case 'auto':\n    case 'none':\n      return { tools: xaiTools, toolChoice: type, toolWarnings };\n    case 'required':\n      // xai supports 'required' directly\n      return { tools: xaiTools, toolChoice: 'required', toolWarnings };\n    case 'tool':\n      // xai supports specific tool selection\n      return {\n        tools: xaiTools,\n        toolChoice: {\n          type: 'function',\n          function: { name: toolChoice.toolName },\n        },\n        toolWarnings,\n      };\n    default: {\n      const _exhaustiveCheck: never = type;\n      throw new UnsupportedFunctionalityError({\n        functionality: `tool choice type: ${_exhaustiveCheck}`,\n      });\n    }\n  }\n}\n","import {\n  LanguageModelV3,\n  LanguageModelV3CallOptions,\n  LanguageModelV3Content,\n  LanguageModelV3FinishReason,\n  LanguageModelV3GenerateResult,\n  LanguageModelV3StreamPart,\n  LanguageModelV3StreamResult,\n  LanguageModelV3Usage,\n  SharedV3Warning,\n} from '@ai-sdk/provider';\nimport {\n  combineHeaders,\n  createEventSourceResponseHandler,\n  createJsonResponseHandler,\n  FetchFunction,\n  parseProviderOptions,\n  ParseResult,\n  postJsonToApi,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\nimport { getResponseMetadata } from '../get-response-metadata';\nimport { xaiFailedResponseHandler } from '../xai-error';\nimport { convertToXaiResponsesInput } from './convert-to-xai-responses-input';\nimport { convertXaiResponsesUsage } from './convert-xai-responses-usage';\nimport { mapXaiResponsesFinishReason } from './map-xai-responses-finish-reason';\nimport {\n  xaiResponsesChunkSchema,\n  xaiResponsesResponseSchema,\n} from './xai-responses-api';\nimport {\n  XaiResponsesModelId,\n  xaiResponsesProviderOptions,\n} from './xai-responses-options';\nimport { prepareResponsesTools } from './xai-responses-prepare-tools';\n\ntype XaiResponsesConfig = {\n  provider: string;\n  baseURL: string | undefined;\n  headers: () => Record<string, string | undefined>;\n  generateId: () => string;\n  fetch?: FetchFunction;\n};\n\nexport class XaiResponsesLanguageModel implements LanguageModelV3 {\n  readonly specificationVersion = 'v3';\n\n  readonly modelId: XaiResponsesModelId;\n\n  private readonly config: XaiResponsesConfig;\n\n  constructor(modelId: XaiResponsesModelId, config: XaiResponsesConfig) {\n    this.modelId = modelId;\n    this.config = config;\n  }\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  readonly supportedUrls: Record<string, RegExp[]> = {\n    'image/*': [/^https?:\\/\\/.*$/],\n  };\n\n  private async getArgs({\n    prompt,\n    maxOutputTokens,\n    temperature,\n    topP,\n    stopSequences,\n    seed,\n    providerOptions,\n    tools,\n    toolChoice,\n  }: LanguageModelV3CallOptions) {\n    const warnings: SharedV3Warning[] = [];\n\n    const options =\n      (await parseProviderOptions({\n        provider: 'xai',\n        providerOptions,\n        schema: xaiResponsesProviderOptions,\n      })) ?? {};\n\n    if (stopSequences != null) {\n      warnings.push({ type: 'unsupported', feature: 'stopSequences' });\n    }\n\n    const webSearchToolName = tools?.find(\n      tool => tool.type === 'provider' && tool.id === 'xai.web_search',\n    )?.name;\n\n    const xSearchToolName = tools?.find(\n      tool => tool.type === 'provider' && tool.id === 'xai.x_search',\n    )?.name;\n\n    const codeExecutionToolName = tools?.find(\n      tool => tool.type === 'provider' && tool.id === 'xai.code_execution',\n    )?.name;\n\n    const { input, inputWarnings } = await convertToXaiResponsesInput({\n      prompt,\n      store: true,\n    });\n    warnings.push(...inputWarnings);\n\n    const {\n      tools: xaiTools,\n      toolChoice: xaiToolChoice,\n      toolWarnings,\n    } = await prepareResponsesTools({\n      tools,\n      toolChoice,\n    });\n    warnings.push(...toolWarnings);\n\n    const baseArgs: Record<string, unknown> = {\n      model: this.modelId,\n      input,\n      max_output_tokens: maxOutputTokens,\n      temperature,\n      top_p: topP,\n      seed,\n      ...(options.reasoningEffort != null && {\n        reasoning: { effort: options.reasoningEffort },\n      }),\n      ...(options.store === false && {\n        store: options.store,\n        include: ['reasoning.encrypted_content'],\n      }),\n      ...(options.previousResponseId != null && {\n        previous_response_id: options.previousResponseId,\n      }),\n    };\n\n    if (xaiTools && xaiTools.length > 0) {\n      baseArgs.tools = xaiTools;\n    }\n\n    if (xaiToolChoice != null) {\n      baseArgs.tool_choice = xaiToolChoice;\n    }\n\n    return {\n      args: baseArgs,\n      warnings,\n      webSearchToolName,\n      xSearchToolName,\n      codeExecutionToolName,\n    };\n  }\n\n  async doGenerate(\n    options: LanguageModelV3CallOptions,\n  ): Promise<LanguageModelV3GenerateResult> {\n    const {\n      args: body,\n      warnings,\n      webSearchToolName,\n      xSearchToolName,\n      codeExecutionToolName,\n    } = await this.getArgs(options);\n\n    const {\n      responseHeaders,\n      value: response,\n      rawValue: rawResponse,\n    } = await postJsonToApi({\n      url: `${this.config.baseURL ?? 'https://api.x.ai/v1'}/responses`,\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: xaiFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        xaiResponsesResponseSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const content: Array<LanguageModelV3Content> = [];\n\n    const webSearchSubTools = [\n      'web_search',\n      'web_search_with_snippets',\n      'browse_page',\n    ];\n    const xSearchSubTools = [\n      'x_user_search',\n      'x_keyword_search',\n      'x_semantic_search',\n      'x_thread_fetch',\n    ];\n\n    for (const part of response.output) {\n      if (\n        part.type === 'web_search_call' ||\n        part.type === 'x_search_call' ||\n        part.type === 'code_interpreter_call' ||\n        part.type === 'code_execution_call' ||\n        part.type === 'view_image_call' ||\n        part.type === 'view_x_video_call' ||\n        part.type === 'custom_tool_call'\n      ) {\n        let toolName = part.name ?? '';\n        if (webSearchSubTools.includes(part.name ?? '')) {\n          toolName = webSearchToolName ?? 'web_search';\n        } else if (xSearchSubTools.includes(part.name ?? '')) {\n          toolName = xSearchToolName ?? 'x_search';\n        } else if (part.name === 'code_execution') {\n          toolName = codeExecutionToolName ?? 'code_execution';\n        }\n\n        // custom_tool_call uses 'input' field, others use 'arguments'\n        const toolInput =\n          part.type === 'custom_tool_call'\n            ? (part.input ?? '')\n            : (part.arguments ?? '');\n\n        content.push({\n          type: 'tool-call',\n          toolCallId: part.id,\n          toolName,\n          input: toolInput,\n          providerExecuted: true,\n        });\n\n        continue;\n      }\n\n      switch (part.type) {\n        case 'message': {\n          for (const contentPart of part.content) {\n            if (contentPart.text) {\n              content.push({\n                type: 'text',\n                text: contentPart.text,\n              });\n            }\n\n            if (contentPart.annotations) {\n              for (const annotation of contentPart.annotations) {\n                if (annotation.type === 'url_citation' && 'url' in annotation) {\n                  content.push({\n                    type: 'source',\n                    sourceType: 'url',\n                    id: this.config.generateId(),\n                    url: annotation.url,\n                    title: annotation.title ?? annotation.url,\n                  });\n                }\n              }\n            }\n          }\n\n          break;\n        }\n\n        case 'function_call': {\n          content.push({\n            type: 'tool-call',\n            toolCallId: part.call_id,\n            toolName: part.name,\n            input: part.arguments,\n          });\n          break;\n        }\n\n        default: {\n          break;\n        }\n      }\n    }\n\n    return {\n      content,\n      finishReason: {\n        unified: mapXaiResponsesFinishReason(response.status),\n        raw: response.status ?? undefined,\n      },\n      usage: convertXaiResponsesUsage(response.usage),\n      request: { body },\n      response: {\n        ...getResponseMetadata(response),\n        headers: responseHeaders,\n        body: rawResponse,\n      },\n      warnings,\n    };\n  }\n\n  async doStream(\n    options: LanguageModelV3CallOptions,\n  ): Promise<LanguageModelV3StreamResult> {\n    const {\n      args,\n      warnings,\n      webSearchToolName,\n      xSearchToolName,\n      codeExecutionToolName,\n    } = await this.getArgs(options);\n    const body = {\n      ...args,\n      stream: true,\n    };\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: `${this.config.baseURL ?? 'https://api.x.ai/v1'}/responses`,\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: xaiFailedResponseHandler,\n      successfulResponseHandler: createEventSourceResponseHandler(\n        xaiResponsesChunkSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    let finishReason: LanguageModelV3FinishReason = {\n      unified: 'other',\n      raw: undefined,\n    };\n    let usage: LanguageModelV3Usage | undefined = undefined;\n    let isFirstChunk = true;\n    const contentBlocks: Record<string, { type: 'text' }> = {};\n    const seenToolCalls = new Set<string>();\n\n    const self = this;\n\n    return {\n      stream: response.pipeThrough(\n        new TransformStream<\n          ParseResult<z.infer<typeof xaiResponsesChunkSchema>>,\n          LanguageModelV3StreamPart\n        >({\n          start(controller) {\n            controller.enqueue({ type: 'stream-start', warnings });\n          },\n\n          transform(chunk, controller) {\n            if (options.includeRawChunks) {\n              controller.enqueue({ type: 'raw', rawValue: chunk.rawValue });\n            }\n\n            if (!chunk.success) {\n              controller.enqueue({ type: 'error', error: chunk.error });\n              return;\n            }\n\n            const event = chunk.value;\n\n            if (\n              event.type === 'response.created' ||\n              event.type === 'response.in_progress'\n            ) {\n              if (isFirstChunk) {\n                controller.enqueue({\n                  type: 'response-metadata',\n                  ...getResponseMetadata(event.response),\n                });\n                isFirstChunk = false;\n              }\n              return;\n            }\n\n            if (event.type === 'response.reasoning_summary_part.added') {\n              const blockId = `reasoning-${event.item_id}`;\n\n              controller.enqueue({\n                type: 'reasoning-start',\n                id: blockId,\n              });\n            }\n\n            if (event.type === 'response.reasoning_summary_text.delta') {\n              const blockId = `reasoning-${event.item_id}`;\n\n              controller.enqueue({\n                type: 'reasoning-delta',\n                id: blockId,\n                delta: event.delta,\n              });\n\n              return;\n            }\n\n            if (event.type === 'response.reasoning_summary_text.done') {\n              const blockId = `reasoning-${event.item_id}`;\n\n              controller.enqueue({\n                type: 'reasoning-end',\n                id: blockId,\n              });\n            }\n\n            if (event.type === 'response.output_text.delta') {\n              const blockId = `text-${event.item_id}`;\n\n              if (contentBlocks[blockId] == null) {\n                contentBlocks[blockId] = { type: 'text' };\n                controller.enqueue({\n                  type: 'text-start',\n                  id: blockId,\n                });\n              }\n\n              controller.enqueue({\n                type: 'text-delta',\n                id: blockId,\n                delta: event.delta,\n              });\n\n              return;\n            }\n\n            if (event.type === 'response.output_text.done') {\n              if (event.annotations) {\n                for (const annotation of event.annotations) {\n                  if (\n                    annotation.type === 'url_citation' &&\n                    'url' in annotation\n                  ) {\n                    controller.enqueue({\n                      type: 'source',\n                      sourceType: 'url',\n                      id: self.config.generateId(),\n                      url: annotation.url,\n                      title: annotation.title ?? annotation.url,\n                    });\n                  }\n                }\n              }\n\n              return;\n            }\n\n            if (event.type === 'response.output_text.annotation.added') {\n              const annotation = event.annotation;\n              if (annotation.type === 'url_citation' && 'url' in annotation) {\n                controller.enqueue({\n                  type: 'source',\n                  sourceType: 'url',\n                  id: self.config.generateId(),\n                  url: annotation.url,\n                  title: annotation.title ?? annotation.url,\n                });\n              }\n\n              return;\n            }\n\n            if (\n              event.type === 'response.done' ||\n              event.type === 'response.completed'\n            ) {\n              const response = event.response;\n\n              if (response.usage) {\n                usage = convertXaiResponsesUsage(response.usage);\n              }\n\n              if (response.status) {\n                finishReason = {\n                  unified: mapXaiResponsesFinishReason(response.status),\n                  raw: response.status,\n                };\n              }\n\n              return;\n            }\n\n            if (\n              event.type === 'response.output_item.added' ||\n              event.type === 'response.output_item.done'\n            ) {\n              const part = event.item;\n              if (\n                part.type === 'web_search_call' ||\n                part.type === 'x_search_call' ||\n                part.type === 'code_interpreter_call' ||\n                part.type === 'code_execution_call' ||\n                part.type === 'view_image_call' ||\n                part.type === 'view_x_video_call' ||\n                part.type === 'custom_tool_call'\n              ) {\n                if (!seenToolCalls.has(part.id)) {\n                  seenToolCalls.add(part.id);\n\n                  const webSearchSubTools = [\n                    'web_search',\n                    'web_search_with_snippets',\n                    'browse_page',\n                  ];\n                  const xSearchSubTools = [\n                    'x_user_search',\n                    'x_keyword_search',\n                    'x_semantic_search',\n                    'x_thread_fetch',\n                  ];\n\n                  let toolName = part.name ?? '';\n                  if (webSearchSubTools.includes(part.name ?? '')) {\n                    toolName = webSearchToolName ?? 'web_search';\n                  } else if (xSearchSubTools.includes(part.name ?? '')) {\n                    toolName = xSearchToolName ?? 'x_search';\n                  } else if (part.name === 'code_execution') {\n                    toolName = codeExecutionToolName ?? 'code_execution';\n                  }\n\n                  // custom_tool_call uses 'input' field, others use 'arguments'\n                  const toolInput =\n                    part.type === 'custom_tool_call'\n                      ? (part.input ?? '')\n                      : (part.arguments ?? '');\n\n                  controller.enqueue({\n                    type: 'tool-input-start',\n                    id: part.id,\n                    toolName,\n                  });\n\n                  controller.enqueue({\n                    type: 'tool-input-delta',\n                    id: part.id,\n                    delta: toolInput,\n                  });\n\n                  controller.enqueue({\n                    type: 'tool-input-end',\n                    id: part.id,\n                  });\n\n                  controller.enqueue({\n                    type: 'tool-call',\n                    toolCallId: part.id,\n                    toolName,\n                    input: toolInput,\n                    providerExecuted: true,\n                  });\n                }\n\n                return;\n              }\n\n              if (part.type === 'message') {\n                for (const contentPart of part.content) {\n                  if (contentPart.text && contentPart.text.length > 0) {\n                    const blockId = `text-${part.id}`;\n\n                    if (contentBlocks[blockId] == null) {\n                      contentBlocks[blockId] = { type: 'text' };\n                      controller.enqueue({\n                        type: 'text-start',\n                        id: blockId,\n                      });\n                    }\n\n                    controller.enqueue({\n                      type: 'text-delta',\n                      id: blockId,\n                      delta: contentPart.text,\n                    });\n                  }\n\n                  if (contentPart.annotations) {\n                    for (const annotation of contentPart.annotations) {\n                      if (\n                        annotation.type === 'url_citation' &&\n                        'url' in annotation\n                      ) {\n                        controller.enqueue({\n                          type: 'source',\n                          sourceType: 'url',\n                          id: self.config.generateId(),\n                          url: annotation.url,\n                          title: annotation.title ?? annotation.url,\n                        });\n                      }\n                    }\n                  }\n                }\n              } else if (part.type === 'function_call') {\n                if (!seenToolCalls.has(part.call_id)) {\n                  seenToolCalls.add(part.call_id);\n\n                  controller.enqueue({\n                    type: 'tool-input-start',\n                    id: part.call_id,\n                    toolName: part.name,\n                  });\n\n                  controller.enqueue({\n                    type: 'tool-input-delta',\n                    id: part.call_id,\n                    delta: part.arguments,\n                  });\n\n                  controller.enqueue({\n                    type: 'tool-input-end',\n                    id: part.call_id,\n                  });\n\n                  controller.enqueue({\n                    type: 'tool-call',\n                    toolCallId: part.call_id,\n                    toolName: part.name,\n                    input: part.arguments,\n                  });\n                }\n              }\n            }\n          },\n\n          flush(controller) {\n            for (const [blockId, block] of Object.entries(contentBlocks)) {\n              if (block.type === 'text') {\n                controller.enqueue({\n                  type: 'text-end',\n                  id: blockId,\n                });\n              }\n            }\n\n            controller.enqueue({ type: 'finish', finishReason, usage: usage! });\n          },\n        }),\n      ),\n      request: { body },\n      response: { headers: responseHeaders },\n    };\n  }\n}\n","import { SharedV3Warning, LanguageModelV3Message } from '@ai-sdk/provider';\nimport { XaiResponsesInput } from './xai-responses-api';\n\nexport async function convertToXaiResponsesInput({\n  prompt,\n}: {\n  prompt: LanguageModelV3Message[];\n  store?: boolean;\n}): Promise<{\n  input: XaiResponsesInput;\n  inputWarnings: SharedV3Warning[];\n}> {\n  const input: XaiResponsesInput = [];\n  const inputWarnings: SharedV3Warning[] = [];\n\n  for (const message of prompt) {\n    switch (message.role) {\n      case 'system': {\n        input.push({\n          role: 'system',\n          content: message.content,\n        });\n        break;\n      }\n\n      case 'user': {\n        let userContent = '';\n\n        for (const block of message.content) {\n          switch (block.type) {\n            case 'text': {\n              userContent += block.text;\n              break;\n            }\n\n            case 'file': {\n              inputWarnings.push({\n                type: 'other',\n                message: `xAI Responses API does not support ${block.type} in user messages`,\n              });\n              break;\n            }\n\n            default: {\n              const _exhaustiveCheck: never = block;\n              inputWarnings.push({\n                type: 'other',\n                message:\n                  'xAI Responses API does not support this content type in user messages',\n              });\n            }\n          }\n        }\n\n        input.push({\n          role: 'user',\n          content: userContent,\n        });\n        break;\n      }\n\n      case 'assistant': {\n        for (const part of message.content) {\n          switch (part.type) {\n            case 'text': {\n              const id =\n                typeof part.providerOptions?.xai?.itemId === 'string'\n                  ? part.providerOptions.xai.itemId\n                  : undefined;\n\n              input.push({\n                role: 'assistant',\n                content: part.text,\n                id,\n              });\n\n              break;\n            }\n\n            case 'tool-call': {\n              if (part.providerExecuted) {\n                break;\n              }\n\n              const id =\n                typeof part.providerOptions?.xai?.itemId === 'string'\n                  ? part.providerOptions.xai.itemId\n                  : undefined;\n\n              input.push({\n                type: 'function_call',\n                id: id ?? part.toolCallId,\n                call_id: part.toolCallId,\n                name: part.toolName,\n                arguments: JSON.stringify(part.input),\n                status: 'completed',\n              });\n              break;\n            }\n\n            case 'tool-result': {\n              break;\n            }\n\n            case 'reasoning':\n            case 'file': {\n              inputWarnings.push({\n                type: 'other',\n                message: `xAI Responses API does not support ${part.type} in assistant messages`,\n              });\n              break;\n            }\n\n            default: {\n              const _exhaustiveCheck: never = part;\n              inputWarnings.push({\n                type: 'other',\n                message:\n                  'xAI Responses API does not support this content type in assistant messages',\n              });\n            }\n          }\n        }\n\n        break;\n      }\n\n      case 'tool': {\n        for (const part of message.content) {\n          if (part.type === 'tool-approval-response') {\n            continue;\n          }\n          const output = part.output;\n\n          let outputValue: string;\n          switch (output.type) {\n            case 'text':\n            case 'error-text':\n              outputValue = output.value;\n              break;\n            case 'execution-denied':\n              outputValue = output.reason ?? 'tool execution denied';\n              break;\n            case 'json':\n            case 'error-json':\n              outputValue = JSON.stringify(output.value);\n              break;\n            case 'content':\n              outputValue = output.value\n                .map(item => {\n                  if (item.type === 'text') {\n                    return item.text;\n                  }\n                  return '';\n                })\n                .join('');\n              break;\n            default: {\n              const _exhaustiveCheck: never = output;\n              outputValue = '';\n            }\n          }\n\n          input.push({\n            type: 'function_call_output',\n            call_id: part.toolCallId,\n            output: outputValue,\n          });\n        }\n\n        break;\n      }\n\n      default: {\n        const _exhaustiveCheck: never = message;\n        inputWarnings.push({\n          type: 'other',\n          message: 'unsupported message role',\n        });\n      }\n    }\n  }\n\n  return { input, inputWarnings };\n}\n","import { LanguageModelV3Usage } from '@ai-sdk/provider';\nimport { XaiResponsesUsage } from './xai-responses-api';\n\nexport function convertXaiResponsesUsage(\n  usage: XaiResponsesUsage,\n): LanguageModelV3Usage {\n  const cacheReadTokens = usage.input_tokens_details?.cached_tokens ?? 0;\n  const reasoningTokens = usage.output_tokens_details?.reasoning_tokens ?? 0;\n\n  return {\n    inputTokens: {\n      total: usage.input_tokens,\n      noCache: usage.input_tokens - cacheReadTokens,\n      cacheRead: cacheReadTokens,\n      cacheWrite: undefined,\n    },\n    outputTokens: {\n      total: usage.output_tokens,\n      text: usage.output_tokens - reasoningTokens,\n      reasoning: reasoningTokens,\n    },\n    raw: usage,\n  };\n}\n","import { LanguageModelV3FinishReason } from '@ai-sdk/provider';\n\nexport function mapXaiResponsesFinishReason(\n  finishReason: string | null | undefined,\n): LanguageModelV3FinishReason['unified'] {\n  switch (finishReason) {\n    case 'stop':\n    case 'completed':\n      return 'stop';\n    case 'length':\n      return 'length';\n    case 'tool_calls':\n    case 'function_call':\n      return 'tool-calls';\n    case 'content_filter':\n      return 'content-filter';\n    default:\n      return 'other';\n  }\n}\n","import { z } from 'zod/v4';\n\nexport type XaiResponsesInput = Array<XaiResponsesInputItem>;\n\nexport type XaiResponsesInputItem =\n  | XaiResponsesSystemMessage\n  | XaiResponsesUserMessage\n  | XaiResponsesAssistantMessage\n  | XaiResponsesFunctionCallOutput\n  | XaiResponsesReasoning\n  | XaiResponsesToolCall;\n\nexport type XaiResponsesSystemMessage = {\n  role: 'system' | 'developer';\n  content: string;\n};\n\nexport type XaiResponsesUserMessage = {\n  role: 'user';\n  content: string;\n};\n\nexport type XaiResponsesAssistantMessage = {\n  role: 'assistant';\n  content: string;\n  id?: string;\n};\n\nexport type XaiResponsesFunctionCallOutput = {\n  type: 'function_call_output';\n  call_id: string;\n  output: string;\n};\n\nexport type XaiResponsesReasoning = {\n  type: 'reasoning';\n  id: string;\n  summary: Array<{\n    type: 'summary_text';\n    text: string;\n  }>;\n  status: string;\n  encrypted_content?: string | null;\n};\n\nexport type XaiResponsesToolCall = {\n  type:\n    | 'function_call'\n    | 'web_search_call'\n    | 'x_search_call'\n    | 'code_interpreter_call'\n    | 'custom_tool_call';\n  id: string;\n  call_id?: string;\n  name?: string;\n  arguments?: string;\n  input?: string;\n  status: string;\n  action?: any;\n};\n\nexport type XaiResponsesTool =\n  | {\n      type: 'web_search';\n      allowed_domains?: string[];\n      excluded_domains?: string[];\n      enable_image_understanding?: boolean;\n    }\n  | {\n      type: 'x_search';\n      allowed_x_handles?: string[];\n      excluded_x_handles?: string[];\n      from_date?: string;\n      to_date?: string;\n      enable_image_understanding?: boolean;\n      enable_video_understanding?: boolean;\n    }\n  | { type: 'code_interpreter' }\n  | { type: 'view_image' }\n  | { type: 'view_x_video' }\n  | { type: 'file_search' }\n  | { type: 'mcp' }\n  | {\n      type: 'function';\n      function: {\n        name: string;\n        description?: string;\n        parameters: unknown;\n      };\n    };\n\nconst annotationSchema = z.union([\n  z.object({\n    type: z.literal('url_citation'),\n    url: z.string(),\n    title: z.string().optional(),\n  }),\n  z.object({\n    type: z.string(),\n  }),\n]);\n\nconst messageContentPartSchema = z.object({\n  type: z.string(),\n  text: z.string().optional(),\n  logprobs: z.array(z.any()).optional(),\n  annotations: z.array(annotationSchema).optional(),\n});\n\nconst reasoningSummaryPartSchema = z.object({\n  type: z.string(),\n  text: z.string(),\n});\n\nconst toolCallSchema = z.object({\n  name: z.string().optional(),\n  arguments: z.string().optional(),\n  input: z.string().optional(),\n  call_id: z.string().optional(),\n  id: z.string(),\n  status: z.string(),\n  action: z.any().optional(),\n});\n\nconst outputItemSchema = z.discriminatedUnion('type', [\n  z.object({\n    type: z.literal('web_search_call'),\n    ...toolCallSchema.shape,\n  }),\n  z.object({\n    type: z.literal('x_search_call'),\n    ...toolCallSchema.shape,\n  }),\n  z.object({\n    type: z.literal('code_interpreter_call'),\n    ...toolCallSchema.shape,\n  }),\n  z.object({\n    type: z.literal('code_execution_call'),\n    ...toolCallSchema.shape,\n  }),\n  z.object({\n    type: z.literal('view_image_call'),\n    ...toolCallSchema.shape,\n  }),\n  z.object({\n    type: z.literal('view_x_video_call'),\n    ...toolCallSchema.shape,\n  }),\n  z.object({\n    type: z.literal('custom_tool_call'),\n    ...toolCallSchema.shape,\n  }),\n  z.object({\n    type: z.literal('message'),\n    role: z.string(),\n    content: z.array(messageContentPartSchema),\n    id: z.string(),\n    status: z.string(),\n  }),\n  z.object({\n    type: z.literal('function_call'),\n    name: z.string(),\n    arguments: z.string(),\n    call_id: z.string(),\n    id: z.string(),\n  }),\n  z.object({\n    type: z.literal('reasoning'),\n    id: z.string(),\n    summary: z.array(reasoningSummaryPartSchema),\n    status: z.string(),\n  }),\n]);\n\nexport const xaiResponsesUsageSchema = z.object({\n  input_tokens: z.number(),\n  output_tokens: z.number(),\n  total_tokens: z.number().optional(),\n  input_tokens_details: z\n    .object({\n      cached_tokens: z.number().optional(),\n    })\n    .optional(),\n  output_tokens_details: z\n    .object({\n      reasoning_tokens: z.number().optional(),\n    })\n    .optional(),\n  num_sources_used: z.number().optional(),\n  num_server_side_tools_used: z.number().optional(),\n});\n\nexport const xaiResponsesResponseSchema = z.object({\n  id: z.string().nullish(),\n  created_at: z.number().nullish(),\n  model: z.string().nullish(),\n  object: z.literal('response'),\n  output: z.array(outputItemSchema),\n  usage: xaiResponsesUsageSchema,\n  status: z.string(),\n});\n\nexport const xaiResponsesChunkSchema = z.union([\n  z.object({\n    type: z.literal('response.created'),\n    response: xaiResponsesResponseSchema.partial({ usage: true, status: true }),\n  }),\n  z.object({\n    type: z.literal('response.in_progress'),\n    response: xaiResponsesResponseSchema.partial({ usage: true, status: true }),\n  }),\n  z.object({\n    type: z.literal('response.output_item.added'),\n    item: outputItemSchema,\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.output_item.done'),\n    item: outputItemSchema,\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.content_part.added'),\n    item_id: z.string(),\n    output_index: z.number(),\n    content_index: z.number(),\n    part: messageContentPartSchema,\n  }),\n  z.object({\n    type: z.literal('response.content_part.done'),\n    item_id: z.string(),\n    output_index: z.number(),\n    content_index: z.number(),\n    part: messageContentPartSchema,\n  }),\n  z.object({\n    type: z.literal('response.output_text.delta'),\n    item_id: z.string(),\n    output_index: z.number(),\n    content_index: z.number(),\n    delta: z.string(),\n    logprobs: z.array(z.any()).optional(),\n  }),\n  z.object({\n    type: z.literal('response.output_text.done'),\n    item_id: z.string(),\n    output_index: z.number(),\n    content_index: z.number(),\n    text: z.string(),\n    logprobs: z.array(z.any()).optional(),\n    annotations: z.array(annotationSchema).optional(),\n  }),\n  z.object({\n    type: z.literal('response.output_text.annotation.added'),\n    item_id: z.string(),\n    output_index: z.number(),\n    content_index: z.number(),\n    annotation_index: z.number(),\n    annotation: annotationSchema,\n  }),\n  z.object({\n    type: z.literal('response.reasoning_summary_part.added'),\n    item_id: z.string(),\n    output_index: z.number(),\n    summary_index: z.number(),\n    part: reasoningSummaryPartSchema,\n  }),\n  z.object({\n    type: z.literal('response.reasoning_summary_part.done'),\n    item_id: z.string(),\n    output_index: z.number(),\n    summary_index: z.number(),\n    part: reasoningSummaryPartSchema,\n  }),\n  z.object({\n    type: z.literal('response.reasoning_summary_text.delta'),\n    item_id: z.string(),\n    output_index: z.number(),\n    summary_index: z.number(),\n    delta: z.string(),\n  }),\n  z.object({\n    type: z.literal('response.reasoning_summary_text.done'),\n    item_id: z.string(),\n    output_index: z.number(),\n    summary_index: z.number(),\n    text: z.string(),\n  }),\n  z.object({\n    type: z.literal('response.web_search_call.in_progress'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.web_search_call.searching'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.web_search_call.completed'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.x_search_call.in_progress'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.x_search_call.searching'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.x_search_call.completed'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.code_execution_call.in_progress'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.code_execution_call.executing'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.code_execution_call.completed'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.code_interpreter_call.in_progress'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.code_interpreter_call.executing'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.code_interpreter_call.completed'),\n    item_id: z.string(),\n    output_index: z.number(),\n  }),\n  z.object({\n    type: z.literal('response.done'),\n    response: xaiResponsesResponseSchema,\n  }),\n  z.object({\n    type: z.literal('response.completed'),\n    response: xaiResponsesResponseSchema,\n  }),\n]);\n\nexport type XaiResponsesResponse = z.infer<typeof xaiResponsesResponseSchema>;\nexport type XaiResponsesChunk = z.infer<typeof xaiResponsesChunkSchema>;\nexport type XaiResponsesUsage = z.infer<typeof xaiResponsesUsageSchema>;\n","import { z } from 'zod/v4';\n\nexport type XaiResponsesModelId =\n  | 'grok-4-1'\n  | 'grok-4-1-fast-reasoning'\n  | 'grok-4-1-fast-non-reasoning'\n  | 'grok-4'\n  | 'grok-4-fast'\n  | 'grok-4-fast-non-reasoning'\n  | (string & {});\n\n/**\n * @see https://docs.x.ai/docs/api-reference#create-new-response\n */\nexport const xaiResponsesProviderOptions = z.object({\n  /**\n   * Constrains how hard a reasoning model thinks before responding.\n   * Possible values are `low` (uses fewer reasoning tokens), `medium` and `high` (uses more reasoning tokens).\n   */\n  reasoningEffort: z.enum(['low', 'medium', 'high']).optional(),\n  /**\n   * Whether to store the input message(s) and model response for later retrieval.\n   * @default true\n   */\n  store: z.boolean().optional(),\n  /**\n   * The ID of the previous response from the model.\n   */\n  previousResponseId: z.string().optional(),\n});\n\nexport type XaiResponsesProviderOptions = z.infer<\n  typeof xaiResponsesProviderOptions\n>;\n","import {\n  LanguageModelV3CallOptions,\n  SharedV3Warning,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport { validateTypes } from '@ai-sdk/provider-utils';\nimport { webSearchArgsSchema } from '../tool/web-search';\nimport { xSearchArgsSchema } from '../tool/x-search';\nimport { XaiResponsesTool } from './xai-responses-api';\n\ntype XaiResponsesToolChoice =\n  | 'auto'\n  | 'none'\n  | 'required'\n  | { type: 'web_search' }\n  | { type: 'x_search' }\n  | { type: 'code_interpreter' }\n  | { type: 'view_image' }\n  | { type: 'view_x_video' }\n  | { type: 'file_search' }\n  | { type: 'mcp' }\n  | { type: 'function'; name: string };\n\nexport async function prepareResponsesTools({\n  tools,\n  toolChoice,\n}: {\n  tools: LanguageModelV3CallOptions['tools'];\n  toolChoice?: LanguageModelV3CallOptions['toolChoice'];\n}): Promise<{\n  tools: Array<XaiResponsesTool> | undefined;\n  toolChoice: XaiResponsesToolChoice | undefined;\n  toolWarnings: SharedV3Warning[];\n}> {\n  const normalizedTools = tools?.length ? tools : undefined;\n\n  const toolWarnings: SharedV3Warning[] = [];\n\n  if (normalizedTools == null) {\n    return { tools: undefined, toolChoice: undefined, toolWarnings };\n  }\n\n  const xaiTools: Array<XaiResponsesTool> = [];\n  const toolByName = new Map<string, (typeof normalizedTools)[number]>();\n\n  for (const tool of normalizedTools) {\n    toolByName.set(tool.name, tool);\n\n    if (tool.type === 'provider') {\n      switch (tool.id) {\n        case 'xai.web_search': {\n          const args = await validateTypes({\n            value: tool.args,\n            schema: webSearchArgsSchema,\n          });\n\n          xaiTools.push({\n            type: 'web_search',\n            allowed_domains: args.allowedDomains,\n            excluded_domains: args.excludedDomains,\n            enable_image_understanding: args.enableImageUnderstanding,\n          });\n          break;\n        }\n\n        case 'xai.x_search': {\n          const args = await validateTypes({\n            value: tool.args,\n            schema: xSearchArgsSchema,\n          });\n\n          xaiTools.push({\n            type: 'x_search',\n            allowed_x_handles: args.allowedXHandles,\n            excluded_x_handles: args.excludedXHandles,\n            from_date: args.fromDate,\n            to_date: args.toDate,\n            enable_image_understanding: args.enableImageUnderstanding,\n            enable_video_understanding: args.enableVideoUnderstanding,\n          });\n          break;\n        }\n\n        case 'xai.code_execution': {\n          xaiTools.push({\n            type: 'code_interpreter',\n          });\n          break;\n        }\n\n        case 'xai.view_image': {\n          xaiTools.push({\n            type: 'view_image',\n          });\n          break;\n        }\n\n        case 'xai.view_x_video': {\n          xaiTools.push({\n            type: 'view_x_video',\n          });\n          break;\n        }\n\n        case 'xai.file_search': {\n          xaiTools.push({\n            type: 'file_search',\n          });\n          break;\n        }\n\n        case 'xai.mcp': {\n          xaiTools.push({\n            type: 'mcp',\n          });\n          break;\n        }\n\n        default: {\n          toolWarnings.push({\n            type: 'unsupported',\n            feature: `provider-defined tool ${tool.name}`,\n          });\n          break;\n        }\n      }\n    } else {\n      xaiTools.push({\n        type: 'function',\n        function: {\n          name: tool.name,\n          description: tool.description,\n          parameters: tool.inputSchema,\n        },\n      });\n    }\n  }\n\n  if (toolChoice == null) {\n    return { tools: xaiTools, toolChoice: undefined, toolWarnings };\n  }\n\n  const type = toolChoice.type;\n\n  switch (type) {\n    case 'auto':\n    case 'none':\n      return { tools: xaiTools, toolChoice: type, toolWarnings };\n    case 'required':\n      return { tools: xaiTools, toolChoice: 'required', toolWarnings };\n    case 'tool': {\n      const selectedTool = toolByName.get(toolChoice.toolName);\n\n      if (selectedTool == null) {\n        return {\n          tools: xaiTools,\n          toolChoice: undefined,\n          toolWarnings,\n        };\n      }\n\n      if (selectedTool.type === 'provider') {\n        switch (selectedTool.id) {\n          case 'xai.web_search':\n            return {\n              tools: xaiTools,\n              toolChoice: { type: 'web_search' },\n              toolWarnings,\n            };\n          case 'xai.x_search':\n            return {\n              tools: xaiTools,\n              toolChoice: { type: 'x_search' },\n              toolWarnings,\n            };\n          case 'xai.code_execution':\n            return {\n              tools: xaiTools,\n              toolChoice: { type: 'code_interpreter' },\n              toolWarnings,\n            };\n          case 'xai.view_image':\n            return {\n              tools: xaiTools,\n              toolChoice: { type: 'view_image' },\n              toolWarnings,\n            };\n          case 'xai.view_x_video':\n            return {\n              tools: xaiTools,\n              toolChoice: { type: 'view_x_video' },\n              toolWarnings,\n            };\n          case 'xai.file_search':\n            return {\n              tools: xaiTools,\n              toolChoice: { type: 'file_search' },\n              toolWarnings,\n            };\n          case 'xai.mcp':\n            return {\n              tools: xaiTools,\n              toolChoice: { type: 'mcp' },\n              toolWarnings,\n            };\n          default:\n            toolWarnings.push({\n              type: 'unsupported',\n              feature: `provider-defined tool ${selectedTool.name}`,\n            });\n            return { tools: xaiTools, toolChoice: undefined, toolWarnings };\n        }\n      }\n\n      return {\n        tools: xaiTools,\n        toolChoice: { type: 'function', name: selectedTool.name },\n        toolWarnings,\n      };\n    }\n    default: {\n      const _exhaustiveCheck: never = type;\n      throw new UnsupportedFunctionalityError({\n        functionality: `tool choice type: ${_exhaustiveCheck}`,\n      });\n    }\n  }\n}\n","import {\n  createProviderToolFactoryWithOutputSchema,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nexport const webSearchArgsSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      allowedDomains: z.array(z.string()).max(5).optional(),\n      excludedDomains: z.array(z.string()).max(5).optional(),\n      enableImageUnderstanding: z.boolean().optional(),\n    }),\n  ),\n);\n\nconst webSearchOutputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      query: z.string(),\n      sources: z.array(\n        z.object({\n          title: z.string(),\n          url: z.string(),\n          snippet: z.string(),\n        }),\n      ),\n    }),\n  ),\n);\n\nconst webSearchToolFactory = createProviderToolFactoryWithOutputSchema<\n  Record<string, never>,\n  {\n    query: string;\n    sources: Array<{\n      title: string;\n      url: string;\n      snippet: string;\n    }>;\n  },\n  {\n    allowedDomains?: string[];\n    excludedDomains?: string[];\n    enableImageUnderstanding?: boolean;\n  }\n>({\n  id: 'xai.web_search',\n  inputSchema: lazySchema(() => zodSchema(z.object({}))),\n  outputSchema: webSearchOutputSchema,\n});\n\nexport const webSearch = (\n  args: Parameters<typeof webSearchToolFactory>[0] = {},\n) => webSearchToolFactory(args);\n","import {\n  createProviderToolFactoryWithOutputSchema,\n  lazySchema,\n  zodSchema,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nexport const xSearchArgsSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      allowedXHandles: z.array(z.string()).max(10).optional(),\n      excludedXHandles: z.array(z.string()).max(10).optional(),\n      fromDate: z.string().optional(),\n      toDate: z.string().optional(),\n      enableImageUnderstanding: z.boolean().optional(),\n      enableVideoUnderstanding: z.boolean().optional(),\n    }),\n  ),\n);\n\nconst xSearchOutputSchema = lazySchema(() =>\n  zodSchema(\n    z.object({\n      query: z.string(),\n      posts: z.array(\n        z.object({\n          author: z.string(),\n          text: z.string(),\n          url: z.string(),\n          likes: z.number(),\n        }),\n      ),\n    }),\n  ),\n);\n\nconst xSearchToolFactory = createProviderToolFactoryWithOutputSchema<\n  Record<string, never>,\n  {\n    query: string;\n    posts: Array<{\n      author: string;\n      text: string;\n      url: string;\n      likes: number;\n    }>;\n  },\n  {\n    allowedXHandles?: string[];\n    excludedXHandles?: string[];\n    fromDate?: string;\n    toDate?: string;\n    enableImageUnderstanding?: boolean;\n    enableVideoUnderstanding?: boolean;\n  }\n>({\n  id: 'xai.x_search',\n  inputSchema: lazySchema(() => zodSchema(z.object({}))),\n  outputSchema: xSearchOutputSchema,\n});\n\nexport const xSearch = (args: Parameters<typeof xSearchToolFactory>[0] = {}) =>\n  xSearchToolFactory(args);\n","import { createProviderToolFactoryWithOutputSchema } from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst codeExecutionOutputSchema = z.object({\n  output: z.string().describe('the output of the code execution'),\n  error: z.string().optional().describe('any error that occurred'),\n});\n\nconst codeExecutionToolFactory = createProviderToolFactoryWithOutputSchema({\n  id: 'xai.code_execution',\n  inputSchema: z.object({}).describe('no input parameters'),\n  outputSchema: codeExecutionOutputSchema,\n});\n\nexport const codeExecution = (\n  args: Parameters<typeof codeExecutionToolFactory>[0] = {},\n) => codeExecutionToolFactory(args);\n","import { createProviderToolFactoryWithOutputSchema } from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst viewImageOutputSchema = z.object({\n  description: z.string().describe('description of the image'),\n  objects: z\n    .array(z.string())\n    .optional()\n    .describe('objects detected in the image'),\n});\n\nconst viewImageToolFactory = createProviderToolFactoryWithOutputSchema({\n  id: 'xai.view_image',\n  inputSchema: z.object({}).describe('no input parameters'),\n  outputSchema: viewImageOutputSchema,\n});\n\nexport const viewImage = (\n  args: Parameters<typeof viewImageToolFactory>[0] = {},\n) => viewImageToolFactory(args);\n","import { createProviderToolFactoryWithOutputSchema } from '@ai-sdk/provider-utils';\nimport { z } from 'zod/v4';\n\nconst viewXVideoOutputSchema = z.object({\n  transcript: z.string().optional().describe('transcript of the video'),\n  description: z.string().describe('description of the video content'),\n  duration: z.number().optional().describe('duration in seconds'),\n});\n\nconst viewXVideoToolFactory = createProviderToolFactoryWithOutputSchema({\n  id: 'xai.view_x_video',\n  inputSchema: z.object({}).describe('no input parameters'),\n  outputSchema: viewXVideoOutputSchema,\n});\n\nexport const viewXVideo = (\n  args: Parameters<typeof viewXVideoToolFactory>[0] = {},\n) => viewXVideoToolFactory(args);\n","import { codeExecution } from './code-execution';\nimport { viewImage } from './view-image';\nimport { viewXVideo } from './view-x-video';\nimport { webSearch } from './web-search';\nimport { xSearch } from './x-search';\n\nexport { codeExecution, viewImage, viewXVideo, webSearch, xSearch };\n\nexport const xaiTools = {\n  codeExecution,\n  viewImage,\n  viewXVideo,\n  webSearch,\n  xSearch,\n};\n","// Version string of this package injected at build time.\ndeclare const __PACKAGE_VERSION__: string | undefined;\nexport const VERSION: string =\n  typeof __PACKAGE_VERSION__ !== 'undefined'\n    ? __PACKAGE_VERSION__\n    : '0.0.0-test';\n"],"mappings":"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","names":["z","z","z","z","z","z","z","z","xaiTools","UnsupportedFunctionalityError","_a","lazySchema","zodSchema","createProviderToolFactoryWithOutputSchema","parseProviderOptions","postJsonToApi","combineHeaders","createJsonResponseHandler","createEventSourceResponseHandler","response"]}
{"version":3,"sources":["../src/curator.ts"],"sourcesContent":["/**\n * @curator Bot - Issue triage, labeling, and assignment\n */\n\nimport type { Bot, BotContext, BotResponse } from './router.js';\n\nexport class CuratorBot implements Bot {\n    name = 'curator';\n    triggers = ['@curator', '/curator', '/triage'];\n\n    async handle(ctx: BotContext): Promise<BotResponse> {\n        // Curator auto-triages issues\n        const analysis = this.analyzeContent(ctx.body, ctx.query);\n\n        const body = this.formatAnalysis(analysis);\n\n        return {\n            body,\n            handled: true,\n            postComment: true,\n            addLabels: analysis.labels,\n        };\n    }\n\n    private analyzeContent(\n        body: string,\n        query: string\n    ): {\n        type: string;\n        priority: string;\n        effort: string;\n        agent: string;\n        labels: string[];\n    } {\n        const combined = `${body} ${query}`.toLowerCase();\n\n        let type = 'chore';\n        let priority = 'medium';\n        let effort = 'm';\n        let agent = 'ollama';\n        const labels: string[] = [];\n\n        // Detect type\n        if (combined.match(/bug|error|crash|broken|fix|issue|problem|fail/)) {\n            type = 'bug';\n            labels.push('bug');\n            priority = 'high';\n            agent = 'cursor';\n        } else if (combined.match(/feature|add|implement|create|new|enhance|request/)) {\n            type = 'feature';\n            labels.push('enhancement');\n            agent = 'jules';\n        } else if (combined.match(/question|how|what|why|help|confused|\\?/)) {\n            type = 'question';\n            labels.push('question');\n            priority = 'low';\n            agent = 'sage';\n        } else if (combined.match(/doc|readme|typo|spelling|grammar/)) {\n            type = 'docs';\n            labels.push('documentation');\n            priority = 'low';\n            agent = 'jules';\n        } else if (combined.match(/refactor|clean|organize|improve|performance|optimize/)) {\n            type = 'chore';\n            labels.push('refactor');\n            agent = 'jules';\n        }\n\n        // Detect priority\n        if (combined.match(/urgent|critical|blocker|asap|production|breaking|p0|p1/)) {\n            priority = 'critical';\n            labels.push('priority:critical');\n        } else if (combined.match(/security|vulnerability|cve|exploit|auth|password/)) {\n            priority = 'critical';\n            labels.push('security');\n        } else if (combined.match(/important|high|soon|p2/)) {\n            priority = 'high';\n            labels.push('priority:high');\n        } else if (combined.match(/low|minor|nice.to.have|p3|p4/)) {\n            priority = 'low';\n            labels.push('priority:low');\n        }\n\n        // Detect effort\n        if (combined.match(/quick|simple|small|minor|trivial|one.line|typo/)) {\n            effort = 'xs';\n            labels.push('good first issue');\n        } else if (combined.match(/complex|large|major|overhaul|rewrite|epic/)) {\n            effort = 'xl';\n            agent = 'cursor';\n        }\n\n        return { type, priority, effort, agent, labels };\n    }\n\n    private formatAnalysis(analysis: {\n        type: string;\n        priority: string;\n        effort: string;\n        agent: string;\n        labels: string[];\n    }): string {\n        const priorityEmoji: Record<string, string> = {\n            critical: 'üî¥',\n            high: 'üü†',\n            medium: 'üü°',\n            low: '‚ö™',\n        };\n\n        const typeEmoji: Record<string, string> = {\n            bug: 'üêõ',\n            feature: '‚ú®',\n            question: '‚ùì',\n            docs: 'üìö',\n            chore: 'üîß',\n        };\n\n        return `üìã **@curator** Triage\n\n| Field | Value |\n|-------|-------|\n| Type | ${typeEmoji[analysis.type] || ''} \\`${analysis.type}\\` |\n| Priority | ${priorityEmoji[analysis.priority] || ''} \\`${analysis.priority}\\` |\n| Effort | \\`${analysis.effort}\\` |\n| Agent | \\`@${analysis.agent}\\` |\n\n---\n_Use \\`@${analysis.agent}\\` to start work on this issue._`;\n    }\n}\n"],"mappings":";AAMO,IAAM,aAAN,MAAgC;AAAA,EACnC,OAAO;AAAA,EACP,WAAW,CAAC,YAAY,YAAY,SAAS;AAAA,EAE7C,MAAM,OAAO,KAAuC;AAEhD,UAAM,WAAW,KAAK,eAAe,IAAI,MAAM,IAAI,KAAK;AAExD,UAAM,OAAO,KAAK,eAAe,QAAQ;AAEzC,WAAO;AAAA,MACH;AAAA,MACA,SAAS;AAAA,MACT,aAAa;AAAA,MACb,WAAW,SAAS;AAAA,IACxB;AAAA,EACJ;AAAA,EAEQ,eACJ,MACA,OAOF;AACE,UAAM,WAAW,GAAG,IAAI,IAAI,KAAK,GAAG,YAAY;AAEhD,QAAI,OAAO;AACX,QAAI,WAAW;AACf,QAAI,SAAS;AACb,QAAI,QAAQ;AACZ,UAAM,SAAmB,CAAC;AAG1B,QAAI,SAAS,MAAM,+CAA+C,GAAG;AACjE,aAAO;AACP,aAAO,KAAK,KAAK;AACjB,iBAAW;AACX,cAAQ;AAAA,IACZ,WAAW,SAAS,MAAM,kDAAkD,GAAG;AAC3E,aAAO;AACP,aAAO,KAAK,aAAa;AACzB,cAAQ;AAAA,IACZ,WAAW,SAAS,MAAM,wCAAwC,GAAG;AACjE,aAAO;AACP,aAAO,KAAK,UAAU;AACtB,iBAAW;AACX,cAAQ;AAAA,IACZ,WAAW,SAAS,MAAM,kCAAkC,GAAG;AAC3D,aAAO;AACP,aAAO,KAAK,eAAe;AAC3B,iBAAW;AACX,cAAQ;AAAA,IACZ,WAAW,SAAS,MAAM,sDAAsD,GAAG;AAC/E,aAAO;AACP,aAAO,KAAK,UAAU;AACtB,cAAQ;AAAA,IACZ;AAGA,QAAI,SAAS,MAAM,wDAAwD,GAAG;AAC1E,iBAAW;AACX,aAAO,KAAK,mBAAmB;AAAA,IACnC,WAAW,SAAS,MAAM,kDAAkD,GAAG;AAC3E,iBAAW;AACX,aAAO,KAAK,UAAU;AAAA,IAC1B,WAAW,SAAS,MAAM,wBAAwB,GAAG;AACjD,iBAAW;AACX,aAAO,KAAK,eAAe;AAAA,IAC/B,WAAW,SAAS,MAAM,8BAA8B,GAAG;AACvD,iBAAW;AACX,aAAO,KAAK,cAAc;AAAA,IAC9B;AAGA,QAAI,SAAS,MAAM,gDAAgD,GAAG;AAClE,eAAS;AACT,aAAO,KAAK,kBAAkB;AAAA,IAClC,WAAW,SAAS,MAAM,2CAA2C,GAAG;AACpE,eAAS;AACT,cAAQ;AAAA,IACZ;AAEA,WAAO,EAAE,MAAM,UAAU,QAAQ,OAAO,OAAO;AAAA,EACnD;AAAA,EAEQ,eAAe,UAMZ;AACP,UAAM,gBAAwC;AAAA,MAC1C,UAAU;AAAA,MACV,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,KAAK;AAAA,IACT;AAEA,UAAM,YAAoC;AAAA,MACtC,KAAK;AAAA,MACL,SAAS;AAAA,MACT,UAAU;AAAA,MACV,MAAM;AAAA,MACN,OAAO;AAAA,IACX;AAEA,WAAO;AAAA;AAAA;AAAA;AAAA,WAIJ,UAAU,SAAS,IAAI,KAAK,EAAE,MAAM,SAAS,IAAI;AAAA,eAC7C,cAAc,SAAS,QAAQ,KAAK,EAAE,MAAM,SAAS,QAAQ;AAAA,eAC7D,SAAS,MAAM;AAAA,eACf,SAAS,KAAK;AAAA;AAAA;AAAA,UAGnB,SAAS,KAAK;AAAA,EACpB;AACJ;","names":[]}
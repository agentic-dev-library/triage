{"version":3,"sources":["../src/cli.ts"],"sourcesContent":["#!/usr/bin/env node\nimport { Command } from 'commander';\nimport { resolveModel } from '@agentic/triage-ai';\nimport {\n    type AgentRouting,\n    decomposeTask,\n    routeToAgent,\n    type SageResponse,\n    sage,\n    type TaskDecomposition,\n    type UnblockResponse,\n    unblock,\n} from '@agentic/triage-core';\nimport { runMcpServer } from './mcp-server.js';\n\nconst program = new Command();\n\nprogram.name('agentic-triage').description('AI-powered GitHub issue triage and PR review primitives').version('0.2.1');\n\nprogram\n    .command('assess')\n    .description('Assess an issue')\n    .argument('<issue>', 'Issue number')\n    .action(async (issueNum) => {\n        console.log(`Assessing issue ${issueNum}...`);\n        await resolveModel();\n        console.log('Triage primitives called successfully.');\n    });\n\n/**\n * Format and print Sage results to the console\n */\nfunction printSageResult(result: any, json: boolean) {\n    if (json) {\n        console.log(JSON.stringify(result, null, 2));\n        return;\n    }\n\n    // Pretty print based on result type\n    if ('answer' in result) {\n        console.log('\\nüîÆ Sage Response:\\n');\n        console.log(result.answer);\n        if (result.agentRecommendation) {\n            console.log(`\\nüìå Recommended: ${result.agentRecommendation.agent.toUpperCase()}`);\n            console.log(`   Reason: ${result.agentRecommendation.reason}`);\n        }\n        console.log(`\\n(Confidence: ${Math.round(result.confidence * 100)}%)`);\n    } else if ('subtasks' in result) {\n        console.log('\\nüìã Task Decomposition:\\n');\n        for (const task of result.subtasks) {\n            console.log(`${task.id}: ${task.title}`);\n            console.log(`   Agent: ${task.agent} | Priority: ${task.priority} | Effort: ${task.effort}`);\n            console.log(`   ${task.description}\\n`);\n        }\n    } else if ('agent' in result && 'instructions' in result) {\n        console.log('\\nüéØ Agent Routing:\\n');\n        console.log(`Agent: ${result.agent.toUpperCase()}`);\n        console.log(`Reason: ${result.reason}`);\n        console.log(`Instructions: ${result.instructions}`);\n        console.log(`(Confidence: ${Math.round(result.confidence * 100)}%)`);\n    } else if ('diagnosis' in result) {\n        console.log('\\nüîì Unblock Analysis:\\n');\n        console.log(`Diagnosis: ${result.diagnosis}`);\n        console.log(`Root Cause: ${result.rootCause}`);\n        console.log(`\\n‚ö° Immediate Action: ${result.immediateAction}`);\n        if (result.needsHuman) {\n            console.log(`\\n‚ö†Ô∏è Human intervention required: ${result.escalationReason}`);\n        }\n    }\n}\n\nprogram\n    .command('sage')\n    .description('Ask Sage a question or get guidance')\n    .argument('<query>', 'Your question or request')\n    .option('--decompose', 'Decompose into subtasks')\n    .option('--route', 'Get agent routing recommendation')\n    .option('--unblock', 'Get help unblocking')\n    .option('--json', 'Output as JSON')\n    .action(async (query, options) => {\n        const resolved = await resolveModel();\n        const model = resolved.model;\n\n        let result: SageResponse | TaskDecomposition | AgentRouting | UnblockResponse;\n\n        if (options.decompose) {\n            console.log('Decomposing task...');\n            result = await decomposeTask(query, model);\n        } else if (options.route) {\n            console.log('Routing to agent...');\n            result = await routeToAgent(query, model);\n        } else if (options.unblock) {\n            console.log('Analyzing blocker...');\n            result = await unblock(query, model);\n        } else {\n            result = await sage(query, model);\n        }\n\n        printSageResult(result, options.json);\n    });\n\nprogram\n    .command('mcp-server')\n    .description('Run the MCP server for Claude/Cursor integration')\n    .action(async () => {\n        await runMcpServer();\n    });\n\nprogram.parse();\n"],"mappings":"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","names":[]}
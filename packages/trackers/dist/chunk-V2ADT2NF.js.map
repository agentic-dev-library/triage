{"version":3,"sources":["../src/types.ts"],"sourcesContent":["/**\n * Triage Provider Abstraction\n *\n * Defines common interfaces for issue tracking providers.\n * Allows agentic-triage to work with multiple backends:\n * - GitHub Issues\n * - Beads (local-first, AI-native)\n * - Jira (enterprise)\n * - Linear (modern)\n *\n * Similar to how AI providers work,\n * agentic-triage has multiple triage/issue providers.\n */\n\n// =============================================================================\n// Core Types\n// =============================================================================\n\nexport type IssuePriority = 'critical' | 'high' | 'medium' | 'low' | 'backlog';\nexport type IssueStatus = 'open' | 'in_progress' | 'blocked' | 'closed';\nexport type IssueType = 'bug' | 'feature' | 'task' | 'epic' | 'chore' | 'docs';\n\nexport type DependencyType = 'blocks' | 'related' | 'parent-child' | 'discovered-from';\n\n/**\n * Normalized issue representation across all providers\n */\nexport interface TriageIssue {\n    /** Provider-specific ID (e.g., \"123\" for GitHub, \"bd-a1b2\" for Beads) */\n    id: string;\n    /** Human-readable title */\n    title: string;\n    /** Optional description/body */\n    description?: string;\n    /** Issue status */\n    status: IssueStatus;\n    /** Priority level */\n    priority: IssuePriority;\n    /** Issue type */\n    type: IssueType;\n    /** Labels/tags */\n    labels: string[];\n    /** Assignee username/identifier */\n    assignee?: string;\n    /** Creation timestamp (ISO 8601) */\n    createdAt: string;\n    /** Last update timestamp (ISO 8601) */\n    updatedAt: string;\n    /** Closed timestamp if applicable */\n    closedAt?: string;\n    /** URL to view the issue (if available) */\n    url?: string;\n    /** Provider-specific metadata */\n    metadata?: Record<string, unknown>;\n}\n\n/**\n * Issue dependency/link\n */\nexport interface IssueDependency {\n    /** Source issue ID */\n    from: string;\n    /** Target issue ID */\n    to: string;\n    /** Type of dependency */\n    type: DependencyType;\n}\n\n/**\n * Options for creating an issue\n */\nexport interface CreateIssueOptions {\n    title: string;\n    description?: string;\n    type?: IssueType;\n    priority?: IssuePriority;\n    labels?: string[];\n    assignee?: string;\n    /** Parent issue ID for hierarchical providers */\n    parentId?: string;\n    /** Metadata passed to provider */\n    metadata?: Record<string, unknown>;\n}\n\n/**\n * Options for updating an issue\n */\nexport interface UpdateIssueOptions {\n    title?: string;\n    description?: string;\n    status?: IssueStatus;\n    priority?: IssuePriority;\n    type?: IssueType;\n    labels?: string[];\n    assignee?: string;\n    /** Reason for closing (if status = closed) */\n    closeReason?: string;\n    /** Metadata passed to provider */\n    metadata?: Record<string, unknown>;\n}\n\n/**\n * Options for listing issues\n */\nexport interface ListIssuesOptions {\n    /** Filter by status */\n    status?: IssueStatus | IssueStatus[];\n    /** Filter by priority */\n    priority?: IssuePriority | IssuePriority[];\n    /** Filter by type */\n    type?: IssueType | IssueType[];\n    /** Filter by labels (AND logic) */\n    labels?: string[];\n    /** Filter by any of these labels (OR logic) */\n    labelsAny?: string[];\n    /** Filter by assignee */\n    assignee?: string;\n    /** Search in title */\n    titleContains?: string;\n    /** Search in description */\n    descriptionContains?: string;\n    /** Created after date */\n    createdAfter?: string;\n    /** Created before date */\n    createdBefore?: string;\n    /** Maximum results */\n    limit?: number;\n    /** Sort field */\n    sortBy?: 'created' | 'updated' | 'priority';\n    /** Sort direction */\n    sortOrder?: 'asc' | 'desc';\n}\n\n/**\n * Ready work item - issue with no blockers\n */\nexport interface ReadyWork {\n    issue: TriageIssue;\n    /** Blocking issues that are now resolved */\n    resolvedBlockers?: string[];\n}\n\n/**\n * Provider statistics\n */\nexport interface ProviderStats {\n    total: number;\n    open: number;\n    inProgress: number;\n    blocked: number;\n    closed: number;\n    byPriority: Record<IssuePriority, number>;\n    byType: Record<IssueType, number>;\n}\n\n// =============================================================================\n// Provider Interface\n// =============================================================================\n\n/**\n * Triage Provider Interface\n *\n * All issue tracking backends must implement this interface.\n * This allows commands to work with any provider transparently.\n */\nexport interface TriageProvider {\n    /** Provider name (e.g., 'github', 'beads', 'jira', 'linear') */\n    readonly name: string;\n\n    /** Provider display name */\n    readonly displayName: string;\n\n    /** Whether the provider is initialized and ready */\n    isReady(): Promise<boolean>;\n\n    // =========================================================================\n    // Issue CRUD\n    // =========================================================================\n\n    /**\n     * Create a new issue\n     */\n    createIssue(options: CreateIssueOptions): Promise<TriageIssue>;\n\n    /**\n     * Get an issue by ID\n     */\n    getIssue(id: string): Promise<TriageIssue | null>;\n\n    /**\n     * Update an existing issue\n     */\n    updateIssue(id: string, options: UpdateIssueOptions): Promise<TriageIssue>;\n\n    /**\n     * Close an issue\n     */\n    closeIssue(id: string, reason?: string): Promise<TriageIssue>;\n\n    /**\n     * Reopen an issue\n     */\n    reopenIssue(id: string, reason?: string): Promise<TriageIssue>;\n\n    /**\n     * Delete an issue (if supported)\n     */\n    deleteIssue?(id: string): Promise<void>;\n\n    // =========================================================================\n    // Querying\n    // =========================================================================\n\n    /**\n     * List issues with optional filters\n     */\n    listIssues(options?: ListIssuesOptions): Promise<TriageIssue[]>;\n\n    /**\n     * Get issues ready to work on (no blockers)\n     */\n    getReadyWork(options?: { limit?: number; priority?: IssuePriority }): Promise<ReadyWork[]>;\n\n    /**\n     * Get blocked issues\n     */\n    getBlockedIssues(): Promise<TriageIssue[]>;\n\n    /**\n     * Search issues by text\n     */\n    searchIssues(query: string, options?: ListIssuesOptions): Promise<TriageIssue[]>;\n\n    // =========================================================================\n    // Labels\n    // =========================================================================\n\n    /**\n     * Add labels to an issue\n     */\n    addLabels(id: string, labels: string[]): Promise<void>;\n\n    /**\n     * Remove labels from an issue\n     */\n    removeLabels(id: string, labels: string[]): Promise<void>;\n\n    /**\n     * Get all available labels\n     */\n    getAvailableLabels?(): Promise<string[]>;\n\n    // =========================================================================\n    // Statistics\n    // =========================================================================\n\n    /**\n     * Get provider statistics\n     */\n    getStats(): Promise<ProviderStats>;\n\n    /**\n     * Sync with remote (for providers that support it)\n     */\n    sync?(): Promise<void>;\n\n    /**\n     * Initialize the provider in a directory (for local providers like Beads)\n     */\n    init?(directory?: string): Promise<void>;\n}\n\n// =============================================================================\n// Provider Configuration\n// =============================================================================\n\nexport interface GitHubProviderConfig {\n    type: 'github';\n    /** Repository in owner/repo format */\n    repo: string;\n    /** GitHub token (defaults to GITHUB_TOKEN env var) */\n    token?: string;\n}\n\nexport interface BeadsProviderConfig {\n    type: 'beads';\n    /** Working directory (defaults to cwd) */\n    workingDir?: string;\n}\n\nexport interface JiraProviderConfig {\n    type: 'jira';\n    /** Jira instance host (e.g., 'https://mycompany.atlassian.net') */\n    host: string;\n    /** Project key */\n    projectKey: string;\n    /** API token */\n    apiToken: string;\n    /** User email for auth */\n    email: string;\n}\n\nexport interface LinearProviderConfig {\n    type: 'linear';\n    /** Team ID or key */\n    team: string;\n    /** API key */\n    apiKey: string;\n}\n\nexport type ProviderConfig = GitHubProviderConfig | BeadsProviderConfig | JiraProviderConfig | LinearProviderConfig;\n\n// =============================================================================\n// Utility Functions\n// =============================================================================\n\n/**\n * Map provider priority values to normalized priority\n */\nexport function normalizePriority(value: number | string): IssuePriority {\n    if (typeof value === 'string') {\n        const lower = value.toLowerCase();\n        if (lower === 'critical' || lower === 'highest' || lower === 'p0') return 'critical';\n        if (lower === 'high' || lower === 'p1') return 'high';\n        if (lower === 'medium' || lower === 'medium' || lower === 'p2') return 'medium';\n        if (lower === 'low' || lower === 'p3') return 'low';\n        if (lower === 'lowest' || lower === 'backlog' || lower === 'p4') return 'backlog';\n        return 'medium';\n    }\n    // Numeric: 0=critical, 1=high, 2=medium, 3=low, 4+=backlog\n    if (value === 0) return 'critical';\n    if (value === 1) return 'high';\n    if (value === 2) return 'medium';\n    if (value === 3) return 'low';\n    return 'backlog';\n}\n\n/**\n * Map normalized priority to numeric value (0 is highest)\n */\nexport function priorityToNumber(priority: IssuePriority): number {\n    switch (priority) {\n        case 'critical':\n            return 0;\n        case 'high':\n            return 1;\n        case 'medium':\n            return 2;\n        case 'low':\n            return 3;\n        case 'backlog':\n            return 4;\n    }\n}\n\n/**\n * Map provider status strings to normalized status\n */\nexport function normalizeStatus(value: string): IssueStatus {\n    const lower = value.toLowerCase().replace(/[_-]/g, '');\n    if (lower === 'open' || lower === 'new' || lower === 'todo') return 'open';\n    if (lower === 'inprogress' || lower === 'active' || lower === 'doing') return 'in_progress';\n    if (lower === 'blocked' || lower === 'waiting') return 'blocked';\n    if (lower === 'closed' || lower === 'done' || lower === 'resolved') return 'closed';\n    return 'open';\n}\n\n/**\n * Map provider type strings to normalized type\n */\nexport function normalizeType(value: string): IssueType {\n    const lower = value.toLowerCase();\n    if (lower === 'bug' || lower === 'defect') return 'bug';\n    if (lower === 'feature' || lower === 'enhancement' || lower === 'story') return 'feature';\n    if (lower === 'task' || lower === 'subtask') return 'task';\n    if (lower === 'epic' || lower === 'initiative') return 'epic';\n    if (lower === 'chore' || lower === 'maintenance') return 'chore';\n    if (lower === 'docs' || lower === 'documentation') return 'docs';\n    return 'task';\n}\n"],"mappings":";AA+TO,SAAS,kBAAkB,OAAuC;AACrE,MAAI,OAAO,UAAU,UAAU;AAC3B,UAAM,QAAQ,MAAM,YAAY;AAChC,QAAI,UAAU,cAAc,UAAU,aAAa,UAAU,KAAM,QAAO;AAC1E,QAAI,UAAU,UAAU,UAAU,KAAM,QAAO;AAC/C,QAAI,UAAU,YAAY,UAAU,YAAY,UAAU,KAAM,QAAO;AACvE,QAAI,UAAU,SAAS,UAAU,KAAM,QAAO;AAC9C,QAAI,UAAU,YAAY,UAAU,aAAa,UAAU,KAAM,QAAO;AACxE,WAAO;AAAA,EACX;AAEA,MAAI,UAAU,EAAG,QAAO;AACxB,MAAI,UAAU,EAAG,QAAO;AACxB,MAAI,UAAU,EAAG,QAAO;AACxB,MAAI,UAAU,EAAG,QAAO;AACxB,SAAO;AACX;AAKO,SAAS,iBAAiB,UAAiC;AAC9D,UAAQ,UAAU;AAAA,IACd,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAO;AAAA,EACf;AACJ;AAKO,SAAS,gBAAgB,OAA4B;AACxD,QAAM,QAAQ,MAAM,YAAY,EAAE,QAAQ,SAAS,EAAE;AACrD,MAAI,UAAU,UAAU,UAAU,SAAS,UAAU,OAAQ,QAAO;AACpE,MAAI,UAAU,gBAAgB,UAAU,YAAY,UAAU,QAAS,QAAO;AAC9E,MAAI,UAAU,aAAa,UAAU,UAAW,QAAO;AACvD,MAAI,UAAU,YAAY,UAAU,UAAU,UAAU,WAAY,QAAO;AAC3E,SAAO;AACX;AAKO,SAAS,cAAc,OAA0B;AACpD,QAAM,QAAQ,MAAM,YAAY;AAChC,MAAI,UAAU,SAAS,UAAU,SAAU,QAAO;AAClD,MAAI,UAAU,aAAa,UAAU,iBAAiB,UAAU,QAAS,QAAO;AAChF,MAAI,UAAU,UAAU,UAAU,UAAW,QAAO;AACpD,MAAI,UAAU,UAAU,UAAU,aAAc,QAAO;AACvD,MAAI,UAAU,WAAW,UAAU,cAAe,QAAO;AACzD,MAAI,UAAU,UAAU,UAAU,gBAAiB,QAAO;AAC1D,SAAO;AACX;","names":[]}